<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-0.9.2/grViz.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET R</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU">GPU</a></li>
        <li><a href="TimeSeries_CPU">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<p>It relies on an explicit symbolic construction of the RNN cells (LSTM or GRU), thus supporting training on CPU unlike the FusedRNN operator that is CUDA dependent.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)
source(&quot;../rnn.graph.R&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<pre class="r"><code>seq_len = 100
samples = 192

seeds &lt;- runif(samples, min = -pi, max = pi)
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, samples))
y &lt;- pts[-1, ]

p1 = plot_ly(x = 1:dim(x)[2], y = x[1,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p2 = plot_ly(x = 1:length(y[,1]), y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;%
  add_trace(x = 1:length(y[,2]), y = y[,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p1</code></pre>
<div id="54331a698a28" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="54331a698a28">{"x":{"visdat":{"54334a3b36c9":["function () ","plotlyVisDat"]},"cur_data":"54334a3b36c9","attrs":{"54334a3b36c9":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.70359370130818,-0.863536786070405,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.710602493296678,-0.504285850587935,-0.263602960533395,-0.00495596434299291,0.254028772627265,0.495701868545371,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299303,-0.254028772627265,-0.49570186854537,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296679,-0.504285850587935,-0.263602960533395,-0.00495596434299404,0.254028772627264,0.49570186854537,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299416,-0.254028772627264,-0.495701868545369,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.71060249329668,-0.504285850587935,-0.263602960533395,-0.00495596434299429,0.254028772627264,0.495701868545369,0.703593701308178,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413397,0.71060249329668,0.504285850587935,0.263602960533397,0.00495596434299441,-0.254028772627262,-0.495701868545369,-0.70359370130818,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.71060249329668,-0.504285850587935,-0.263602960533397,-0.00495596434299453,0.254028772627262,0.495701868545369,0.70359370130818,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413399,0.71060249329668,0.504285850587936,0.263602960533398,0.00495596434299465,-0.254028772627262,-0.495701868545369,-0.703593701308179,-0.863536786070403,-0.964631265923943,-0.999987719133306],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"54334a3b36c9.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241519,0.728756057309631,0.526691899398419,0.288734558942722,0.0311004354514987,-0.228653131319845,-0.472824365058907,-0.684773399698413,-0.85005625879002,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241519,-0.728756057309631,-0.526691899398419,-0.288734558942722,-0.0311004354514988,0.228653131319845,0.472824365058907,0.684773399698412,0.85005625879002,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241519,0.728756057309631,0.526691899398419,0.288734558942723,0.0311004354514998,-0.228653131319845,-0.472824365058905,-0.684773399698412,-0.850056258790019,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241519,-0.728756057309632,-0.52669189939842,-0.288734558942722,-0.0311004354514999,0.228653131319845,0.472824365058905,0.684773399698412,0.850056258790019,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241519,0.728756057309633,0.52669189939842,0.288734558942725,0.0311004354515001,-0.228653131319845,-0.472824365058905,-0.684773399698412,-0.850056258790019,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241521,-0.728756057309633,-0.52669189939842,-0.288734558942725,-0.0311004354515002,0.228653131319842,0.472824365058905,0.684773399698409,0.850056258790019,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241521,0.728756057309633,0.52669189939842,0.288734558942725,0.0311004354515003,-0.228653131319841,-0.472824365058905,-0.684773399698409,-0.850056258790019,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241521,-0.728756057309633,-0.526691899398423,-0.288734558942725,-0.0311004354515004,0.228653131319841,0.472824365058905,0.684773399698409,0.850056258790019,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241521],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"54334a3b36c9.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.982159840999096,-0.900023154632025,-0.756551377635369,-0.561521874513129,-0.328225583601592,-0.0725612615860298,0.188047990493466,0.435842082784829,0.653934257397504,0.827461893045995,0.944599368128835,0.997363957297958,0.982159840999096,0.900023154632025,0.756551377635369,0.561521874513129,0.328225583601592,0.0725612615860304,-0.188047990493466,-0.435842082784829,-0.653934257397504,-0.827461893045995,-0.944599368128835,-0.997363957297958,-0.982159840999096,-0.900023154632025,-0.75655137763537,-0.56152187451313,-0.328225583601592,-0.0725612615860305,0.188047990493465,0.435842082784829,0.653934257397503,0.827461893045995,0.944599368128835,0.997363957297958,0.982159840999096,0.900023154632025,0.75655137763537,0.56152187451313,0.328225583601593,0.0725612615860315,-0.188047990493466,-0.435842082784829,-0.653934257397503,-0.827461893045994,-0.944599368128834,-0.997363957297958,-0.982159840999096,-0.900023154632025,-0.75655137763537,-0.56152187451313,-0.328225583601593,-0.0725612615860316,0.188047990493464,0.435842082784829,0.653934257397503,0.827461893045994,0.944599368128834,0.997363957297958,0.982159840999096,0.900023154632025,0.75655137763537,0.561521874513132,0.328225583601593,0.0725612615860299,-0.188047990493464,-0.435842082784829,-0.653934257397502,-0.827461893045994,-0.944599368128834,-0.997363957297958,-0.982159840999096,-0.900023154632026,-0.75655137763537,-0.561521874513132,-0.328225583601594,-0.0725612615860301,0.188047990493463,0.435842082784829,0.653934257397502,0.827461893045994,0.944599368128834,0.997363957297958,0.982159840999096,0.900023154632026,0.75655137763537,0.561521874513132,0.328225583601594,0.0725612615860337,-0.188047990493463,-0.435842082784829,-0.653934257397502,-0.827461893045994,-0.944599368128834,-0.997363957297958,-0.982159840999096,-0.900023154632026,-0.75655137763537,-0.561521874513132],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"54334a3b36c9.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.980642552349243,-0.89654951692552,-0.751358113541453,-0.554962896397527,-0.320747874983659,-0.06467441595058,0.195806497650005,0.44294352202128,0.659894677365584,0.83187510097494,0.947164611191459,0.997906418418807,0.980642552349243,0.896549516925521,0.751358113541453,0.554962896397528,0.320747874983659,0.0646744159505806,-0.195806497650005,-0.44294352202128,-0.659894677365584,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.89654951692552,-0.751358113541453,-0.554962896397528,-0.32074787498366,-0.0646744159505811,0.195806497650004,0.44294352202128,0.659894677365584,0.83187510097494,0.947164611191458,0.997906418418807,0.980642552349243,0.89654951692552,0.751358113541454,0.554962896397528,0.32074787498366,0.0646744159505813,-0.195806497650006,-0.44294352202128,-0.659894677365584,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.896549516925521,-0.751358113541454,-0.554962896397528,-0.32074787498366,-0.0646744159505814,0.195806497650004,0.44294352202128,0.659894677365584,0.83187510097494,0.947164611191458,0.997906418418807,0.980642552349244,0.896549516925521,0.751358113541454,0.55496289639753,0.32074787498366,0.0646744159505797,-0.195806497650004,-0.442943522021279,-0.659894677365582,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.896549516925521,-0.751358113541454,-0.55496289639753,-0.32074787498366,-0.0646744159505798,0.195806497650003,0.442943522021279,0.659894677365582,0.83187510097494,0.947164611191458,0.997906418418807,0.980642552349243,0.896549516925521,0.751358113541454,0.55496289639753,0.32074787498366,0.0646744159505835,-0.195806497650003,-0.442943522021279,-0.659894677365582,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.896549516925522,-0.751358113541454,-0.55496289639753],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"54334a3b36c9.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.999992528865628,-0.964918140601635,-0.864086175658264,-0.704368165813703,-0.49664862949237,-0.255083309821799,0.00386551586802776,0.262550913039515,0.503343899373258,0.709834830779837,0.867951691526291,0.966919078853218,0.999992528865628,0.964918140601635,0.864086175658264,0.704368165813704,0.496648629492371,0.255083309821799,-0.00386551586802742,-0.262550913039514,-0.503343899373257,-0.709834830779836,-0.867951691526291,-0.966919078853218,-0.999992528865628,-0.964918140601635,-0.864086175658264,-0.704368165813704,-0.496648629492371,-0.2550833098218,0.00386551586802641,0.262550913039514,0.503343899373257,0.709834830779836,0.86795169152629,0.966919078853218,0.999992528865628,0.964918140601635,0.864086175658264,0.704368165813704,0.496648629492371,0.2550833098218,-0.00386551586802806,-0.262550913039515,-0.503343899373258,-0.709834830779836,-0.867951691526291,-0.966919078853218,-0.999992528865628,-0.964918140601635,-0.864086175658264,-0.704368165813704,-0.496648629492371,-0.2550833098218,0.00386551586802616,0.262550913039515,0.503343899373258,0.709834830779836,0.867951691526291,0.966919078853218,0.999992528865628,0.964918140601635,0.864086175658264,0.704368165813705,0.496648629492371,0.255083309821798,-0.00386551586802604,-0.262550913039515,-0.503343899373254,-0.709834830779835,-0.867951691526289,-0.966919078853217,-0.999992528865628,-0.964918140601636,-0.864086175658265,-0.704368165813707,-0.496648629492373,-0.2550833098218,0.00386551586802414,0.262550913039513,0.503343899373254,0.709834830779835,0.867951691526289,0.966919078853217,0.999992528865628,0.964918140601636,0.864086175658265,0.704368165813707,0.496648629492373,0.255083309821804,-0.00386551586802402,-0.262550913039513,-0.503343899373254,-0.709834830779835,-0.867951691526289,-0.966919078853217,-0.999992528865628,-0.964918140601636,-0.864086175658265,-0.704368165813707],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.70359370130818,-0.863536786070405,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.710602493296678,-0.504285850587935,-0.263602960533395,-0.00495596434299291,0.254028772627265,0.495701868545371,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299303,-0.254028772627265,-0.49570186854537,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296679,-0.504285850587935,-0.263602960533395,-0.00495596434299404,0.254028772627264,0.49570186854537,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299416,-0.254028772627264,-0.495701868545369,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.71060249329668,-0.504285850587935,-0.263602960533395,-0.00495596434299429,0.254028772627264,0.495701868545369,0.703593701308178,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413397,0.71060249329668,0.504285850587935,0.263602960533397,0.00495596434299441,-0.254028772627262,-0.495701868545369,-0.70359370130818,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.71060249329668,-0.504285850587935,-0.263602960533397,-0.00495596434299453,0.254028772627262,0.495701868545369,0.70359370130818,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413399,0.71060249329668,0.504285850587936,0.263602960533398,0.00495596434299465,-0.254028772627262,-0.495701868545369,-0.703593701308179,-0.863536786070403,-0.964631265923943,-0.999987719133306],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241519,0.728756057309631,0.526691899398419,0.288734558942722,0.0311004354514987,-0.228653131319845,-0.472824365058907,-0.684773399698413,-0.85005625879002,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241519,-0.728756057309631,-0.526691899398419,-0.288734558942722,-0.0311004354514988,0.228653131319845,0.472824365058907,0.684773399698412,0.85005625879002,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241519,0.728756057309631,0.526691899398419,0.288734558942723,0.0311004354514998,-0.228653131319845,-0.472824365058905,-0.684773399698412,-0.850056258790019,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241519,-0.728756057309632,-0.52669189939842,-0.288734558942722,-0.0311004354514999,0.228653131319845,0.472824365058905,0.684773399698412,0.850056258790019,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241519,0.728756057309633,0.52669189939842,0.288734558942725,0.0311004354515001,-0.228653131319845,-0.472824365058905,-0.684773399698412,-0.850056258790019,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241521,-0.728756057309633,-0.52669189939842,-0.288734558942725,-0.0311004354515002,0.228653131319842,0.472824365058905,0.684773399698409,0.850056258790019,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241521,0.728756057309633,0.52669189939842,0.288734558942725,0.0311004354515003,-0.228653131319841,-0.472824365058905,-0.684773399698409,-0.850056258790019,-0.957409188629476,-0.999516264457326,-0.973507958641135,-0.881156694241521,-0.728756057309633,-0.526691899398423,-0.288734558942725,-0.0311004354515004,0.228653131319841,0.472824365058905,0.684773399698409,0.850056258790019,0.957409188629476,0.999516264457326,0.973507958641135,0.881156694241521],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.982159840999096,-0.900023154632025,-0.756551377635369,-0.561521874513129,-0.328225583601592,-0.0725612615860298,0.188047990493466,0.435842082784829,0.653934257397504,0.827461893045995,0.944599368128835,0.997363957297958,0.982159840999096,0.900023154632025,0.756551377635369,0.561521874513129,0.328225583601592,0.0725612615860304,-0.188047990493466,-0.435842082784829,-0.653934257397504,-0.827461893045995,-0.944599368128835,-0.997363957297958,-0.982159840999096,-0.900023154632025,-0.75655137763537,-0.56152187451313,-0.328225583601592,-0.0725612615860305,0.188047990493465,0.435842082784829,0.653934257397503,0.827461893045995,0.944599368128835,0.997363957297958,0.982159840999096,0.900023154632025,0.75655137763537,0.56152187451313,0.328225583601593,0.0725612615860315,-0.188047990493466,-0.435842082784829,-0.653934257397503,-0.827461893045994,-0.944599368128834,-0.997363957297958,-0.982159840999096,-0.900023154632025,-0.75655137763537,-0.56152187451313,-0.328225583601593,-0.0725612615860316,0.188047990493464,0.435842082784829,0.653934257397503,0.827461893045994,0.944599368128834,0.997363957297958,0.982159840999096,0.900023154632025,0.75655137763537,0.561521874513132,0.328225583601593,0.0725612615860299,-0.188047990493464,-0.435842082784829,-0.653934257397502,-0.827461893045994,-0.944599368128834,-0.997363957297958,-0.982159840999096,-0.900023154632026,-0.75655137763537,-0.561521874513132,-0.328225583601594,-0.0725612615860301,0.188047990493463,0.435842082784829,0.653934257397502,0.827461893045994,0.944599368128834,0.997363957297958,0.982159840999096,0.900023154632026,0.75655137763537,0.561521874513132,0.328225583601594,0.0725612615860337,-0.188047990493463,-0.435842082784829,-0.653934257397502,-0.827461893045994,-0.944599368128834,-0.997363957297958,-0.982159840999096,-0.900023154632026,-0.75655137763537,-0.561521874513132],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.980642552349243,-0.89654951692552,-0.751358113541453,-0.554962896397527,-0.320747874983659,-0.06467441595058,0.195806497650005,0.44294352202128,0.659894677365584,0.83187510097494,0.947164611191459,0.997906418418807,0.980642552349243,0.896549516925521,0.751358113541453,0.554962896397528,0.320747874983659,0.0646744159505806,-0.195806497650005,-0.44294352202128,-0.659894677365584,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.89654951692552,-0.751358113541453,-0.554962896397528,-0.32074787498366,-0.0646744159505811,0.195806497650004,0.44294352202128,0.659894677365584,0.83187510097494,0.947164611191458,0.997906418418807,0.980642552349243,0.89654951692552,0.751358113541454,0.554962896397528,0.32074787498366,0.0646744159505813,-0.195806497650006,-0.44294352202128,-0.659894677365584,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.896549516925521,-0.751358113541454,-0.554962896397528,-0.32074787498366,-0.0646744159505814,0.195806497650004,0.44294352202128,0.659894677365584,0.83187510097494,0.947164611191458,0.997906418418807,0.980642552349244,0.896549516925521,0.751358113541454,0.55496289639753,0.32074787498366,0.0646744159505797,-0.195806497650004,-0.442943522021279,-0.659894677365582,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.896549516925521,-0.751358113541454,-0.55496289639753,-0.32074787498366,-0.0646744159505798,0.195806497650003,0.442943522021279,0.659894677365582,0.83187510097494,0.947164611191458,0.997906418418807,0.980642552349243,0.896549516925521,0.751358113541454,0.55496289639753,0.32074787498366,0.0646744159505835,-0.195806497650003,-0.442943522021279,-0.659894677365582,-0.83187510097494,-0.947164611191458,-0.997906418418807,-0.980642552349243,-0.896549516925522,-0.751358113541454,-0.55496289639753],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.999992528865628,-0.964918140601635,-0.864086175658264,-0.704368165813703,-0.49664862949237,-0.255083309821799,0.00386551586802776,0.262550913039515,0.503343899373258,0.709834830779837,0.867951691526291,0.966919078853218,0.999992528865628,0.964918140601635,0.864086175658264,0.704368165813704,0.496648629492371,0.255083309821799,-0.00386551586802742,-0.262550913039514,-0.503343899373257,-0.709834830779836,-0.867951691526291,-0.966919078853218,-0.999992528865628,-0.964918140601635,-0.864086175658264,-0.704368165813704,-0.496648629492371,-0.2550833098218,0.00386551586802641,0.262550913039514,0.503343899373257,0.709834830779836,0.86795169152629,0.966919078853218,0.999992528865628,0.964918140601635,0.864086175658264,0.704368165813704,0.496648629492371,0.2550833098218,-0.00386551586802806,-0.262550913039515,-0.503343899373258,-0.709834830779836,-0.867951691526291,-0.966919078853218,-0.999992528865628,-0.964918140601635,-0.864086175658264,-0.704368165813704,-0.496648629492371,-0.2550833098218,0.00386551586802616,0.262550913039515,0.503343899373258,0.709834830779836,0.867951691526291,0.966919078853218,0.999992528865628,0.964918140601635,0.864086175658264,0.704368165813705,0.496648629492371,0.255083309821798,-0.00386551586802604,-0.262550913039515,-0.503343899373254,-0.709834830779835,-0.867951691526289,-0.966919078853217,-0.999992528865628,-0.964918140601636,-0.864086175658265,-0.704368165813707,-0.496648629492373,-0.2550833098218,0.00386551586802414,0.262550913039513,0.503343899373254,0.709834830779835,0.867951691526289,0.966919078853217,0.999992528865628,0.964918140601636,0.864086175658265,0.704368165813707,0.496648629492373,0.255083309821804,-0.00386551586802402,-0.262550913039513,-0.503343899373254,-0.709834830779835,-0.867951691526289,-0.966919078853217,-0.999992528865628,-0.964918140601636,-0.864086175658265,-0.704368165813707],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<pre class="r"><code>batch.size = 16

train.data &lt;- mx.io.arrayiter(data = x[,,1:160, drop = F], label = y[, 1:160], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-(1:160), drop = F], label = y[, -(1:160)], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph.unroll(seq_len = 2, 
                           num_rnn_layer =  1, 
                           num_hidden = 50,
                           input_size = NULL,
                           num_embed = NULL, 
                           num_decode = 1,
                           masking = F, 
                           loss_output = &quot;linear&quot;,
                           dropout = 0.2, 
                           ignore_label = -1,
                           cell_type = &quot;lstm&quot;,
                           output_last_state = F,
                           config = &quot;one-to-one&quot;)

graph = graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;TD&quot;, 
                  shape=list(data = c(1, 2, batch.size), 
                             label = c(2, batch.size)))</code></pre>
<div id="htmlwidget-e007c836b4e6aa48fb1a" style="width:672px;height:1152px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e007c836b4e6aa48fb1a">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"TD\"]\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"SliceChannel\nsplit0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"FullyConnected\nt1.l1.i2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"5\" [label = \"SliceChannel\nt1.l1.slice\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Activation\nactivation3\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"7\" [label = \"Activation\nactivation0\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"8\" [label = \"Activation\nactivation1\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"9\" [label = \"elemwise_mul\n_mul0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"10\" [label = \"Activation\nactivation4\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"11\" [label = \"elemwise_mul\n_mul1\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"12\" [label = \"Dropout\ndropout0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"13\" [label = \"FullyConnected\nt2.l1.i2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"14\" [label = \"FullyConnected\nt2.l1.h2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"15\" [label = \"elemwise_add\n_plus0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"16\" [label = \"SliceChannel\nt2.l1.slice\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"17\" [label = \"Activation\nactivation8\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"18\" [label = \"Activation\nactivation7\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"19\" [label = \"elemwise_mul\n_mul2\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"20\" [label = \"Activation\nactivation5\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"21\" [label = \"Activation\nactivation6\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"22\" [label = \"elemwise_mul\n_mul3\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"23\" [label = \"elemwise_add\n_plus1\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"24\" [label = \"Activation\nactivation9\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"25\" [label = \"elemwise_mul\n_mul4\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"26\" [label = \"Dropout\ndropout1\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"27\" [label = \"Concat\nconcat\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"28\" [label = \"Reshape\nrnn_reshape\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"29\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"30\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"31\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"32\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"33\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"34\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [id = \"1\", color = \"black\", fontcolor = \"black\", label = \"1X2X16\"] \n\"2\"->\"3\" [id = \"2\", color = \"black\", fontcolor = \"black\", label = \"1X16X2\"] \n\"3\"->\"4\" [id = \"3\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"4\"->\"5\" [id = \"4\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"5\"->\"6\" [id = \"5\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"5\"->\"7\" [id = \"6\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"5\"->\"8\" [id = \"7\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"7\"->\"9\" [id = \"8\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"8\"->\"9\" [id = \"9\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"9\"->\"10\" [id = \"10\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"6\"->\"11\" [id = \"11\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"10\"->\"11\" [id = \"12\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"11\"->\"12\" [id = \"13\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"3\"->\"13\" [id = \"14\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"11\"->\"14\" [id = \"15\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"13\"->\"15\" [id = \"16\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"14\"->\"15\" [id = \"17\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"15\"->\"16\" [id = \"18\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"16\"->\"17\" [id = \"19\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"16\"->\"18\" [id = \"20\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"18\"->\"19\" [id = \"21\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"9\"->\"19\" [id = \"22\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"16\"->\"20\" [id = \"23\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"16\"->\"21\" [id = \"24\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"20\"->\"22\" [id = \"25\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"21\"->\"22\" [id = \"26\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"19\"->\"23\" [id = \"27\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"22\"->\"23\" [id = \"28\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"23\"->\"24\" [id = \"29\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"17\"->\"25\" [id = \"30\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"24\"->\"25\" [id = \"31\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"25\"->\"26\" [id = \"32\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"12\"->\"27\" [id = \"33\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"26\"->\"27\" [id = \"34\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"27\"->\"28\" [id = \"35\", color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"28\"->\"29\" [id = \"36\", color = \"black\", fontcolor = \"black\", label = \"50X16X2\"] \n\"29\"->\"30\" [id = \"37\", color = \"black\", fontcolor = \"black\", label = \"50X16X2\"] \n\"30\"->\"31\" [id = \"38\", color = \"black\", fontcolor = \"black\", label = \"50X2X16\"] \n\"31\"->\"32\" [id = \"39\", color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"32\"->\"34\" [id = \"40\", color = \"black\", fontcolor = \"black\", label = \"1X32\"] \n\"33\"->\"34\" [id = \"41\", color = \"black\", fontcolor = \"black\", label = \"32\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;Perplexity&quot;, function(label, pred) {
  label = mx.nd.reshape(mx.nd.array(label), shape = -1)
  label = as.array(label)
  res &lt;- mean((label-pred)^2)
  return(res)
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.cpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 2.5)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.9, eps = 1e-5, wd = 1e-6,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 250, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
## 364.712   3.456 179.250</code></pre>
<pre class="r"><code>plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
        mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)</code></pre>
<div id="5433f9498ae" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="5433f9498ae">{"x":{"visdat":{"54334961d9a0":["function () ","plotlyVisDat"]},"cur_data":"54334961d9a0","attrs":{"54334961d9a0":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.264584281254369,0.0976005191630076,0.0518760510119198,0.0416728737789887,0.0446009505273634,0.0337885212960721,0.0467264798879984,0.0337818921449372,0.0311652704392935,0.0360687730147434,0.0269604613146239,0.0329705140970145,0.0269539255325873,0.02685669669522,0.029278364503783,0.0254764884531036,0.0259263632053991,0.0223990102649818,0.0238615302354397,0.025829499221307,0.0202046613289976,0.0213029298505815,0.0201641987355519,0.0248071074442095,0.0198604592352465,0.0182505592519027,0.0195001909869725,0.0198391008985858,0.0191755154467621,0.0217237946767811,0.0159085358846912,0.0163433429260681,0.016759433970503,0.0192275745749161,0.0177030964175868,0.0163618079166913,0.0128421800655152,0.0139707116076838,0.0234951746159305,0.0187252492207929,0.00946994990323826,0.0115228196322498,0.012893405469968,0.0142900034121454,0.0130459207408453,0.0124584365057804,0.0152730428537472,0.0146678233096059,0.0135435809376808,0.0163997815622781,0.0134925111212416,0.0114184112196039,0.0145427973395159,0.0130839812851386,0.0127735880585066,0.0138096453900722,0.0127366126081973,0.0122095502893938,0.0116847414885587,0.0139107165731321,0.0118078509566384,0.0151248362389356,0.013994150945525,0.0124105703198368,0.0113772594299357,0.0113417299484918,0.0139302970669235,0.0133164009264222,0.0106815228270603,0.0103662044524658,0.0129338917842213,0.0128661658673399,0.0112699318712224,0.0101279162554307,0.00929812934108949,0.0123203404695671,0.011978302556592,0.0105315669761219,0.0113391038270933,0.0129153225113575,0.0122765259573794,0.0128208159571194,0.0123514858268918,0.0114193664000422,0.0125265429172016,0.0117394790702363,0.00914673148680939,0.0121636473675662,0.0114931771783733,0.0108552755637582,0.0102570951039858,0.0106905989197604,0.00891156588735252,0.0112901029185439,0.0109795426285971,0.0107665517592746,0.0105101636556683,0.00994740568004806,0.0106350084664746,0.0106667376694125,0.00909076290765265,0.0127259300059495,0.0106685411800308,0.0104925498100316,0.00976885718237758,0.0105779910008812,0.0102219274542198,0.0111509602073226,0.010162875706099,0.00937406325812974,0.00973264610179172,0.0110254604485385,0.0106586856134431,0.00962525092727821,0.00990190101258431,0.0105452824241775,0.0104487591130176,0.00983503234106756,0.00914489709277817,0.0100965179482232,0.0106953142513211,0.0102236343344213,0.00856012661353021,0.00978953739057929,0.0122057964681327,0.0108820889879902,0.00996100118631476,0.00943069159246103,0.00864369199340142,0.00948916863994174,0.0104382814716867,0.00934321770097876,0.00859432142290023,0.00992051578218531,0.0103763291542188,0.00944370395299396,0.00816547314137603,0.0112615658934957,0.0108515975978784,0.0102734283477908,0.00967149493158178,0.00889218977997875,0.00969559016388012,0.0093289335897649,0.00780890020623182,0.00764234118515299,0.00823106428038014,0.00901251524268563,0.00994855406119442,0.0101467082147024,0.00918238460884494,0.00792101536663043,0.0102507337940098,0.0104122370324437,0.00928119216033522,0.00925514150390472,0.00857762125767384,0.00949755756082537,0.0094667869549213,0.00972519963458466,0.00996361986412761,0.00941927059224034,0.00836636783601052,0.00807706151133728,0.00896353582822872,0.00939864394804659,0.00975549971036106,0.00952170818822434,0.00877138765989526,0.00910933772516744,0.0083339085722182,0.00975039550164272,0.00925757577669841,0.00825433071859276,0.00818641290396757,0.0079347878396553,0.00844849777673888,0.00932787747051481,0.00894642844746021,0.0075157746120686,0.00899948954786631,0.0104541455699972,0.00977370709750612,0.00973353285096042,0.00929804672547164,0.00939474314404163,0.00884035804863467,0.00773598306011942,0.00763284364498715,0.00848138923136138,0.00870758391890109,0.00934299154664087,0.00846417957227576,0.00832744581256273,0.00942982592941725,0.00954097216826156,0.00825445472076555,0.00750231643077148,0.00947487580014658,0.00994114597607326,0.00977482202093735,0.00982646543893371,0.00911074059503368,0.00778156456703781,0.00820482277500807,0.00879588271882704,0.0100729237629125,0.00922751717697985,0.00890344473843574,0.00880888944517271,0.00923605503469311,0.00846954590939401,0.00761801289910147,0.0101978939895131,0.00898521905330141,0.00851479289544929,0.00876586844929194,0.00888631748080662,0.00884895479152966,0.0095658596500966,0.00864020950392682,0.00848903782003414,0.00838271543010476,0.00882523427233252,0.00887845874138965,0.00739657879570619,0.00876893597864184,0.00949998696801967,0.00933534551442697,0.00975136935621041,0.00823573614888773,0.00859337195751257,0.00837154482980812,0.00856863773003212,0.0092776754121599,0.00932487716427801,0.00948287707935685,0.0082332560661757,0.00776872182926809,0.00791928360972818,0.00952532216770382,0.00849450813714131,0.00898537872560498,0.00871799893114645,0.00889982158874118,0.00801320099097868,0.00808245977168881,0.00764024007447416,0.0075896659544064,0.00873924158997802],"mode":"markers+lines","name":"train","alpha":1,"sizes":[10,100],"type":"scatter"},"54334961d9a0.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.219692731630187,0.0287925079201462,0.0387209315990709,0.0276884379894956,0.019121964572414,0.019467713089865,0.0185013112234156,0.0171276963659245,0.0155722859902004,0.0134947523410239,0.0137453363130083,0.0141233159722426,0.0121631852278234,0.0245653567722083,0.0112331374850214,0.0141037382959502,0.0118674001637786,0.0105497978567366,0.0173575127683552,0.0107716593867409,0.00991543682293278,0.0104683217265634,0.0122511903224345,0.00974630870514747,0.00966672421256559,0.0117169419790851,0.00949270389756087,0.0102322440145976,0.00796487142591756,0.0104602724514368,0.00876555980344192,0.00877086388909514,0.0107938672357687,0.00883124366199634,0.00768349847949051,0.00800478712509098,0.00580256278203615,0.013434302454837,0.0315848354121966,0.00490110038760179,0.00608732470564106,0.0102268146321989,0.00924316103099241,0.0130356471844335,0.00881805595710494,0.00992837260627853,0.014390685826612,0.00887125431714323,0.0112404377970596,0.00869817607666441,0.00698634874188381,0.00753817300476826,0.00874307196633882,0.00626149704760086,0.0132132084173447,0.0113149574178245,0.00989696815152428,0.00809226581347039,0.00924298016717134,0.0151209147947696,0.00889963137066639,0.00856823582196592,0.00784207986177111,0.00656286988743592,0.00638574227890909,0.00632873944255968,0.0117981902503749,0.00569169034634083,0.00641297156009028,0.0118818107193294,0.0108697766315486,0.00849822921581991,0.00769349897872277,0.0056857897992837,0.00764339180373073,0.0113458414288651,0.00854474657420982,0.00663866131347594,0.00794858105314132,0.00723253235150505,0.00736978889586569,0.00731513574929066,0.00665198837084348,0.00621077977935904,0.0083669853428076,0.00545881582341918,0.00716723767760583,0.00963690129333673,0.00848847145170275,0.00715247932057511,0.00774203979413973,0.00589978177004898,0.00609776930382582,0.00670972509500096,0.00601170477661951,0.00619805816303677,0.00558436331326375,0.0059227324668359,0.0069011309550388,0.00523282877462485,0.0106634348954137,0.00897574872356532,0.0077146166200764,0.00793223050503652,0.00726296900339484,0.00799849477772929,0.00672550894457267,0.0101991867535067,0.0067601651314571,0.00491107220227936,0.00679557728714989,0.00607434955872717,0.00623913415058934,0.00597259205465418,0.00592445408079958,0.00636220892517668,0.00592506519535486,0.0055326973899823,0.00513843741634044,0.00662047298025101,0.00650218997928842,0.00510123169164891,0.00487819595768866,0.0116236365876787,0.0105425892142946,0.00763970573661846,0.0076251323804022,0.0056446902297264,0.00700110929792361,0.00819099247980074,0.00785725878391616,0.00539642872404032,0.00711194363536926,0.0074698506312839,0.00808966922215993,0.00614426564867083,0.00596685884231843,0.00662233160866737,0.00598444425076474,0.00584217812007978,0.00467993496200085,0.00525171593496906,0.0056502228036235,0.00510680002200151,0.00383526149992576,0.00406820261799603,0.00454989391634301,0.00567667539767216,0.00576884755607874,0.0053225583516297,0.00427313691079779,0.00520899746486522,0.00936275577770372,0.00696966931870954,0.00746072608012268,0.00614236908284811,0.00702972774972143,0.00653311794606429,0.00708681195226537,0.00720374689108557,0.00711181496037485,0.00653915252177937,0.00550205638668082,0.00453827025294357,0.00524812409031123,0.00555030966189851,0.00573321474198174,0.00535839645942586,0.00525678282352633,0.00469030317960267,0.00553296176281742,0.00550581983088835,0.00460089427293837,0.00413354444384608,0.0043155436584617,0.00418697509531926,0.00490986423871312,0.00649559385246365,0.00471587689600024,0.00388302902322204,0.00836328854919186,0.00872584745653601,0.0068384304699741,0.00701441500434691,0.00738124481884295,0.00812197453950084,0.00536875871994949,0.00476180258889939,0.00538237658154135,0.00618163263990614,0.00703695252898061,0.00569973406243966,0.00556888879506094,0.00654979396865681,0.00686079913999765,0.00637139459663981,0.00466892210735175,0.00432093425807831,0.00663608490350661,0.00514004736678627,0.00579561674001901,0.00532727144611923,0.00457101205265672,0.00412155928961007,0.00488802073563071,0.00507857628550753,0.00530366878087138,0.0051850358089707,0.00444633654591665,0.00532149391541741,0.00505513288950813,0.00447581084787349,0.00681676582967355,0.00806091184115748,0.00503912620916044,0.0066543306673835,0.00583605533119928,0.00589284546726605,0.00688624649958644,0.00630367398000101,0.0065397238398327,0.00512149844214985,0.00624122483415589,0.00690444408824805,0.0056401431322629,0.00443054729652171,0.0059900652556286,0.00532882894516239,0.00611838588125516,0.00492871011042444,0.00430819833435986,0.00505096066484451,0.00435542949533606,0.00507352044816557,0.00534383735998142,0.00546102938804836,0.00511930902063292,0.00455793113253128,0.00381462343944173,0.00734388910920167,0.00684900805800562,0.00627812806291553,0.00656522882647257,0.00622160160862516,0.00608630022268625,0.00550172107484933,0.00470981857582629,0.00505816417704836,0.00628738941681996,0.00684571830479335],"mode":"markers+lines","name":"eval","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.264584281254369,0.0976005191630076,0.0518760510119198,0.0416728737789887,0.0446009505273634,0.0337885212960721,0.0467264798879984,0.0337818921449372,0.0311652704392935,0.0360687730147434,0.0269604613146239,0.0329705140970145,0.0269539255325873,0.02685669669522,0.029278364503783,0.0254764884531036,0.0259263632053991,0.0223990102649818,0.0238615302354397,0.025829499221307,0.0202046613289976,0.0213029298505815,0.0201641987355519,0.0248071074442095,0.0198604592352465,0.0182505592519027,0.0195001909869725,0.0198391008985858,0.0191755154467621,0.0217237946767811,0.0159085358846912,0.0163433429260681,0.016759433970503,0.0192275745749161,0.0177030964175868,0.0163618079166913,0.0128421800655152,0.0139707116076838,0.0234951746159305,0.0187252492207929,0.00946994990323826,0.0115228196322498,0.012893405469968,0.0142900034121454,0.0130459207408453,0.0124584365057804,0.0152730428537472,0.0146678233096059,0.0135435809376808,0.0163997815622781,0.0134925111212416,0.0114184112196039,0.0145427973395159,0.0130839812851386,0.0127735880585066,0.0138096453900722,0.0127366126081973,0.0122095502893938,0.0116847414885587,0.0139107165731321,0.0118078509566384,0.0151248362389356,0.013994150945525,0.0124105703198368,0.0113772594299357,0.0113417299484918,0.0139302970669235,0.0133164009264222,0.0106815228270603,0.0103662044524658,0.0129338917842213,0.0128661658673399,0.0112699318712224,0.0101279162554307,0.00929812934108949,0.0123203404695671,0.011978302556592,0.0105315669761219,0.0113391038270933,0.0129153225113575,0.0122765259573794,0.0128208159571194,0.0123514858268918,0.0114193664000422,0.0125265429172016,0.0117394790702363,0.00914673148680939,0.0121636473675662,0.0114931771783733,0.0108552755637582,0.0102570951039858,0.0106905989197604,0.00891156588735252,0.0112901029185439,0.0109795426285971,0.0107665517592746,0.0105101636556683,0.00994740568004806,0.0106350084664746,0.0106667376694125,0.00909076290765265,0.0127259300059495,0.0106685411800308,0.0104925498100316,0.00976885718237758,0.0105779910008812,0.0102219274542198,0.0111509602073226,0.010162875706099,0.00937406325812974,0.00973264610179172,0.0110254604485385,0.0106586856134431,0.00962525092727821,0.00990190101258431,0.0105452824241775,0.0104487591130176,0.00983503234106756,0.00914489709277817,0.0100965179482232,0.0106953142513211,0.0102236343344213,0.00856012661353021,0.00978953739057929,0.0122057964681327,0.0108820889879902,0.00996100118631476,0.00943069159246103,0.00864369199340142,0.00948916863994174,0.0104382814716867,0.00934321770097876,0.00859432142290023,0.00992051578218531,0.0103763291542188,0.00944370395299396,0.00816547314137603,0.0112615658934957,0.0108515975978784,0.0102734283477908,0.00967149493158178,0.00889218977997875,0.00969559016388012,0.0093289335897649,0.00780890020623182,0.00764234118515299,0.00823106428038014,0.00901251524268563,0.00994855406119442,0.0101467082147024,0.00918238460884494,0.00792101536663043,0.0102507337940098,0.0104122370324437,0.00928119216033522,0.00925514150390472,0.00857762125767384,0.00949755756082537,0.0094667869549213,0.00972519963458466,0.00996361986412761,0.00941927059224034,0.00836636783601052,0.00807706151133728,0.00896353582822872,0.00939864394804659,0.00975549971036106,0.00952170818822434,0.00877138765989526,0.00910933772516744,0.0083339085722182,0.00975039550164272,0.00925757577669841,0.00825433071859276,0.00818641290396757,0.0079347878396553,0.00844849777673888,0.00932787747051481,0.00894642844746021,0.0075157746120686,0.00899948954786631,0.0104541455699972,0.00977370709750612,0.00973353285096042,0.00929804672547164,0.00939474314404163,0.00884035804863467,0.00773598306011942,0.00763284364498715,0.00848138923136138,0.00870758391890109,0.00934299154664087,0.00846417957227576,0.00832744581256273,0.00942982592941725,0.00954097216826156,0.00825445472076555,0.00750231643077148,0.00947487580014658,0.00994114597607326,0.00977482202093735,0.00982646543893371,0.00911074059503368,0.00778156456703781,0.00820482277500807,0.00879588271882704,0.0100729237629125,0.00922751717697985,0.00890344473843574,0.00880888944517271,0.00923605503469311,0.00846954590939401,0.00761801289910147,0.0101978939895131,0.00898521905330141,0.00851479289544929,0.00876586844929194,0.00888631748080662,0.00884895479152966,0.0095658596500966,0.00864020950392682,0.00848903782003414,0.00838271543010476,0.00882523427233252,0.00887845874138965,0.00739657879570619,0.00876893597864184,0.00949998696801967,0.00933534551442697,0.00975136935621041,0.00823573614888773,0.00859337195751257,0.00837154482980812,0.00856863773003212,0.0092776754121599,0.00932487716427801,0.00948287707935685,0.0082332560661757,0.00776872182926809,0.00791928360972818,0.00952532216770382,0.00849450813714131,0.00898537872560498,0.00871799893114645,0.00889982158874118,0.00801320099097868,0.00808245977168881,0.00764024007447416,0.0075896659544064,0.00873924158997802],"mode":"markers+lines","name":"train","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.219692731630187,0.0287925079201462,0.0387209315990709,0.0276884379894956,0.019121964572414,0.019467713089865,0.0185013112234156,0.0171276963659245,0.0155722859902004,0.0134947523410239,0.0137453363130083,0.0141233159722426,0.0121631852278234,0.0245653567722083,0.0112331374850214,0.0141037382959502,0.0118674001637786,0.0105497978567366,0.0173575127683552,0.0107716593867409,0.00991543682293278,0.0104683217265634,0.0122511903224345,0.00974630870514747,0.00966672421256559,0.0117169419790851,0.00949270389756087,0.0102322440145976,0.00796487142591756,0.0104602724514368,0.00876555980344192,0.00877086388909514,0.0107938672357687,0.00883124366199634,0.00768349847949051,0.00800478712509098,0.00580256278203615,0.013434302454837,0.0315848354121966,0.00490110038760179,0.00608732470564106,0.0102268146321989,0.00924316103099241,0.0130356471844335,0.00881805595710494,0.00992837260627853,0.014390685826612,0.00887125431714323,0.0112404377970596,0.00869817607666441,0.00698634874188381,0.00753817300476826,0.00874307196633882,0.00626149704760086,0.0132132084173447,0.0113149574178245,0.00989696815152428,0.00809226581347039,0.00924298016717134,0.0151209147947696,0.00889963137066639,0.00856823582196592,0.00784207986177111,0.00656286988743592,0.00638574227890909,0.00632873944255968,0.0117981902503749,0.00569169034634083,0.00641297156009028,0.0118818107193294,0.0108697766315486,0.00849822921581991,0.00769349897872277,0.0056857897992837,0.00764339180373073,0.0113458414288651,0.00854474657420982,0.00663866131347594,0.00794858105314132,0.00723253235150505,0.00736978889586569,0.00731513574929066,0.00665198837084348,0.00621077977935904,0.0083669853428076,0.00545881582341918,0.00716723767760583,0.00963690129333673,0.00848847145170275,0.00715247932057511,0.00774203979413973,0.00589978177004898,0.00609776930382582,0.00670972509500096,0.00601170477661951,0.00619805816303677,0.00558436331326375,0.0059227324668359,0.0069011309550388,0.00523282877462485,0.0106634348954137,0.00897574872356532,0.0077146166200764,0.00793223050503652,0.00726296900339484,0.00799849477772929,0.00672550894457267,0.0101991867535067,0.0067601651314571,0.00491107220227936,0.00679557728714989,0.00607434955872717,0.00623913415058934,0.00597259205465418,0.00592445408079958,0.00636220892517668,0.00592506519535486,0.0055326973899823,0.00513843741634044,0.00662047298025101,0.00650218997928842,0.00510123169164891,0.00487819595768866,0.0116236365876787,0.0105425892142946,0.00763970573661846,0.0076251323804022,0.0056446902297264,0.00700110929792361,0.00819099247980074,0.00785725878391616,0.00539642872404032,0.00711194363536926,0.0074698506312839,0.00808966922215993,0.00614426564867083,0.00596685884231843,0.00662233160866737,0.00598444425076474,0.00584217812007978,0.00467993496200085,0.00525171593496906,0.0056502228036235,0.00510680002200151,0.00383526149992576,0.00406820261799603,0.00454989391634301,0.00567667539767216,0.00576884755607874,0.0053225583516297,0.00427313691079779,0.00520899746486522,0.00936275577770372,0.00696966931870954,0.00746072608012268,0.00614236908284811,0.00702972774972143,0.00653311794606429,0.00708681195226537,0.00720374689108557,0.00711181496037485,0.00653915252177937,0.00550205638668082,0.00453827025294357,0.00524812409031123,0.00555030966189851,0.00573321474198174,0.00535839645942586,0.00525678282352633,0.00469030317960267,0.00553296176281742,0.00550581983088835,0.00460089427293837,0.00413354444384608,0.0043155436584617,0.00418697509531926,0.00490986423871312,0.00649559385246365,0.00471587689600024,0.00388302902322204,0.00836328854919186,0.00872584745653601,0.0068384304699741,0.00701441500434691,0.00738124481884295,0.00812197453950084,0.00536875871994949,0.00476180258889939,0.00538237658154135,0.00618163263990614,0.00703695252898061,0.00569973406243966,0.00556888879506094,0.00654979396865681,0.00686079913999765,0.00637139459663981,0.00466892210735175,0.00432093425807831,0.00663608490350661,0.00514004736678627,0.00579561674001901,0.00532727144611923,0.00457101205265672,0.00412155928961007,0.00488802073563071,0.00507857628550753,0.00530366878087138,0.0051850358089707,0.00444633654591665,0.00532149391541741,0.00505513288950813,0.00447581084787349,0.00681676582967355,0.00806091184115748,0.00503912620916044,0.0066543306673835,0.00583605533119928,0.00589284546726605,0.00688624649958644,0.00630367398000101,0.0065397238398327,0.00512149844214985,0.00624122483415589,0.00690444408824805,0.0056401431322629,0.00443054729652171,0.0059900652556286,0.00532882894516239,0.00611838588125516,0.00492871011042444,0.00430819833435986,0.00505096066484451,0.00435542949533606,0.00507352044816557,0.00534383735998142,0.00546102938804836,0.00511930902063292,0.00455793113253128,0.00381462343944173,0.00734388910920167,0.00684900805800562,0.00627812806291553,0.00656522882647257,0.00622160160862516,0.00608630022268625,0.00550172107484933,0.00470981857582629,0.00505816417704836,0.00628738941681996,0.00684571830479335],"mode":"markers+lines","name":"eval","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="build-the-inference-symbols" class="section level3">
<h3>Build the inference symbols</h3>
<p>Two symbols:</p>
<ul>
<li>first unrolled to the length of the inference sequence.</li>
<li>second of length one on which to iterate up to the number of the desired inference steps.</li>
</ul>
<pre class="r"><code>ctx &lt;- mx.cpu()

pred_length = 80
data = mx.nd.array(x[, , 1, drop = F])
infer_length_ini &lt;- dim(data)[2]

symbol.infer.ini &lt;- rnn.graph.unroll(seq_len = infer_length_ini,
                                     num_rnn_layer = 2, 
                                     num_hidden = 50,
                                     input_size = NULL,
                                     num_embed = NULL, 
                                     num_decode = 1,
                                     masking = F, 
                                     loss_output = &quot;linear&quot;,
                                     dropout = 0, 
                                     ignore_label = -1,
                                     cell_type = &quot;lstm&quot;,
                                     output_last_state = T,
                                     config = &quot;one-to-one&quot;)

symbol.infer &lt;- rnn.graph.unroll(seq_len = 1,
                                 num_rnn_layer = 2, 
                                 num_hidden = 50,
                                 input_size = NULL,
                                 num_embed = NULL, 
                                 num_decode = 1,
                                 masking = F, 
                                 loss_output = &quot;linear&quot;,
                                 dropout = 0, 
                                 ignore_label = -1,
                                 cell_type = &quot;lstm&quot;,
                                 output_last_state = T,
                                 config = &quot;one-to-one&quot;)</code></pre>
</div>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>predict &lt;- numeric()

infer &lt;- mxnet:::mx.rnn.infer.unroll(data = data, 
                             symbol = symbol.infer.ini,
                             num_hidden = 50,
                             arg.params = model$arg.params,
                             aux.params = model$aux.params,
                             init_states = NULL,
                             ctx = ctx)

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  
  infer &lt;- mxnet:::mx.rnn.infer.unroll(data = data, 
                               symbol = symbol.infer,
                               num_hidden = 50,
                               arg.params = model$arg.params,
                               aux.params = model$aux.params,
                               init_states = infer[-1],
                               ctx = ctx)
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
  
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)</code></pre>
<div id="543342435ed7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="543342435ed7">{"x":{"visdat":{"54333d5e478d":["function () ","plotlyVisDat"]},"cur_data":"54333d5e478d","attrs":{"54333d5e478d":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.863536786070405,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.710602493296678,-0.504285850587935,-0.263602960533395,-0.00495596434299291,0.254028772627265,0.495701868545371,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299303,-0.254028772627265,-0.49570186854537,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296679,-0.504285850587935,-0.263602960533395,-0.00495596434299404,0.254028772627264,0.49570186854537,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299416,-0.254028772627264,-0.495701868545369,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.71060249329668,-0.504285850587935,-0.263602960533395,-0.00495596434299429,0.254028772627264,0.495701868545369,0.703593701308178,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413397,0.71060249329668,0.504285850587935,0.263602960533397,0.00495596434299441,-0.254028772627262,-0.495701868545369,-0.70359370130818,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.71060249329668,-0.504285850587935,-0.263602960533397,-0.00495596434299453,0.254028772627262,0.495701868545369,0.70359370130818,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413399,0.71060249329668,0.504285850587936,0.263602960533398,0.00495596434299465,-0.254028772627262,-0.495701868545369,-0.703593701308179,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575],"mode":"lines","name":"hist","alpha":1,"sizes":[10,100],"type":"scatter"},"54333d5e478d.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.868492750413399,-0.71060249329668,-0.504285850587936,-0.263602960533398,-0.00495596434299478,0.254028772627261,0.495701868545369,0.703593701308177,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413399,0.71060249329668,0.504285850587939,0.263602960533398,0.0049559643429949,-0.254028772627261,-0.495701868545369,-0.703593701308177,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296683,-0.504285850587939,-0.263602960533398,-0.00495596434299502,0.254028772627265,0.495701868545366,0.703593701308177,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841576,0.8684927504134,0.71060249329668,0.504285850587936,0.263602960533401,0.0049559643429987,-0.254028772627261,-0.495701868545369,-0.703593701308179,-0.863536786070401,-0.964631265923942,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296683,-0.504285850587939,-0.263602960533398,-0.00495596434299527,0.254028772627264,0.495701868545365,0.703593701308176,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841576,0.8684927504134,0.71060249329668,0.504285850587936,0.263602960533402,0.00495596434299894,-0.254028772627261,-0.495701868545368,-0.703593701308179,-0.863536786070401,-0.964631265923942,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296683,-0.504285850587939,-0.263602960533398,-0.00495596434299551,0.254028772627257,0.495701868545365,0.703593701308176],"mode":"lines","name":"real","alpha":1,"sizes":[10,100],"type":"scatter"},"54333d5e478d.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.533993422985077,-0.0412041693925858,0.268205374479294,0.359492808580399,-0.217053294181824,-0.367453128099442,0.218340292572975,-0.00397839397192001,-0.113606512546539,0.500780045986176,0.33423125743866,-0.417654663324356,0.0135663598775864,0.667019188404083,0.0197520032525063,-0.369827300310135,0.0220253430306911,0.00295297801494598,-0.00783542916178703,0.378443658351898,0.295744359493256,-0.303738951683044,-0.16056801378727,0.391119211912155,-0.267958104610443,-0.481308341026306,0.127154901623726,0.0211756341159344,0.0061236284673214,0.389694005250931,0.27567383646965,-0.303940892219543,-0.169483125209808,0.274282157421112,-0.357046276330948,-0.366896867752075,0.398470222949982,0.0199212022125721,-0.294465869665146,0.559538900852203,0.305745422840118,-0.329828262329102,0.0734224170446396,0.0811426639556885,-0.473691761493683,-0.310505598783493,0.585620105266571,0.274627238512039,-0.35321119427681,0.112447530031204,0.0393392778933048,-0.310515612363815,0.456170439720154,0.440879642963409,-0.173251777887344,-0.0958500728011131,0.0802571475505829,-0.411499321460724,-0.510043740272522,0.697143197059631,0.359416007995605,-0.324529349803925,0.171875759959221,-0.0556380227208138,-0.485853999853134,-0.192104309797287,0.223932340741158,0.163674399256706,0.174882769584656,0.312052130699158,-0.318852961063385,-0.402667015790939,0.131081029772758,-0.0516891404986382,-0.106553345918655,0.477457880973816,0.329734802246094,-0.386044502258301,0.0017138384282589,0.654371023178101],"mode":"lines","name":"pred","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.863536786070405,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.710602493296678,-0.504285850587935,-0.263602960533395,-0.00495596434299291,0.254028772627265,0.495701868545371,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299303,-0.254028772627265,-0.49570186854537,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296679,-0.504285850587935,-0.263602960533395,-0.00495596434299404,0.254028772627264,0.49570186854537,0.70359370130818,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413398,0.710602493296678,0.504285850587935,0.263602960533395,0.00495596434299416,-0.254028772627264,-0.495701868545369,-0.70359370130818,-0.863536786070404,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.71060249329668,-0.504285850587935,-0.263602960533395,-0.00495596434299429,0.254028772627264,0.495701868545369,0.703593701308178,0.863536786070404,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413397,0.71060249329668,0.504285850587935,0.263602960533397,0.00495596434299441,-0.254028772627262,-0.495701868545369,-0.70359370130818,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413397,-0.71060249329668,-0.504285850587935,-0.263602960533397,-0.00495596434299453,0.254028772627262,0.495701868545369,0.70359370130818,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413399,0.71060249329668,0.504285850587936,0.263602960533398,0.00495596434299465,-0.254028772627262,-0.495701868545369,-0.703593701308179,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575],"mode":"lines","name":"hist","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.868492750413399,-0.71060249329668,-0.504285850587936,-0.263602960533398,-0.00495596434299478,0.254028772627261,0.495701868545369,0.703593701308177,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841575,0.868492750413399,0.71060249329668,0.504285850587939,0.263602960533398,0.0049559643429949,-0.254028772627261,-0.495701868545369,-0.703593701308177,-0.863536786070403,-0.964631265923943,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296683,-0.504285850587939,-0.263602960533398,-0.00495596434299502,0.254028772627265,0.495701868545366,0.703593701308177,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841576,0.8684927504134,0.71060249329668,0.504285850587936,0.263602960533401,0.0049559643429987,-0.254028772627261,-0.495701868545369,-0.703593701308179,-0.863536786070401,-0.964631265923942,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296683,-0.504285850587939,-0.263602960533398,-0.00495596434299527,0.254028772627264,0.495701868545365,0.703593701308176,0.863536786070403,0.964631265923943,0.999987719133306,0.967196661841576,0.8684927504134,0.71060249329668,0.504285850587936,0.263602960533402,0.00495596434299894,-0.254028772627261,-0.495701868545368,-0.703593701308179,-0.863536786070401,-0.964631265923942,-0.999987719133306,-0.967196661841575,-0.868492750413398,-0.710602493296683,-0.504285850587939,-0.263602960533398,-0.00495596434299551,0.254028772627257,0.495701868545365,0.703593701308176],"mode":"lines","name":"real","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.533993422985077,-0.0412041693925858,0.268205374479294,0.359492808580399,-0.217053294181824,-0.367453128099442,0.218340292572975,-0.00397839397192001,-0.113606512546539,0.500780045986176,0.33423125743866,-0.417654663324356,0.0135663598775864,0.667019188404083,0.0197520032525063,-0.369827300310135,0.0220253430306911,0.00295297801494598,-0.00783542916178703,0.378443658351898,0.295744359493256,-0.303738951683044,-0.16056801378727,0.391119211912155,-0.267958104610443,-0.481308341026306,0.127154901623726,0.0211756341159344,0.0061236284673214,0.389694005250931,0.27567383646965,-0.303940892219543,-0.169483125209808,0.274282157421112,-0.357046276330948,-0.366896867752075,0.398470222949982,0.0199212022125721,-0.294465869665146,0.559538900852203,0.305745422840118,-0.329828262329102,0.0734224170446396,0.0811426639556885,-0.473691761493683,-0.310505598783493,0.585620105266571,0.274627238512039,-0.35321119427681,0.112447530031204,0.0393392778933048,-0.310515612363815,0.456170439720154,0.440879642963409,-0.173251777887344,-0.0958500728011131,0.0802571475505829,-0.411499321460724,-0.510043740272522,0.697143197059631,0.359416007995605,-0.324529349803925,0.171875759959221,-0.0556380227208138,-0.485853999853134,-0.192104309797287,0.223932340741158,0.163674399256706,0.174882769584656,0.312052130699158,-0.318852961063385,-0.402667015790939,0.131081029772758,-0.0516891404986382,-0.106553345918655,0.477457880973816,0.329734802246094,-0.386044502258301,0.0017138384282589,0.654371023178101],"mode":"lines","name":"pred","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
