<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-0.9.2/grViz.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET R</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU">GPU</a></li>
        <li><a href="TimeSeries_CPU">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<p>It relies on an explicit symbolic construction of the RNN cells (LSTM or GRU), thus supporting training on CPU unlike the FusedRNN operator that is CUDA dependent.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)
source(&quot;../rnn.graph.R&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<pre class="r"><code>seq_len = 100
samples = 192

seeds &lt;- runif(samples, min = -pi, max = pi)
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, samples))
y &lt;- pts[-1, ]

p1 = plot_ly(x = 1:dim(x)[2], y = x[1,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p2 = plot_ly(x = 1:length(y[,1]), y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;%
  add_trace(x = 1:length(y[,2]), y = y[,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p1</code></pre>
<div id="ff47d980a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="ff47d980a">{"x":{"visdat":{"ff15cfe719":["function () ","plotlyVisDat"]},"cur_data":"ff15cfe719","attrs":{"ff15cfe719":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.913317580985518,0.776793480655267,0.587332188330282,0.357845177982921,0.103971610123142,-0.156987451145319,-0.407248077052257,-0.629755419517351,-0.809345970862376,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655267,-0.587332188330282,-0.357845177982921,-0.103971610123143,0.156987451145319,0.407248077052257,0.629755419517351,0.809345970862376,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145319,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.156987451145317,0.407248077052256,0.629755419517352,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145317,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.91331758098552,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.15698745114532,0.407248077052256,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924,0.103971610123143,-0.15698745114532,-0.407248077052256,-0.629755419517351,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982924,-0.103971610123143,0.156987451145316,0.407248077052255,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"ff15cfe719.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.216205751980134,0.0438586917837215,0.300934238182431,0.537501613566351,0.737439142249139,0.887121412063451,0.976347823683089,0.999037744609792,0.953644894229272,0.843262720279729,0.675413585500658,0.461536131043442,0.216205751980134,-0.0438586917837211,-0.300934238182431,-0.53750161356635,-0.737439142249138,-0.887121412063451,-0.976347823683089,-0.999037744609792,-0.953644894229272,-0.84326272027973,-0.675413585500658,-0.461536131043442,-0.216205751980134,0.043858691783721,0.30093423818243,0.53750161356635,0.737439142249138,0.887121412063451,0.976347823683089,0.999037744609792,0.953644894229273,0.84326272027973,0.67541358550066,0.461536131043442,0.216205751980133,-0.04385869178372,-0.300934238182431,-0.537501613566349,-0.737439142249138,-0.88712141206345,-0.976347823683089,-0.999037744609792,-0.953644894229273,-0.84326272027973,-0.67541358550066,-0.461536131043442,-0.216205751980133,0.0438586917837199,0.300934238182431,0.537501613566349,0.737439142249138,0.88712141206345,0.976347823683089,0.999037744609792,0.953644894229273,0.84326272027973,0.67541358550066,0.461536131043442,0.216205751980137,-0.0438586917837198,-0.300934238182431,-0.537501613566349,-0.737439142249138,-0.887121412063451,-0.976347823683089,-0.999037744609792,-0.953644894229273,-0.84326272027973,-0.67541358550066,-0.461536131043443,-0.216205751980133,0.0438586917837196,0.300934238182431,0.537501613566349,0.737439142249138,0.887121412063451,0.976347823683089,0.999037744609792,0.953644894229273,0.84326272027973,0.67541358550066,0.461536131043443,0.216205751980134,-0.0438586917837195,-0.300934238182431,-0.537501613566349,-0.737439142249138,-0.88712141206345,-0.976347823683089,-0.999037744609792,-0.953644894229273,-0.84326272027973,-0.67541358550066,-0.461536131043443,-0.216205751980134,0.0438586917837194,0.300934238182431,0.537501613566349],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"ff15cfe719.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.996976286599318,-0.942893248247405,-0.824553593232198,-0.650021973477458,-0.43119243044233,-0.182977835851741,0.0777063958669731,0.333095065123244,0.565783856156988,0.759915412395664,0.902259989099171,0.983117038600702,0.996976286599318,0.942893248247405,0.824553593232198,0.650021973477458,0.431192430442331,0.182977835851742,-0.077706395866973,-0.333095065123244,-0.565783856156987,-0.759915412395663,-0.902259989099171,-0.983117038600701,-0.996976286599318,-0.942893248247405,-0.824553593232198,-0.650021973477458,-0.431192430442331,-0.182977835851742,0.077706395866972,0.333095065123243,0.565783856156987,0.759915412395663,0.90225998909917,0.983117038600701,0.996976286599318,0.942893248247405,0.824553593232198,0.650021973477458,0.431192430442332,0.182977835851743,-0.0777063958669727,-0.333095065123243,-0.565783856156987,-0.759915412395663,-0.90225998909917,-0.983117038600701,-0.996976286599318,-0.942893248247405,-0.824553593232199,-0.650021973477459,-0.431192430442332,-0.182977835851743,0.0777063958669708,0.333095065123243,0.565783856156987,0.759915412395663,0.90225998909917,0.983117038600701,0.996976286599318,0.942893248247405,0.824553593232199,0.65002197347746,0.431192430442332,0.182977835851741,-0.0777063958669707,-0.333095065123243,-0.565783856156985,-0.759915412395663,-0.902259989099169,-0.983117038600701,-0.996976286599318,-0.942893248247406,-0.824553593232199,-0.65002197347746,-0.431192430442332,-0.182977835851742,0.0777063958669706,0.333095065123243,0.565783856156985,0.759915412395663,0.902259989099169,0.983117038600701,0.996976286599318,0.942893248247406,0.824553593232199,0.65002197347746,0.431192430442332,0.182977835851745,-0.0777063958669705,-0.333095065123243,-0.565783856156985,-0.759915412395662,-0.902259989099169,-0.983117038600701,-0.996976286599318,-0.942893248247406,-0.824553593232199,-0.65002197347746],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"ff15cfe719.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.00538098464119278,-0.264012930059019,-0.504652830595319,-0.710901474704783,-0.86870335813335,-0.967304543305306,-0.999985522397345,-0.964519140692216,-0.863322373492157,-0.703291613246287,-0.495332691802026,-0.253617665987434,0.00538098464119266,0.264012930059019,0.504652830595319,0.710901474704783,0.86870335813335,0.967304543305306,0.999985522397345,0.964519140692216,0.863322373492158,0.703291613246287,0.495332691802026,0.253617665987434,-0.00538098464119253,-0.264012930059019,-0.504652830595319,-0.710901474704782,-0.86870335813335,-0.967304543305306,-0.999985522397345,-0.964519140692216,-0.863322373492157,-0.703291613246287,-0.495332691802027,-0.253617665987435,0.00538098464119286,0.264012930059019,0.504652830595319,0.710901474704782,0.868703358133349,0.967304543305306,0.999985522397345,0.964519140692216,0.863322373492158,0.703291613246288,0.495332691802027,0.253617665987435,-0.00538098464119273,-0.264012930059019,-0.504652830595319,-0.710901474704782,-0.868703358133349,-0.967304543305306,-0.999985522397345,-0.964519140692216,-0.863322373492158,-0.703291613246288,-0.495332691802027,-0.253617665987435,0.00538098464119084,0.264012930059019,0.504652830595319,0.710901474704781,0.868703358133349,0.967304543305306,0.999985522397345,0.964519140692216,0.863322373492159,0.703291613246288,0.495332691802029,0.253617665987435,-0.00538098464119249,-0.264012930059017,-0.504652830595319,-0.710901474704781,-0.868703358133349,-0.967304543305306,-0.999985522397345,-0.964519140692217,-0.863322373492159,-0.703291613246288,-0.495332691802029,-0.253617665987435,0.00538098464119237,0.264012930059017,0.504652830595319,0.710901474704781,0.868703358133349,0.967304543305305,0.999985522397345,0.964519140692217,0.863322373492159,0.703291613246288,0.495332691802029,0.253617665987435,-0.00538098464119224,-0.264012930059017,-0.504652830595318,-0.710901474704781],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"ff15cfe719.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.852720134796931,0.958863198720887,0.999661320248372,0.972334174819372,0.878744062234631,0.725268994001825,0.522368042391476,0.283868571946156,0.0260239274376998,-0.233594204719062,-0.477293277856895,-0.688465602873216,-0.852720134796931,-0.958863198720886,-0.999661320248372,-0.972334174819372,-0.878744062234631,-0.725268994001825,-0.522368042391477,-0.283868571946156,-0.0260239274377003,0.233594204719062,0.477293277856895,0.688465602873216,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819372,0.878744062234632,0.725268994001825,0.522368042391478,0.283868571946156,0.0260239274377004,-0.233594204719061,-0.477293277856894,-0.688465602873215,-0.852720134796931,-0.958863198720886,-0.999661320248372,-0.972334174819372,-0.878744062234632,-0.725268994001826,-0.522368042391477,-0.283868571946156,-0.0260239274377006,0.233594204719061,0.477293277856894,0.688465602873215,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819372,0.878744062234632,0.725268994001826,0.522368042391478,0.283868571946156,0.0260239274377007,-0.233594204719061,-0.477293277856895,-0.688465602873215,-0.852720134796929,-0.958863198720886,-0.999661320248372,-0.972334174819373,-0.878744062234632,-0.725268994001825,-0.522368042391479,-0.283868571946156,-0.0260239274377026,0.233594204719061,0.477293277856892,0.688465602873215,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819373,0.878744062234632,0.725268994001825,0.522368042391479,0.283868571946156,0.0260239274377027,-0.23359420471906,-0.477293277856892,-0.688465602873215,-0.852720134796931,-0.958863198720886,-0.999661320248372,-0.972334174819373,-0.878744062234632,-0.725268994001827,-0.522368042391479,-0.283868571946157,-0.0260239274377028,0.23359420471906,0.477293277856892,0.688465602873215,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819373],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.913317580985518,0.776793480655267,0.587332188330282,0.357845177982921,0.103971610123142,-0.156987451145319,-0.407248077052257,-0.629755419517351,-0.809345970862376,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655267,-0.587332188330282,-0.357845177982921,-0.103971610123143,0.156987451145319,0.407248077052257,0.629755419517351,0.809345970862376,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145319,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.156987451145317,0.407248077052256,0.629755419517352,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145317,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.91331758098552,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.15698745114532,0.407248077052256,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924,0.103971610123143,-0.15698745114532,-0.407248077052256,-0.629755419517351,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982924,-0.103971610123143,0.156987451145316,0.407248077052255,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.216205751980134,0.0438586917837215,0.300934238182431,0.537501613566351,0.737439142249139,0.887121412063451,0.976347823683089,0.999037744609792,0.953644894229272,0.843262720279729,0.675413585500658,0.461536131043442,0.216205751980134,-0.0438586917837211,-0.300934238182431,-0.53750161356635,-0.737439142249138,-0.887121412063451,-0.976347823683089,-0.999037744609792,-0.953644894229272,-0.84326272027973,-0.675413585500658,-0.461536131043442,-0.216205751980134,0.043858691783721,0.30093423818243,0.53750161356635,0.737439142249138,0.887121412063451,0.976347823683089,0.999037744609792,0.953644894229273,0.84326272027973,0.67541358550066,0.461536131043442,0.216205751980133,-0.04385869178372,-0.300934238182431,-0.537501613566349,-0.737439142249138,-0.88712141206345,-0.976347823683089,-0.999037744609792,-0.953644894229273,-0.84326272027973,-0.67541358550066,-0.461536131043442,-0.216205751980133,0.0438586917837199,0.300934238182431,0.537501613566349,0.737439142249138,0.88712141206345,0.976347823683089,0.999037744609792,0.953644894229273,0.84326272027973,0.67541358550066,0.461536131043442,0.216205751980137,-0.0438586917837198,-0.300934238182431,-0.537501613566349,-0.737439142249138,-0.887121412063451,-0.976347823683089,-0.999037744609792,-0.953644894229273,-0.84326272027973,-0.67541358550066,-0.461536131043443,-0.216205751980133,0.0438586917837196,0.300934238182431,0.537501613566349,0.737439142249138,0.887121412063451,0.976347823683089,0.999037744609792,0.953644894229273,0.84326272027973,0.67541358550066,0.461536131043443,0.216205751980134,-0.0438586917837195,-0.300934238182431,-0.537501613566349,-0.737439142249138,-0.88712141206345,-0.976347823683089,-0.999037744609792,-0.953644894229273,-0.84326272027973,-0.67541358550066,-0.461536131043443,-0.216205751980134,0.0438586917837194,0.300934238182431,0.537501613566349],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.996976286599318,-0.942893248247405,-0.824553593232198,-0.650021973477458,-0.43119243044233,-0.182977835851741,0.0777063958669731,0.333095065123244,0.565783856156988,0.759915412395664,0.902259989099171,0.983117038600702,0.996976286599318,0.942893248247405,0.824553593232198,0.650021973477458,0.431192430442331,0.182977835851742,-0.077706395866973,-0.333095065123244,-0.565783856156987,-0.759915412395663,-0.902259989099171,-0.983117038600701,-0.996976286599318,-0.942893248247405,-0.824553593232198,-0.650021973477458,-0.431192430442331,-0.182977835851742,0.077706395866972,0.333095065123243,0.565783856156987,0.759915412395663,0.90225998909917,0.983117038600701,0.996976286599318,0.942893248247405,0.824553593232198,0.650021973477458,0.431192430442332,0.182977835851743,-0.0777063958669727,-0.333095065123243,-0.565783856156987,-0.759915412395663,-0.90225998909917,-0.983117038600701,-0.996976286599318,-0.942893248247405,-0.824553593232199,-0.650021973477459,-0.431192430442332,-0.182977835851743,0.0777063958669708,0.333095065123243,0.565783856156987,0.759915412395663,0.90225998909917,0.983117038600701,0.996976286599318,0.942893248247405,0.824553593232199,0.65002197347746,0.431192430442332,0.182977835851741,-0.0777063958669707,-0.333095065123243,-0.565783856156985,-0.759915412395663,-0.902259989099169,-0.983117038600701,-0.996976286599318,-0.942893248247406,-0.824553593232199,-0.65002197347746,-0.431192430442332,-0.182977835851742,0.0777063958669706,0.333095065123243,0.565783856156985,0.759915412395663,0.902259989099169,0.983117038600701,0.996976286599318,0.942893248247406,0.824553593232199,0.65002197347746,0.431192430442332,0.182977835851745,-0.0777063958669705,-0.333095065123243,-0.565783856156985,-0.759915412395662,-0.902259989099169,-0.983117038600701,-0.996976286599318,-0.942893248247406,-0.824553593232199,-0.65002197347746],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.00538098464119278,-0.264012930059019,-0.504652830595319,-0.710901474704783,-0.86870335813335,-0.967304543305306,-0.999985522397345,-0.964519140692216,-0.863322373492157,-0.703291613246287,-0.495332691802026,-0.253617665987434,0.00538098464119266,0.264012930059019,0.504652830595319,0.710901474704783,0.86870335813335,0.967304543305306,0.999985522397345,0.964519140692216,0.863322373492158,0.703291613246287,0.495332691802026,0.253617665987434,-0.00538098464119253,-0.264012930059019,-0.504652830595319,-0.710901474704782,-0.86870335813335,-0.967304543305306,-0.999985522397345,-0.964519140692216,-0.863322373492157,-0.703291613246287,-0.495332691802027,-0.253617665987435,0.00538098464119286,0.264012930059019,0.504652830595319,0.710901474704782,0.868703358133349,0.967304543305306,0.999985522397345,0.964519140692216,0.863322373492158,0.703291613246288,0.495332691802027,0.253617665987435,-0.00538098464119273,-0.264012930059019,-0.504652830595319,-0.710901474704782,-0.868703358133349,-0.967304543305306,-0.999985522397345,-0.964519140692216,-0.863322373492158,-0.703291613246288,-0.495332691802027,-0.253617665987435,0.00538098464119084,0.264012930059019,0.504652830595319,0.710901474704781,0.868703358133349,0.967304543305306,0.999985522397345,0.964519140692216,0.863322373492159,0.703291613246288,0.495332691802029,0.253617665987435,-0.00538098464119249,-0.264012930059017,-0.504652830595319,-0.710901474704781,-0.868703358133349,-0.967304543305306,-0.999985522397345,-0.964519140692217,-0.863322373492159,-0.703291613246288,-0.495332691802029,-0.253617665987435,0.00538098464119237,0.264012930059017,0.504652830595319,0.710901474704781,0.868703358133349,0.967304543305305,0.999985522397345,0.964519140692217,0.863322373492159,0.703291613246288,0.495332691802029,0.253617665987435,-0.00538098464119224,-0.264012930059017,-0.504652830595318,-0.710901474704781],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.852720134796931,0.958863198720887,0.999661320248372,0.972334174819372,0.878744062234631,0.725268994001825,0.522368042391476,0.283868571946156,0.0260239274376998,-0.233594204719062,-0.477293277856895,-0.688465602873216,-0.852720134796931,-0.958863198720886,-0.999661320248372,-0.972334174819372,-0.878744062234631,-0.725268994001825,-0.522368042391477,-0.283868571946156,-0.0260239274377003,0.233594204719062,0.477293277856895,0.688465602873216,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819372,0.878744062234632,0.725268994001825,0.522368042391478,0.283868571946156,0.0260239274377004,-0.233594204719061,-0.477293277856894,-0.688465602873215,-0.852720134796931,-0.958863198720886,-0.999661320248372,-0.972334174819372,-0.878744062234632,-0.725268994001826,-0.522368042391477,-0.283868571946156,-0.0260239274377006,0.233594204719061,0.477293277856894,0.688465602873215,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819372,0.878744062234632,0.725268994001826,0.522368042391478,0.283868571946156,0.0260239274377007,-0.233594204719061,-0.477293277856895,-0.688465602873215,-0.852720134796929,-0.958863198720886,-0.999661320248372,-0.972334174819373,-0.878744062234632,-0.725268994001825,-0.522368042391479,-0.283868571946156,-0.0260239274377026,0.233594204719061,0.477293277856892,0.688465602873215,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819373,0.878744062234632,0.725268994001825,0.522368042391479,0.283868571946156,0.0260239274377027,-0.23359420471906,-0.477293277856892,-0.688465602873215,-0.852720134796931,-0.958863198720886,-0.999661320248372,-0.972334174819373,-0.878744062234632,-0.725268994001827,-0.522368042391479,-0.283868571946157,-0.0260239274377028,0.23359420471906,0.477293277856892,0.688465602873215,0.852720134796931,0.958863198720886,0.999661320248372,0.972334174819373],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<pre class="r"><code>batch.size = 16

train.data &lt;- mx.io.arrayiter(data = x[,,1:160, drop = F], label = y[, 1:160], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-(1:160), drop = F], label = y[, -(1:160)], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph.unroll(seq_len = 2, 
                           num_rnn_layer =  1, 
                           num_hidden = 50,
                           input_size = NULL,
                           num_embed = NULL, 
                           num_decode = 1,
                           masking = F, 
                           loss_output = &quot;linear&quot;,
                           dropout = 0.2, 
                           ignore_label = -1,
                           cell_type = &quot;lstm&quot;,
                           output_last_state = F,
                           config = &quot;one-to-one&quot;)

graph = graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;TD&quot;, 
                  shape=list(data = c(1, 2, batch.size), 
                             label = c(2, batch.size)))</code></pre>
<div id="htmlwidget-52aedf3818579648760c" style="width:672px;height:1152px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-52aedf3818579648760c">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"TD\"]\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"SliceChannel\nsplit0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"FullyConnected\nt1.l1.i2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"5\" [label = \"SliceChannel\nt1.l1.slice\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Activation\nactivation3\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"7\" [label = \"Activation\nactivation0\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"8\" [label = \"Activation\nactivation1\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"9\" [label = \"elemwise_mul\n_mul0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"10\" [label = \"Activation\nactivation4\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"11\" [label = \"elemwise_mul\n_mul1\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"12\" [label = \"FullyConnected\nt2.l1.i2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"13\" [label = \"FullyConnected\nt2.l1.h2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"14\" [label = \"elemwise_add\n_plus0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"15\" [label = \"SliceChannel\nt2.l1.slice\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"16\" [label = \"Activation\nactivation8\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"17\" [label = \"Activation\nactivation7\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"18\" [label = \"elemwise_mul\n_mul2\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"19\" [label = \"Activation\nactivation5\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"20\" [label = \"Activation\nactivation6\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"21\" [label = \"elemwise_mul\n_mul3\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"22\" [label = \"elemwise_add\n_plus1\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"23\" [label = \"Activation\nactivation9\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"24\" [label = \"elemwise_mul\n_mul4\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"25\" [label = \"Concat\nconcat\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"26\" [label = \"Reshape\nrnn_reshape\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"27\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"28\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"29\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"30\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"31\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"32\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [id = \"1\", color = \"black\", fontcolor = \"black\", label = \"1X2X16\"] \n\"2\"->\"3\" [id = \"2\", color = \"black\", fontcolor = \"black\", label = \"1X16X2\"] \n\"3\"->\"4\" [id = \"3\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"4\"->\"5\" [id = \"4\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"5\"->\"6\" [id = \"5\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"5\"->\"7\" [id = \"6\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"5\"->\"8\" [id = \"7\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"7\"->\"9\" [id = \"8\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"8\"->\"9\" [id = \"9\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"9\"->\"10\" [id = \"10\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"6\"->\"11\" [id = \"11\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"10\"->\"11\" [id = \"12\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"3\"->\"12\" [id = \"13\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"11\"->\"13\" [id = \"14\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"12\"->\"14\" [id = \"15\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"13\"->\"14\" [id = \"16\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"14\"->\"15\" [id = \"17\", color = \"black\", fontcolor = \"black\", label = \"200X16\"] \n\"15\"->\"16\" [id = \"18\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"15\"->\"17\" [id = \"19\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"17\"->\"18\" [id = \"20\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"9\"->\"18\" [id = \"21\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"15\"->\"19\" [id = \"22\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"15\"->\"20\" [id = \"23\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"19\"->\"21\" [id = \"24\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"20\"->\"21\" [id = \"25\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"18\"->\"22\" [id = \"26\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"21\"->\"22\" [id = \"27\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"22\"->\"23\" [id = \"28\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"16\"->\"24\" [id = \"29\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"23\"->\"24\" [id = \"30\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"11\"->\"25\" [id = \"31\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"24\"->\"25\" [id = \"32\", color = \"black\", fontcolor = \"black\", label = \"50X16\"] \n\"25\"->\"26\" [id = \"33\", color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"26\"->\"27\" [id = \"34\", color = \"black\", fontcolor = \"black\", label = \"50X16X2\"] \n\"27\"->\"28\" [id = \"35\", color = \"black\", fontcolor = \"black\", label = \"50X16X2\"] \n\"28\"->\"29\" [id = \"36\", color = \"black\", fontcolor = \"black\", label = \"50X2X16\"] \n\"29\"->\"30\" [id = \"37\", color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"30\"->\"32\" [id = \"38\", color = \"black\", fontcolor = \"black\", label = \"1X32\"] \n\"31\"->\"32\" [id = \"39\", color = \"black\", fontcolor = \"black\", label = \"32\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;Perplexity&quot;, function(label, pred) {
  label = mx.nd.reshape(mx.nd.array(label), shape = -1)
  label = as.array(label)
  res &lt;- mean((label-pred)^2)
  return(res)
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.cpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 2.5)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.9, eps = 1e-5, wd = 1e-6,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 250, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
## 592.780 920.760 379.521</code></pre>
<pre class="r"><code>plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
        mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)</code></pre>
<div id="ff2ec3aa68" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="ff2ec3aa68">{"x":{"visdat":{"ff60706d09":["function () ","plotlyVisDat"]},"cur_data":"ff60706d09","attrs":{"ff60706d09":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.265620771119165,0.0906419126393573,0.0504461085157883,0.0356492661800345,0.0312023141357291,0.030595482437756,0.028117526295114,0.0223757881265249,0.0279965360478802,0.0181334273776756,0.0261983135079773,0.0165293517544565,0.0206473698605917,0.0142939855044201,0.0180845958330296,0.0185803423343176,0.012129346605973,0.0155872514197296,0.012008086796199,0.0109725661623304,0.0151150299620919,0.010987608174948,0.0115983738034584,0.0132887466739824,0.0101902664675049,0.00872782012697631,0.00866695572818724,0.0130089845968813,0.0132209049754824,0.00791023150558724,0.00753393676653076,0.00813708487985514,0.00757873531445074,0.00687256213072668,0.0104952710063265,0.0112509757293985,0.00828807674067207,0.00717888491584057,0.00775699324832573,0.00701808206421385,0.00690686666553157,0.0062628034179405,0.0066791607947278,0.00986441923580799,0.00757686566649415,0.00694335237238611,0.00630939693189031,0.00654357442487469,0.00657632998385783,0.00635260745694272,0.00616058105951506,0.00654403780481143,0.0078440025147745,0.00574117322172794,0.0051432301369937,0.00708132592819889,0.00603979192410599,0.00542412912745369,0.00548514919714714,0.00549054195334174,0.00704944242686389,0.00586575685616999,0.00482998700117998,0.00541814106469003,0.00539884894514944,0.00525137787836131,0.00536768213761797,0.00532263036922358,0.00506192878036643,0.00532002166898173,0.00469304766549742,0.00600988495091585,0.00519802123154609,0.00489375924806936,0.00453284067971143,0.00500200565413118,0.00469262412707137,0.00478115452857006,0.00459717747261806,0.00520708767050365,0.00497736036661176,0.00494979179369593,0.00448888657839358,0.00469923388821613,0.00450670380026445,0.00511739072885457,0.00451461146031147,0.0047530034099978,0.00460820324697511,0.00472860593199163,0.00429574734540724,0.00465038693994947,0.00429736672205691,0.00489319126023288,0.0040818366031075,0.00439762438744066,0.00433678431532577,0.00450779372951447,0.00408511883128031,0.00441271299546194,0.00424800078932644,0.00435645324319275,0.00437147486172001,0.00445455490804048,0.00437955382404198,0.00454726468389015,0.00422276612527576,0.00384667038830827,0.00405429118753163,0.00412768212283196,0.00436381495778502,0.00398544334598199,0.00414415961655766,0.00427300168440029,0.00415424242743592,0.00411112729282165,0.00404467728273531,0.00416504188411602,0.00400002717070232,0.00426193772472046,0.00444803583863978,0.00424014857781693,0.00390786649431038,0.00367404947401846,0.00379963313086703,0.00386221418279868,0.00401272328532111,0.00391788265039007,0.00389174014109738,0.00374747142780443,0.00413340603244326,0.00421572247337555,0.00377924329871633,0.00401471060513714,0.00390627749607182,0.00393962759339569,0.00404001661383018,0.00388285896233635,0.00375067324311411,0.00386040353318834,0.00381143858980399,0.00383959507816434,0.00416936224244683,0.00360680593059789,0.0040419762527147,0.00395617990430716,0.00384073252507361,0.00376929906216622,0.00385347758142352,0.0039910292658046,0.00380415122736459,0.00373674291150834,0.00359703498122669,0.00369310083290111,0.0037739533278866,0.00382661737797983,0.00388766589146801,0.00375311378217783,0.00357416586555611,0.00392500579932571,0.00384245226617007,0.00359971600103253,0.0035794897260178,0.00360403830032895,0.0035958809631634,0.00375751438542261,0.00360765476224074,0.00406310625964602,0.00361807238811225,0.00392127634174895,0.00360381033950628,0.00352860708915166,0.00360901443521285,0.00369768873350685,0.00369945243006163,0.00354258528931566,0.00350190057968546,0.00358864683304658,0.00392234481826596,0.00345609650443457,0.00381252442280242,0.00385326562327703,0.0035659422836204,0.00380930586978748,0.0035375303638932,0.00367983459259437,0.00359766198538873,0.00349233295830533,0.00365212927749066,0.00383197961218437,0.00351733189882686,0.0034279736424307,0.00356469085369124,0.00341008797817328,0.00394362931227296,0.00383072780743621,0.00372167985894977,0.00347406055238483,0.00363780080966435,0.00368836920229419,0.00348168921124864,0.00365696559461731,0.00384514614141754,0.00344493192892752,0.00343157534242388,0.00378426157113227,0.00362889861453003,0.00365267588538863,0.00347689915488309,0.00347144898825724,0.00360602573393595,0.00355743334006866,0.00364364709523594,0.00344735589867369,0.00368139673295203,0.00341441376842726,0.00343114520974263,0.00351700772969379,0.0037155909158289,0.00355119024306459,0.00352795778984283,0.00337606954568862,0.00359529877776979,0.00356290553658201,0.00340319684700768,0.00350189529398416,0.00385806765796943,0.00347392779831279,0.00341909068945228,0.00353395936042952,0.00333625305868087,0.00346676656628837,0.00342880186938568,0.00367626960260169,0.00378199123825673,0.00349222766911999,0.00359286742958558,0.00338952635689405,0.00334043389009197,0.00337903425760704,0.00346580319427572,0.00372089406910606,0.00340633588632329,0.00370913193932367,0.00341220575175377,0.0033570266128133,0.00325978382989065,0.00356239226784947,0.00358305791725738,0.00362719679891837],"mode":"markers+lines","name":"train","alpha":1,"sizes":[10,100],"type":"scatter"},"ff60706d09.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.112065216396877,0.0349826781502592,0.0411387657421361,0.038322187557441,0.0480490278822807,0.0156712006774585,0.0257731690801393,0.0373073215009108,0.0207565347783264,0.0365139318360537,0.0150287170997354,0.0185397964012137,0.0182701910575825,0.0133750676237585,0.028183802978399,0.0101780041502338,0.0117110316914994,0.0167325124372692,0.00920282519003299,0.0187179171933806,0.0105860697914431,0.00955541699707298,0.00903919728288282,0.00931730047058346,0.00679016265100194,0.00640101522923268,0.0066067115970023,0.012630518321895,0.00565429152369173,0.00562172058741011,0.00723944850480831,0.00737961931690777,0.00631373974008287,0.00702410552126705,0.0102832551441091,0.00708796266538873,0.00658572133504241,0.00534395098154165,0.00616128496827718,0.00689727364014074,0.00578787899755888,0.00586279152873315,0.0104049463361194,0.00818260812670358,0.00679706716361829,0.00661472088537742,0.00445326289858326,0.00574730331326074,0.0061087178312037,0.00583836195835395,0.00543441353421773,0.00792897894141842,0.00504358278760621,0.00420331461726969,0.00601235864591869,0.00609785068075459,0.00523453810747301,0.00468355885232129,0.00552973641802076,0.00500998411326523,0.00585014267762841,0.00386966858008962,0.00501226474318254,0.0047384226992714,0.00477035260930205,0.00367140124133732,0.00534648833919606,0.00466906425721825,0.00464509191797802,0.0039182879715194,0.00430342738144302,0.00543140988348538,0.00438563729566499,0.00407395544727455,0.00346768960349807,0.00439831244799787,0.00394789664857834,0.00364332688488147,0.00416966667965197,0.00452126152310039,0.00410122744436221,0.00362397502503352,0.00420458238595393,0.00410356807974155,0.00416523291879614,0.00359095856131226,0.00376456128691921,0.00419373964158151,0.00411096178401923,0.00351928797329619,0.00367726802361333,0.00399776386315986,0.00438723383689646,0.00335491173747026,0.00379719412241248,0.00390094906920901,0.00354330362984912,0.00325937870152952,0.00312056540775703,0.00419773194530078,0.00349001266961001,0.0038680257888842,0.00309725759337754,0.00420919139448483,0.0039008681831696,0.00360299539361536,0.00288390158347388,0.00347706267902013,0.00357192239104671,0.00391947783384329,0.00307942311073202,0.00381303939172938,0.00378500704029894,0.00347699743434605,0.00309410861512733,0.00407950947958247,0.00347967007367185,0.0033413421918922,0.00315753629861844,0.00385125889176127,0.00339279185534067,0.00324443239334718,0.0030025275404035,0.00316613811351075,0.00331724654581384,0.00334607652822777,0.00320712113681291,0.00326849873918181,0.0033552932585838,0.00321766983586541,0.00343060457439678,0.00297872383700606,0.00389642818936436,0.00317324706363187,0.003556656935442,0.00306335128115196,0.00354872492999519,0.00298756620711006,0.00343164685345052,0.00304470510315234,0.00313941392909879,0.00354060806377183,0.00331418749814807,0.00326018756998018,0.0032717105936926,0.00338296093095444,0.0034235772760613,0.00333227988372728,0.00397103864673938,0.00303127874329797,0.00328398716126797,0.0033413465878012,0.00301937662519344,0.00337353682942306,0.00290758950312123,0.00331027667394791,0.00352841108172264,0.00324908745336174,0.00321294372997284,0.00296191516856451,0.00338098416390202,0.00305849681410087,0.00310620975592367,0.00285669168593194,0.00315520819456902,0.00293733622810174,0.00376608429426411,0.0038530537548829,0.00329992461102832,0.0028248755963106,0.00301915557389482,0.00341591682091108,0.00314685560673181,0.0033511302703399,0.00323919973187175,0.00319942577246236,0.00334160655655074,0.00319159872507713,0.00292015481788421,0.00298414835427036,0.00354831874641043,0.00343111673312382,0.00315425852896125,0.00304128152517865,0.00286169484244695,0.00353034276167711,0.00315674935682435,0.00297045915791216,0.00309314655872979,0.00323461217466477,0.00313612592094499,0.00330505889538761,0.00321382740870104,0.00321789028080913,0.00343914851491964,0.00295715064302764,0.00316428459699278,0.00316356518622645,0.00305466828895809,0.00338702584393953,0.00302451497787909,0.00326410812033951,0.00285685265457056,0.00314538540944552,0.00339680959356226,0.00353146657227087,0.00303564174736601,0.0028351566544161,0.00323883912203776,0.00328238185690422,0.00358530718161277,0.00300971880910404,0.00305302992653531,0.00343982962883678,0.00320298800169094,0.00308498468996456,0.00276514517517987,0.00314308518814825,0.00335580631773377,0.00333243948491696,0.00308016029834416,0.00295570500432044,0.0032132527276773,0.00328177343102734,0.00292733376883997,0.00320213449531164,0.00301284506173144,0.00304965683335619,0.00353569462521819,0.00312466549441928,0.00321853199780228,0.00309989903478284,0.00301784262124581,0.00323032561671998,0.00285812943963964,0.00306293068135631,0.00307410481297977,0.00337606131964398,0.00304887569268515,0.00286338426364548,0.00308381773111578,0.00292454401471847,0.00333696229116555,0.0035047402205491,0.00302887192594561,0.0030057576472956,0.00311822599232724,0.0032945328155348,0.00314127093633065,0.00310335272501877],"mode":"markers+lines","name":"eval","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.265620771119165,0.0906419126393573,0.0504461085157883,0.0356492661800345,0.0312023141357291,0.030595482437756,0.028117526295114,0.0223757881265249,0.0279965360478802,0.0181334273776756,0.0261983135079773,0.0165293517544565,0.0206473698605917,0.0142939855044201,0.0180845958330296,0.0185803423343176,0.012129346605973,0.0155872514197296,0.012008086796199,0.0109725661623304,0.0151150299620919,0.010987608174948,0.0115983738034584,0.0132887466739824,0.0101902664675049,0.00872782012697631,0.00866695572818724,0.0130089845968813,0.0132209049754824,0.00791023150558724,0.00753393676653076,0.00813708487985514,0.00757873531445074,0.00687256213072668,0.0104952710063265,0.0112509757293985,0.00828807674067207,0.00717888491584057,0.00775699324832573,0.00701808206421385,0.00690686666553157,0.0062628034179405,0.0066791607947278,0.00986441923580799,0.00757686566649415,0.00694335237238611,0.00630939693189031,0.00654357442487469,0.00657632998385783,0.00635260745694272,0.00616058105951506,0.00654403780481143,0.0078440025147745,0.00574117322172794,0.0051432301369937,0.00708132592819889,0.00603979192410599,0.00542412912745369,0.00548514919714714,0.00549054195334174,0.00704944242686389,0.00586575685616999,0.00482998700117998,0.00541814106469003,0.00539884894514944,0.00525137787836131,0.00536768213761797,0.00532263036922358,0.00506192878036643,0.00532002166898173,0.00469304766549742,0.00600988495091585,0.00519802123154609,0.00489375924806936,0.00453284067971143,0.00500200565413118,0.00469262412707137,0.00478115452857006,0.00459717747261806,0.00520708767050365,0.00497736036661176,0.00494979179369593,0.00448888657839358,0.00469923388821613,0.00450670380026445,0.00511739072885457,0.00451461146031147,0.0047530034099978,0.00460820324697511,0.00472860593199163,0.00429574734540724,0.00465038693994947,0.00429736672205691,0.00489319126023288,0.0040818366031075,0.00439762438744066,0.00433678431532577,0.00450779372951447,0.00408511883128031,0.00441271299546194,0.00424800078932644,0.00435645324319275,0.00437147486172001,0.00445455490804048,0.00437955382404198,0.00454726468389015,0.00422276612527576,0.00384667038830827,0.00405429118753163,0.00412768212283196,0.00436381495778502,0.00398544334598199,0.00414415961655766,0.00427300168440029,0.00415424242743592,0.00411112729282165,0.00404467728273531,0.00416504188411602,0.00400002717070232,0.00426193772472046,0.00444803583863978,0.00424014857781693,0.00390786649431038,0.00367404947401846,0.00379963313086703,0.00386221418279868,0.00401272328532111,0.00391788265039007,0.00389174014109738,0.00374747142780443,0.00413340603244326,0.00421572247337555,0.00377924329871633,0.00401471060513714,0.00390627749607182,0.00393962759339569,0.00404001661383018,0.00388285896233635,0.00375067324311411,0.00386040353318834,0.00381143858980399,0.00383959507816434,0.00416936224244683,0.00360680593059789,0.0040419762527147,0.00395617990430716,0.00384073252507361,0.00376929906216622,0.00385347758142352,0.0039910292658046,0.00380415122736459,0.00373674291150834,0.00359703498122669,0.00369310083290111,0.0037739533278866,0.00382661737797983,0.00388766589146801,0.00375311378217783,0.00357416586555611,0.00392500579932571,0.00384245226617007,0.00359971600103253,0.0035794897260178,0.00360403830032895,0.0035958809631634,0.00375751438542261,0.00360765476224074,0.00406310625964602,0.00361807238811225,0.00392127634174895,0.00360381033950628,0.00352860708915166,0.00360901443521285,0.00369768873350685,0.00369945243006163,0.00354258528931566,0.00350190057968546,0.00358864683304658,0.00392234481826596,0.00345609650443457,0.00381252442280242,0.00385326562327703,0.0035659422836204,0.00380930586978748,0.0035375303638932,0.00367983459259437,0.00359766198538873,0.00349233295830533,0.00365212927749066,0.00383197961218437,0.00351733189882686,0.0034279736424307,0.00356469085369124,0.00341008797817328,0.00394362931227296,0.00383072780743621,0.00372167985894977,0.00347406055238483,0.00363780080966435,0.00368836920229419,0.00348168921124864,0.00365696559461731,0.00384514614141754,0.00344493192892752,0.00343157534242388,0.00378426157113227,0.00362889861453003,0.00365267588538863,0.00347689915488309,0.00347144898825724,0.00360602573393595,0.00355743334006866,0.00364364709523594,0.00344735589867369,0.00368139673295203,0.00341441376842726,0.00343114520974263,0.00351700772969379,0.0037155909158289,0.00355119024306459,0.00352795778984283,0.00337606954568862,0.00359529877776979,0.00356290553658201,0.00340319684700768,0.00350189529398416,0.00385806765796943,0.00347392779831279,0.00341909068945228,0.00353395936042952,0.00333625305868087,0.00346676656628837,0.00342880186938568,0.00367626960260169,0.00378199123825673,0.00349222766911999,0.00359286742958558,0.00338952635689405,0.00334043389009197,0.00337903425760704,0.00346580319427572,0.00372089406910606,0.00340633588632329,0.00370913193932367,0.00341220575175377,0.0033570266128133,0.00325978382989065,0.00356239226784947,0.00358305791725738,0.00362719679891837],"mode":"markers+lines","name":"train","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.112065216396877,0.0349826781502592,0.0411387657421361,0.038322187557441,0.0480490278822807,0.0156712006774585,0.0257731690801393,0.0373073215009108,0.0207565347783264,0.0365139318360537,0.0150287170997354,0.0185397964012137,0.0182701910575825,0.0133750676237585,0.028183802978399,0.0101780041502338,0.0117110316914994,0.0167325124372692,0.00920282519003299,0.0187179171933806,0.0105860697914431,0.00955541699707298,0.00903919728288282,0.00931730047058346,0.00679016265100194,0.00640101522923268,0.0066067115970023,0.012630518321895,0.00565429152369173,0.00562172058741011,0.00723944850480831,0.00737961931690777,0.00631373974008287,0.00702410552126705,0.0102832551441091,0.00708796266538873,0.00658572133504241,0.00534395098154165,0.00616128496827718,0.00689727364014074,0.00578787899755888,0.00586279152873315,0.0104049463361194,0.00818260812670358,0.00679706716361829,0.00661472088537742,0.00445326289858326,0.00574730331326074,0.0061087178312037,0.00583836195835395,0.00543441353421773,0.00792897894141842,0.00504358278760621,0.00420331461726969,0.00601235864591869,0.00609785068075459,0.00523453810747301,0.00468355885232129,0.00552973641802076,0.00500998411326523,0.00585014267762841,0.00386966858008962,0.00501226474318254,0.0047384226992714,0.00477035260930205,0.00367140124133732,0.00534648833919606,0.00466906425721825,0.00464509191797802,0.0039182879715194,0.00430342738144302,0.00543140988348538,0.00438563729566499,0.00407395544727455,0.00346768960349807,0.00439831244799787,0.00394789664857834,0.00364332688488147,0.00416966667965197,0.00452126152310039,0.00410122744436221,0.00362397502503352,0.00420458238595393,0.00410356807974155,0.00416523291879614,0.00359095856131226,0.00376456128691921,0.00419373964158151,0.00411096178401923,0.00351928797329619,0.00367726802361333,0.00399776386315986,0.00438723383689646,0.00335491173747026,0.00379719412241248,0.00390094906920901,0.00354330362984912,0.00325937870152952,0.00312056540775703,0.00419773194530078,0.00349001266961001,0.0038680257888842,0.00309725759337754,0.00420919139448483,0.0039008681831696,0.00360299539361536,0.00288390158347388,0.00347706267902013,0.00357192239104671,0.00391947783384329,0.00307942311073202,0.00381303939172938,0.00378500704029894,0.00347699743434605,0.00309410861512733,0.00407950947958247,0.00347967007367185,0.0033413421918922,0.00315753629861844,0.00385125889176127,0.00339279185534067,0.00324443239334718,0.0030025275404035,0.00316613811351075,0.00331724654581384,0.00334607652822777,0.00320712113681291,0.00326849873918181,0.0033552932585838,0.00321766983586541,0.00343060457439678,0.00297872383700606,0.00389642818936436,0.00317324706363187,0.003556656935442,0.00306335128115196,0.00354872492999519,0.00298756620711006,0.00343164685345052,0.00304470510315234,0.00313941392909879,0.00354060806377183,0.00331418749814807,0.00326018756998018,0.0032717105936926,0.00338296093095444,0.0034235772760613,0.00333227988372728,0.00397103864673938,0.00303127874329797,0.00328398716126797,0.0033413465878012,0.00301937662519344,0.00337353682942306,0.00290758950312123,0.00331027667394791,0.00352841108172264,0.00324908745336174,0.00321294372997284,0.00296191516856451,0.00338098416390202,0.00305849681410087,0.00310620975592367,0.00285669168593194,0.00315520819456902,0.00293733622810174,0.00376608429426411,0.0038530537548829,0.00329992461102832,0.0028248755963106,0.00301915557389482,0.00341591682091108,0.00314685560673181,0.0033511302703399,0.00323919973187175,0.00319942577246236,0.00334160655655074,0.00319159872507713,0.00292015481788421,0.00298414835427036,0.00354831874641043,0.00343111673312382,0.00315425852896125,0.00304128152517865,0.00286169484244695,0.00353034276167711,0.00315674935682435,0.00297045915791216,0.00309314655872979,0.00323461217466477,0.00313612592094499,0.00330505889538761,0.00321382740870104,0.00321789028080913,0.00343914851491964,0.00295715064302764,0.00316428459699278,0.00316356518622645,0.00305466828895809,0.00338702584393953,0.00302451497787909,0.00326410812033951,0.00285685265457056,0.00314538540944552,0.00339680959356226,0.00353146657227087,0.00303564174736601,0.0028351566544161,0.00323883912203776,0.00328238185690422,0.00358530718161277,0.00300971880910404,0.00305302992653531,0.00343982962883678,0.00320298800169094,0.00308498468996456,0.00276514517517987,0.00314308518814825,0.00335580631773377,0.00333243948491696,0.00308016029834416,0.00295570500432044,0.0032132527276773,0.00328177343102734,0.00292733376883997,0.00320213449531164,0.00301284506173144,0.00304965683335619,0.00353569462521819,0.00312466549441928,0.00321853199780228,0.00309989903478284,0.00301784262124581,0.00323032561671998,0.00285812943963964,0.00306293068135631,0.00307410481297977,0.00337606131964398,0.00304887569268515,0.00286338426364548,0.00308381773111578,0.00292454401471847,0.00333696229116555,0.0035047402205491,0.00302887192594561,0.0030057576472956,0.00311822599232724,0.0032945328155348,0.00314127093633065,0.00310335272501877],"mode":"markers+lines","name":"eval","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="build-the-inference-symbols" class="section level3">
<h3>Build the inference symbols</h3>
<p>Two symbols:</p>
<ul>
<li>first unrolled to the length of the inference sequence.</li>
<li>second of length one on which to iterate up to the number of the desired inference steps.</li>
</ul>
<pre class="r"><code>ctx &lt;- mx.cpu()

pred_length = 80
data = mx.nd.array(x[, , 1, drop = F])
infer_length_ini &lt;- dim(data)[2]

symbol.infer.ini &lt;- rnn.graph.unroll(seq_len = infer_length_ini,
                                     num_rnn_layer = 2, 
                                     num_hidden = 50,
                                     input_size = NULL,
                                     num_embed = NULL, 
                                     num_decode = 1,
                                     masking = F, 
                                     loss_output = &quot;linear&quot;,
                                     dropout = 0, 
                                     ignore_label = -1,
                                     cell_type = &quot;lstm&quot;,
                                     output_last_state = T,
                                     config = &quot;one-to-one&quot;)

symbol.infer &lt;- rnn.graph.unroll(seq_len = 1,
                                 num_rnn_layer = 2, 
                                 num_hidden = 50,
                                 input_size = NULL,
                                 num_embed = NULL, 
                                 num_decode = 1,
                                 masking = F, 
                                 loss_output = &quot;linear&quot;,
                                 dropout = 0, 
                                 ignore_label = -1,
                                 cell_type = &quot;lstm&quot;,
                                 output_last_state = T,
                                 config = &quot;one-to-one&quot;)</code></pre>
</div>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>predict &lt;- numeric()

infer &lt;- mxnet:::mx.rnn.infer.unroll(data = data, 
                             symbol = symbol.infer.ini,
                             num_hidden = 50,
                             arg.params = model$arg.params,
                             aux.params = model$aux.params,
                             init_states = NULL,
                             ctx = ctx)

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  
  infer &lt;- mxnet:::mx.rnn.infer.unroll(data = data, 
                               symbol = symbol.infer,
                               num_hidden = 50,
                               arg.params = model$arg.params,
                               aux.params = model$aux.params,
                               init_states = infer[-1],
                               ctx = ctx)
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)</code></pre>
<div id="ff3ce21b17" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="ff3ce21b17">{"x":{"visdat":{"ff462b8b44":["function () ","plotlyVisDat"]},"cur_data":"ff462b8b44","attrs":{"ff462b8b44":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.776793480655267,0.587332188330282,0.357845177982921,0.103971610123142,-0.156987451145319,-0.407248077052257,-0.629755419517351,-0.809345970862376,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655267,-0.587332188330282,-0.357845177982921,-0.103971610123143,0.156987451145319,0.407248077052257,0.629755419517351,0.809345970862376,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145319,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.156987451145317,0.407248077052256,0.629755419517352,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145317,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.91331758098552,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.15698745114532,0.407248077052256,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924,0.103971610123143,-0.15698745114532,-0.407248077052256,-0.629755419517351,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982924,-0.103971610123143,0.156987451145316,0.407248077052255,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924,0.103971610123143],"mode":"lines","name":"hist","alpha":1,"sizes":[10,100],"type":"scatter"},"ff462b8b44.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.156987451145316,-0.407248077052255,-0.629755419517351,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.91331758098552,-0.776793480655268,-0.587332188330282,-0.357845177982924,-0.103971610123144,0.156987451145316,0.407248077052255,0.629755419517348,0.809345970862375,0.933780931800586,0.994580265382538,0.987600597500274,0.91331758098552,0.776793480655268,0.587332188330283,0.357845177982927,0.103971610123147,-0.156987451145316,-0.407248077052249,-0.629755419517345,-0.809345970862373,-0.933780931800585,-0.994580265382539,-0.987600597500274,-0.913317580985521,-0.776793480655271,-0.587332188330285,-0.357845177982924,-0.103971610123151,0.156987451145312,0.407248077052252,0.629755419517348,0.80934597086237,0.933780931800583,0.994580265382538,0.987600597500274,0.91331758098552,0.776793480655273,0.587332188330288,0.357845177982928,0.103971610123147,-0.156987451145316,-0.407248077052248,-0.629755419517345,-0.809345970862372,-0.933780931800585,-0.994580265382538,-0.987600597500274,-0.913317580985522,-0.776793480655271,-0.587332188330286,-0.357845177982931,-0.103971610123151,0.156987451145312,0.407248077052252,0.629755419517348,0.80934597086237,0.933780931800583,0.994580265382538,0.987600597500274,0.91331758098552,0.776793480655273,0.587332188330289,0.357845177982928,0.103971610123148,-0.156987451145315,-0.407248077052248,-0.629755419517345,-0.809345970862372,-0.933780931800585,-0.994580265382538,-0.987600597500274,-0.913317580985522],"mode":"lines","name":"real","alpha":1,"sizes":[10,100],"type":"scatter"},"ff462b8b44.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.110984444618225,-0.320045471191406,-0.538717150688171,-0.725671052932739,-0.866172730922699,-0.955721139907837,-0.985008478164673,-0.94641101360321,-0.831304371356964,-0.650509715080261,-0.417436987161636,-0.13897992670536,0.148755207657814,0.423087060451508,0.667070627212524,0.863918840885162,1.00855588912964,1.08198833465576,1.08209586143494,1.01192116737366,0.880037248134613,0.707574188709259,0.506588459014893,0.294093906879425,0.0540787875652313,-0.192766785621643,-0.399067252874374,-0.61678946018219,-0.782661199569702,-0.910318195819855,-0.971683263778687,-0.982444524765015,-0.908789753913879,-0.769935429096222,-0.573059439659119,-0.322841912508011,-0.0383421368896961,0.251699239015579,0.512245774269104,0.747380793094635,0.921954810619354,1.04510796070099,1.08913898468018,1.0643914937973,0.967314660549164,0.820205926895142,0.635410010814667,0.429355919361115,0.210514470934868,-0.0432085730135441,-0.268043667078018,-0.481165736913681,-0.68379008769989,-0.834229707717896,-0.941675543785095,-0.981078147888184,-0.965510725975037,-0.866538166999817,-0.702717840671539,-0.485781759023666,-0.21799898147583,0.0680352076888084,0.353416264057159,0.602858245372772,0.817923605442047,0.974844872951508,1.07029557228088,1.08805775642395,1.03739356994629,0.918068051338196,0.755814015865326,0.560530960559845,0.35085391998291,0.121069364249706,-0.135004565119743,-0.34379255771637,-0.563945770263672,-0.744135975837708,-0.881933689117432,-0.962321043014526],"mode":"lines","name":"pred","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.776793480655267,0.587332188330282,0.357845177982921,0.103971610123142,-0.156987451145319,-0.407248077052257,-0.629755419517351,-0.809345970862376,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655267,-0.587332188330282,-0.357845177982921,-0.103971610123143,0.156987451145319,0.407248077052257,0.629755419517351,0.809345970862376,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145319,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.156987451145317,0.407248077052256,0.629755419517352,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982923,0.103971610123143,-0.156987451145317,-0.407248077052256,-0.629755419517352,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.91331758098552,-0.776793480655268,-0.587332188330282,-0.357845177982923,-0.103971610123143,0.15698745114532,0.407248077052256,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924,0.103971610123143,-0.15698745114532,-0.407248077052256,-0.629755419517351,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.913317580985518,-0.776793480655268,-0.587332188330282,-0.357845177982924,-0.103971610123143,0.156987451145316,0.407248077052255,0.629755419517351,0.809345970862375,0.933780931800586,0.994580265382539,0.987600597500273,0.913317580985518,0.776793480655268,0.587332188330282,0.357845177982924,0.103971610123143],"mode":"lines","name":"hist","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.156987451145316,-0.407248077052255,-0.629755419517351,-0.809345970862375,-0.933780931800586,-0.994580265382539,-0.987600597500273,-0.91331758098552,-0.776793480655268,-0.587332188330282,-0.357845177982924,-0.103971610123144,0.156987451145316,0.407248077052255,0.629755419517348,0.809345970862375,0.933780931800586,0.994580265382538,0.987600597500274,0.91331758098552,0.776793480655268,0.587332188330283,0.357845177982927,0.103971610123147,-0.156987451145316,-0.407248077052249,-0.629755419517345,-0.809345970862373,-0.933780931800585,-0.994580265382539,-0.987600597500274,-0.913317580985521,-0.776793480655271,-0.587332188330285,-0.357845177982924,-0.103971610123151,0.156987451145312,0.407248077052252,0.629755419517348,0.80934597086237,0.933780931800583,0.994580265382538,0.987600597500274,0.91331758098552,0.776793480655273,0.587332188330288,0.357845177982928,0.103971610123147,-0.156987451145316,-0.407248077052248,-0.629755419517345,-0.809345970862372,-0.933780931800585,-0.994580265382538,-0.987600597500274,-0.913317580985522,-0.776793480655271,-0.587332188330286,-0.357845177982931,-0.103971610123151,0.156987451145312,0.407248077052252,0.629755419517348,0.80934597086237,0.933780931800583,0.994580265382538,0.987600597500274,0.91331758098552,0.776793480655273,0.587332188330289,0.357845177982928,0.103971610123148,-0.156987451145315,-0.407248077052248,-0.629755419517345,-0.809345970862372,-0.933780931800585,-0.994580265382538,-0.987600597500274,-0.913317580985522],"mode":"lines","name":"real","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[-0.110984444618225,-0.320045471191406,-0.538717150688171,-0.725671052932739,-0.866172730922699,-0.955721139907837,-0.985008478164673,-0.94641101360321,-0.831304371356964,-0.650509715080261,-0.417436987161636,-0.13897992670536,0.148755207657814,0.423087060451508,0.667070627212524,0.863918840885162,1.00855588912964,1.08198833465576,1.08209586143494,1.01192116737366,0.880037248134613,0.707574188709259,0.506588459014893,0.294093906879425,0.0540787875652313,-0.192766785621643,-0.399067252874374,-0.61678946018219,-0.782661199569702,-0.910318195819855,-0.971683263778687,-0.982444524765015,-0.908789753913879,-0.769935429096222,-0.573059439659119,-0.322841912508011,-0.0383421368896961,0.251699239015579,0.512245774269104,0.747380793094635,0.921954810619354,1.04510796070099,1.08913898468018,1.0643914937973,0.967314660549164,0.820205926895142,0.635410010814667,0.429355919361115,0.210514470934868,-0.0432085730135441,-0.268043667078018,-0.481165736913681,-0.68379008769989,-0.834229707717896,-0.941675543785095,-0.981078147888184,-0.965510725975037,-0.866538166999817,-0.702717840671539,-0.485781759023666,-0.21799898147583,0.0680352076888084,0.353416264057159,0.602858245372772,0.817923605442047,0.974844872951508,1.07029557228088,1.08805775642395,1.03739356994629,0.918068051338196,0.755814015865326,0.560530960559845,0.35085391998291,0.121069364249706,-0.135004565119743,-0.34379255771637,-0.563945770263672,-0.744135975837708,-0.881933689117432,-0.962321043014526],"mode":"lines","name":"pred","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
