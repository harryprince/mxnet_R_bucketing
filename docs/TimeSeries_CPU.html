<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series on CPU</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-1.0.0/grViz.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET R</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU.html">GPU</a></li>
        <li><a href="TimeSeries_CPU.html">CPU</a></li>
        </ul>
  </li>
  
    <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Vision<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="ClassActivationMap.html">Activation Map</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="CNN_NLP_Classification.html">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series on CPU</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<p>It relies on an explicit symbolic construction of the RNN cells (LSTM or GRU), thus supporting training on CPU unlike the FusedRNN operator that is CUDA dependent.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<p>In this step a collection of univariate time-series is built. 192 independent times series (<em>samples</em>) with each 100 observations (<em>seq_len</em>) are created. The modeling task will is predict the next value given the previous ones.</p>
<p>The target variable is therefore obtained by shifting the features by one timestep in the future.</p>
<pre class="r"><code># number of timestamps
seq_len = 100

# nunmber of samples
n = 500

# return a random starting point of the time series
set.seed(12)
seeds &lt;- runif(n, min = 0, max = 24)

# generate the time series of seq_length for each starting point
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

# build the features matrix
x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, n))

# build the target array - same as feature but one timestep forward
y &lt;- pts[-1, ]

# plot time series from 5 first samples
plot_ly(x = 1:dim(x)[2], y = x[,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  layout(title = &quot;Sample of 5 time series&quot;)</code></pre>
<div id="2db8524a5d6a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2db8524a5d6a">{"x":{"visdat":{"2db84c8733e4":["function () ","plotlyVisDat"]},"cur_data":"2db84c8733e4","attrs":{"2db84c8733e4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2db84c8733e4.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.70117834568943,0.861820608905392,0.963731221850346,0.999965144667347,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700609,0.266874749706372,0.00834921855102572,-0.250745298050841,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456416,-0.712985923799507,-0.507213207700609,-0.266874749706372,-0.00834921855102584,0.25074529805084,0.492751936966736,0.701178345689429,0.861820608905392,0.963731221850346,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799507,0.50721320770061,0.266874749706376,0.00834921855102596,-0.25074529805084,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456418,-0.712985923799507,-0.50721320770061,-0.266874749706373,-0.00834921855102609,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850347,0.999965144667346,0.968053095395803,0.870169827456416,0.71298592379951,0.507213207700607,0.266874749706376,0.00834921855102621,-0.25074529805084,-0.492751936966733,-0.701178345689427,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395804,-0.870169827456414,-0.712985923799508,-0.50721320770061,-0.266874749706373,-0.00834921855102988,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850345,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700613,0.266874749706376,0.00834921855102645,-0.250745298050833,-0.492751936966739,-0.701178345689426,-0.861820608905389,-0.963731221850346,-0.999965144667346,-0.968053095395803,-0.870169827456418,-0.712985923799508,-0.50721320770061,-0.26687474970638,-0.00834921855102302,0.250745298050836,0.492751936966735,0.701178345689429,0.861820608905388,0.963731221850346,0.999965144667346],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2db84c8733e4.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345788,-0.403578406307372,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254405,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.932336886940122,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823962,-0.107963379671007,-0.361590831259314,-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233053,-0.626632013345788,-0.403578406307375,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254402,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823959,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904059,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233055,-0.626632013345785,-0.403578406307375,-0.153021597823963,0.107963379671006,0.36159083125931,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.93233688694012,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823966,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904056,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345791,-0.403578406307376,-0.153021597823963,0.107963379670999,0.361590831259317,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605102,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307379,0.153021597823959,-0.107963379671003,-0.361590831259313,-0.590576465254404,-0.779315289116156,-0.914945063904059,-0.988222844605103],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2db84c8733e4.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.180976961168064,0.429355573857644,0.648474313732461,0.823400600780882,0.942213497619918,0.996816101677582,0.983487335722414,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989953,0.0797349323465505,-0.180976961168064,-0.429355573857644,-0.64847431373246,-0.823400600780882,-0.942213497619917,-0.996816101677582,-0.983487335722414,-0.903135533127433,-0.761236536451854,-0.567460527819938,-0.335013021989954,-0.0797349323465524,0.180976961168064,0.429355573857644,0.64847431373246,0.823400600780882,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989955,0.0797349323465525,-0.180976961168064,-0.429355573857642,-0.64847431373246,-0.823400600780883,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127433,-0.761236536451853,-0.567460527819938,-0.335013021989957,-0.0797349323465527,0.180976961168064,0.429355573857645,0.64847431373246,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451856,0.567460527819938,0.335013021989954,0.0797349323465528,-0.18097696116806,-0.429355573857642,-0.64847431373246,-0.823400600780881,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989957,-0.0797349323465529,0.180976961168063,0.429355573857642,0.648474313732459,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127434,0.761236536451856,0.567460527819939,0.335013021989957,0.079734932346553,-0.180976961168063,-0.429355573857642,-0.648474313732459,-0.82340060078088,-0.942213497619917,-0.996816101677581,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989958,-0.0797349323465531,0.180976961168063,0.429355573857642,0.648474313732462,0.82340060078088],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2db84c8733e4.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871935,-0.921386408957596,-0.78940148493583,-0.603620154263324,-0.376703107607241,-0.124114366699045,0.136932563191003,0.388647765191344,0.613877264264695,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263324,0.376703107607241,0.124114366699045,-0.136932563191002,-0.388647765191345,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607241,-0.124114366699045,0.136932563191002,0.388647765191343,0.613877264264693,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935832,0.603620154263324,0.376703107607242,0.124114366699045,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191344,0.613877264264693,0.797272042258549,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263325,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263326,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191341,0.613877264264693,0.797272042258551,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935833,0.603620154263326,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Sample of 5 time series","xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.70117834568943,0.861820608905392,0.963731221850346,0.999965144667347,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700609,0.266874749706372,0.00834921855102572,-0.250745298050841,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456416,-0.712985923799507,-0.507213207700609,-0.266874749706372,-0.00834921855102584,0.25074529805084,0.492751936966736,0.701178345689429,0.861820608905392,0.963731221850346,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799507,0.50721320770061,0.266874749706376,0.00834921855102596,-0.25074529805084,-0.492751936966736,-0.701178345689429,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395803,-0.870169827456418,-0.712985923799507,-0.50721320770061,-0.266874749706373,-0.00834921855102609,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850347,0.999965144667346,0.968053095395803,0.870169827456416,0.71298592379951,0.507213207700607,0.266874749706376,0.00834921855102621,-0.25074529805084,-0.492751936966733,-0.701178345689427,-0.86182060890539,-0.963731221850346,-0.999965144667347,-0.968053095395804,-0.870169827456414,-0.712985923799508,-0.50721320770061,-0.266874749706373,-0.00834921855102988,0.250745298050837,0.492751936966736,0.701178345689429,0.861820608905391,0.963731221850345,0.999965144667346,0.968053095395803,0.870169827456416,0.712985923799505,0.507213207700613,0.266874749706376,0.00834921855102645,-0.250745298050833,-0.492751936966739,-0.701178345689426,-0.861820608905389,-0.963731221850346,-0.999965144667346,-0.968053095395803,-0.870169827456418,-0.712985923799508,-0.50721320770061,-0.26687474970638,-0.00834921855102302,0.250745298050836,0.492751936966735,0.701178345689429,0.861820608905388,0.963731221850346,0.999965144667346],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345788,-0.403578406307372,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254405,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.932336886940122,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823962,-0.107963379671007,-0.361590831259314,-0.590576465254405,-0.779315289116161,-0.914945063904058,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233053,-0.626632013345788,-0.403578406307375,-0.153021597823962,0.107963379671007,0.361590831259314,0.590576465254402,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823959,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904059,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233055,-0.626632013345785,-0.403578406307375,-0.153021597823963,0.107963379671006,0.36159083125931,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605103,0.994154871561778,0.93233688694012,0.806981684233053,0.626632013345788,0.403578406307372,0.153021597823966,-0.107963379671003,-0.361590831259314,-0.590576465254404,-0.779315289116161,-0.914945063904056,-0.988222844605103,-0.994154871561778,-0.932336886940122,-0.806981684233051,-0.626632013345791,-0.403578406307376,-0.153021597823963,0.107963379670999,0.361590831259317,0.590576465254401,0.779315289116159,0.914945063904058,0.988222844605102,0.994154871561777,0.932336886940123,0.806981684233053,0.626632013345788,0.403578406307379,0.153021597823959,-0.107963379671003,-0.361590831259313,-0.590576465254404,-0.779315289116156,-0.914945063904059,-0.988222844605103],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.180976961168064,0.429355573857644,0.648474313732461,0.823400600780882,0.942213497619918,0.996816101677582,0.983487335722414,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989953,0.0797349323465505,-0.180976961168064,-0.429355573857644,-0.64847431373246,-0.823400600780882,-0.942213497619917,-0.996816101677582,-0.983487335722414,-0.903135533127433,-0.761236536451854,-0.567460527819938,-0.335013021989954,-0.0797349323465524,0.180976961168064,0.429355573857644,0.64847431373246,0.823400600780882,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451854,0.567460527819938,0.335013021989955,0.0797349323465525,-0.180976961168064,-0.429355573857642,-0.64847431373246,-0.823400600780883,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127433,-0.761236536451853,-0.567460527819938,-0.335013021989957,-0.0797349323465527,0.180976961168064,0.429355573857645,0.64847431373246,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127433,0.761236536451856,0.567460527819938,0.335013021989954,0.0797349323465528,-0.18097696116806,-0.429355573857642,-0.64847431373246,-0.823400600780881,-0.942213497619917,-0.996816101677582,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989957,-0.0797349323465529,0.180976961168063,0.429355573857642,0.648474313732459,0.823400600780881,0.942213497619917,0.996816101677582,0.983487335722415,0.903135533127434,0.761236536451856,0.567460527819939,0.335013021989957,0.079734932346553,-0.180976961168063,-0.429355573857642,-0.648474313732459,-0.82340060078088,-0.942213497619917,-0.996816101677581,-0.983487335722415,-0.903135533127434,-0.761236536451856,-0.567460527819939,-0.335013021989958,-0.0797349323465531,0.180976961168063,0.429355573857642,0.648474313732462,0.82340060078088],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871935,-0.921386408957596,-0.78940148493583,-0.603620154263324,-0.376703107607241,-0.124114366699045,0.136932563191003,0.388647765191344,0.613877264264695,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263324,0.376703107607241,0.124114366699045,-0.136932563191002,-0.388647765191345,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607241,-0.124114366699045,0.136932563191002,0.388647765191343,0.613877264264693,0.797272042258551,0.926334048126834,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935832,0.603620154263324,0.376703107607242,0.124114366699045,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126834,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263325,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191344,0.613877264264693,0.797272042258549,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935831,0.603620154263325,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936,-0.921386408957596,-0.789401484935831,-0.603620154263326,-0.376703107607242,-0.124114366699047,0.136932563191002,0.388647765191341,0.613877264264693,0.797272042258551,0.926334048126833,0.992267919454668,0.990580371871936,0.921386408957596,0.789401484935833,0.603620154263326,0.376703107607242,0.124114366699047,-0.136932563191002,-0.388647765191341,-0.613877264264693,-0.797272042258551,-0.926334048126833,-0.992267919454668,-0.990580371871936],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code># plot first time series and its associated target
plot_ly(x = 1:dim(x)[2], y = x[,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;, name = &quot;feature&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;, name = &quot;target&quot;) %&gt;% 
  layout(title = &quot;Sample of one time series&quot;)</code></pre>
<div id="2db82b04758b" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2db82b04758b">{"x":{"visdat":{"2db840d24bf9":["function () ","plotlyVisDat"]},"cur_data":"2db840d24bf9","attrs":{"2db840d24bf9":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","name":"feature","alpha":1,"sizes":[10,100],"type":"scatter"},"2db840d24bf9.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"target","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Sample of one time series","xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.995597853252507,0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685],"mode":"lines","name":"feature","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"target","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<p>The training and evaluation data are made by splitting</p>
<pre class="r"><code>batch.size = 32

# take first 400 samples for train - remaining 100 for evaluation
train_ids &lt;- 1:400

train.data &lt;- mx.io.arrayiter(data = x[,,train_ids, drop = F], label = y[, train_ids], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-train_ids, drop = F], label = y[, -train_ids], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph.unroll(seq_len = 2, 
                           num_rnn_layer =  1, 
                           num_hidden = 50,
                           input_size = NULL,
                           num_embed = NULL, 
                           num_decode = 1,
                           masking = F, 
                           loss_output = &quot;linear&quot;,
                           dropout = 0.2, 
                           ignore_label = -1,
                           cell_type = &quot;lstm&quot;,
                           output_last_state = F,
                           config = &quot;one-to-one&quot;)

graph = graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;TD&quot;, 
                  shape=list(data = c(1, 2, batch.size), 
                             label = c(2, batch.size)))</code></pre>
<div id="htmlwidget-6980a74b8cf5905f19d8" style="width:672px;height:1152px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-6980a74b8cf5905f19d8">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"TD\"]\n\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"SliceChannel\nsplit0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"FullyConnected\nt1.l1.i2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"5\" [label = \"SliceChannel\nt1.l1.slice\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Activation\nactivation3\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"7\" [label = \"Activation\nactivation0\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"8\" [label = \"Activation\nactivation1\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"9\" [label = \"elemwise_mul\n_mul0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"10\" [label = \"Activation\nactivation4\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"11\" [label = \"elemwise_mul\n_mul1\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"12\" [label = \"FullyConnected\nt2.l1.i2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"13\" [label = \"FullyConnected\nt2.l1.h2h\n200\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"14\" [label = \"elemwise_add\n_plus0\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"15\" [label = \"SliceChannel\nt2.l1.slice\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"16\" [label = \"Activation\nactivation8\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"17\" [label = \"Activation\nactivation7\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"18\" [label = \"elemwise_mul\n_mul2\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"19\" [label = \"Activation\nactivation5\nsigmoid\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"20\" [label = \"Activation\nactivation6\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"21\" [label = \"elemwise_mul\n_mul3\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"22\" [label = \"elemwise_add\n_plus1\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"23\" [label = \"Activation\nactivation9\ntanh\", shape = \"box\", penwidth = \"2\", color = \"#ffffb3\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FFFFB3FF\"] \n  \"24\" [label = \"elemwise_mul\n_mul4\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"25\" [label = \"Concat\nconcat\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"26\" [label = \"Reshape\nrnn_reshape\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"27\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"28\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"29\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"30\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"31\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"32\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [color = \"black\", fontcolor = \"black\", label = \"1X2X32\"] \n\"2\"->\"3\" [color = \"black\", fontcolor = \"black\", label = \"1X32X2\"] \n\"3\"->\"4\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"4\"->\"5\" [color = \"black\", fontcolor = \"black\", label = \"200X32\"] \n\"5\"->\"6\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"5\"->\"7\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"5\"->\"8\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"7\"->\"9\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"8\"->\"9\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"9\"->\"10\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"6\"->\"11\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"10\"->\"11\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"3\"->\"12\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"11\"->\"13\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"12\"->\"14\" [color = \"black\", fontcolor = \"black\", label = \"200X32\"] \n\"13\"->\"14\" [color = \"black\", fontcolor = \"black\", label = \"200X32\"] \n\"14\"->\"15\" [color = \"black\", fontcolor = \"black\", label = \"200X32\"] \n\"15\"->\"16\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"15\"->\"17\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"17\"->\"18\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"9\"->\"18\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"15\"->\"19\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"15\"->\"20\" [color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"19\"->\"21\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"20\"->\"21\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"18\"->\"22\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"21\"->\"22\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"22\"->\"23\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"16\"->\"24\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"23\"->\"24\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"11\"->\"25\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"24\"->\"25\" [color = \"black\", fontcolor = \"black\", label = \"50X32\"] \n\"25\"->\"26\" [color = \"black\", fontcolor = \"black\", label = \"50X64\"] \n\"26\"->\"27\" [color = \"black\", fontcolor = \"black\", label = \"50X32X2\"] \n\"27\"->\"28\" [color = \"black\", fontcolor = \"black\", label = \"50X32X2\"] \n\"28\"->\"29\" [color = \"black\", fontcolor = \"black\", label = \"50X2X32\"] \n\"29\"->\"30\" [color = \"black\", fontcolor = \"black\", label = \"50X64\"] \n\"30\"->\"32\" [color = \"black\", fontcolor = \"black\", label = \"1X64\"] \n\"31\"->\"32\" [color = \"black\", fontcolor = \"black\", label = \"64\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;MSE&quot;, function(label, pred) {
  label = mx.nd.reshape(label, shape = -1)
  label = as.array(label)
  pred = as.array(pred)
  res &lt;- mean((label-pred)^2)
  return(res)
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.cpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 2.5)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.9, eps = 1e-5, wd = 0,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 100, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
##  296.27  198.95  214.12</code></pre>
<pre class="r"><code>plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
        mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)</code></pre>
<div id="2db83fe91bef" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2db83fe91bef">{"x":{"visdat":{"2db83d9d419c":["function () ","plotlyVisDat"]},"cur_data":"2db83d9d419c","attrs":{"2db83d9d419c":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.178007065571907,0.0551108471583459,0.034598312743759,0.0317475044635108,0.0287826449279538,0.0219045096254715,0.0242413829123286,0.0195119867172097,0.0198568226837343,0.017573239073386,0.0184465257424418,0.0127886905166058,0.0154137286790217,0.0113856547517846,0.015985983047425,0.0111882477093631,0.0130539358469957,0.0128391367111989,0.00899642270219461,0.0117842844505394,0.0101307507419849,0.0116490631956094,0.00801846663475413,0.00838363866940472,0.00909090570435946,0.0106419232943775,0.00719152375250306,0.00788588547548843,0.00699344930097816,0.00973858034726169,0.0069439329914518,0.00721849226791176,0.00628993382626623,0.00885933362257134,0.00667375234312269,0.00710952815704018,0.00714440311049035,0.00649129497878982,0.00689817942078422,0.00640123165771466,0.00710773801715374,0.00605168296878136,0.00612690081648332,0.00674430536476446,0.00620923385171444,0.00584926229598659,0.00554388696890762,0.00684964545498282,0.00541965622860488,0.00575903409813154,0.00612532418429013,0.00557883137501647,0.00553256128232306,0.00572088215188504,0.00562515245760325,0.00510222805799266,0.00505996706077044,0.00592537552514988,0.00497472303774673,0.00511339672869247,0.00540923962158494,0.00485701595285272,0.00490618353956585,0.00546475033481845,0.00485803726892704,0.00507730156161622,0.00499291023449918,0.0048931494148341,0.00475663049061314,0.00481666994880324,0.00469485763355216,0.0050173681908539,0.00456132771851912,0.00478580975193014,0.0047316209356165,0.00450863838137086,0.00463792319395273,0.00456372929682954,0.00454221000048278,0.00467297213310424,0.00452195312837283,0.00467871233345427,0.00445261988590234,0.00453412323444326,0.00450347776627088,0.00450831165275742,0.0044134041172504,0.00455807464045532,0.00452651487275533,0.00437675710938376,0.0041999042273427,0.00450004862765817,0.0042859675645016,0.00460833460615546,0.00428086110037301,0.00432933148946225,0.00436639335230272,0.00432564056193026,0.00430245129730627,0.00427316758022683],"mode":"markers+lines","name":"train","alpha":1,"sizes":[10,100],"type":"scatter"},"2db83d9d419c.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.121382719085352,0.0289926429539565,0.0466226766335414,0.0328774405811122,0.0243901008732015,0.0290596030666065,0.0260803245961094,0.012896581136737,0.0160948247514925,0.0150719739550566,0.00998896826904002,0.0164390741212733,0.00773578394039021,0.0283070329503552,0.00864060788046547,0.0118047387066933,0.0108925034379609,0.00800924529150862,0.00751984969883458,0.0114701845974171,0.00879634958757122,0.00929917642070776,0.00717997993763162,0.00715640080895273,0.0170001345097499,0.00588193237864949,0.00636823810777366,0.00717528664379361,0.00808394138782117,0.0061714930393607,0.00579772476739541,0.00649385234188524,0.00878389745675272,0.00549156732211888,0.00620832759643686,0.00639652855280996,0.00708250809965027,0.00577123582845022,0.00522837963664315,0.00827548902496661,0.00585723771650428,0.00684023349499326,0.00462057460998145,0.00646069168616548,0.00535701189348684,0.00627782804049941,0.00557875770670077,0.00457621262983116,0.00495847458197835,0.0053957376244881,0.00610346382307179,0.004543100779346,0.00453479317728428,0.00586119606662358,0.00508123896503384,0.0054419155523536,0.0043692384128001,0.00435611628416598,0.00465983258197835,0.00469915504884869,0.00484459353592523,0.00521600128346732,0.00477260895208054,0.00407685687287965,0.00430352350192965,0.00539090652498112,0.00462489354259315,0.00501238432172837,0.00503031952154898,0.0042817823338308,0.00381108020605194,0.00395165332317519,0.00430490398324171,0.00459726386185013,0.00426924747951089,0.00448567000955474,0.00484240785132747,0.00402164662600055,0.0037694476632138,0.00369958104884387,0.00394274329976708,0.0041031986366576,0.00426975194356271,0.00416545774942279,0.00431747756951232,0.00405735892825504,0.00466600037117968,0.00474076936204425,0.00457112905580145,0.00379563687821399,0.00366259940198435,0.00364533381303273,0.00385895747370559,0.00391593062867086,0.00382084180238964,0.00394130257126253,0.00426094304235278,0.00390105660850175,0.00436587057635562,0.00422961054642455],"mode":"markers+lines","name":"eval","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.178007065571907,0.0551108471583459,0.034598312743759,0.0317475044635108,0.0287826449279538,0.0219045096254715,0.0242413829123286,0.0195119867172097,0.0198568226837343,0.017573239073386,0.0184465257424418,0.0127886905166058,0.0154137286790217,0.0113856547517846,0.015985983047425,0.0111882477093631,0.0130539358469957,0.0128391367111989,0.00899642270219461,0.0117842844505394,0.0101307507419849,0.0116490631956094,0.00801846663475413,0.00838363866940472,0.00909090570435946,0.0106419232943775,0.00719152375250306,0.00788588547548843,0.00699344930097816,0.00973858034726169,0.0069439329914518,0.00721849226791176,0.00628993382626623,0.00885933362257134,0.00667375234312269,0.00710952815704018,0.00714440311049035,0.00649129497878982,0.00689817942078422,0.00640123165771466,0.00710773801715374,0.00605168296878136,0.00612690081648332,0.00674430536476446,0.00620923385171444,0.00584926229598659,0.00554388696890762,0.00684964545498282,0.00541965622860488,0.00575903409813154,0.00612532418429013,0.00557883137501647,0.00553256128232306,0.00572088215188504,0.00562515245760325,0.00510222805799266,0.00505996706077044,0.00592537552514988,0.00497472303774673,0.00511339672869247,0.00540923962158494,0.00485701595285272,0.00490618353956585,0.00546475033481845,0.00485803726892704,0.00507730156161622,0.00499291023449918,0.0048931494148341,0.00475663049061314,0.00481666994880324,0.00469485763355216,0.0050173681908539,0.00456132771851912,0.00478580975193014,0.0047316209356165,0.00450863838137086,0.00463792319395273,0.00456372929682954,0.00454221000048278,0.00467297213310424,0.00452195312837283,0.00467871233345427,0.00445261988590234,0.00453412323444326,0.00450347776627088,0.00450831165275742,0.0044134041172504,0.00455807464045532,0.00452651487275533,0.00437675710938376,0.0041999042273427,0.00450004862765817,0.0042859675645016,0.00460833460615546,0.00428086110037301,0.00432933148946225,0.00436639335230272,0.00432564056193026,0.00430245129730627,0.00427316758022683],"mode":"markers+lines","name":"train","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.121382719085352,0.0289926429539565,0.0466226766335414,0.0328774405811122,0.0243901008732015,0.0290596030666065,0.0260803245961094,0.012896581136737,0.0160948247514925,0.0150719739550566,0.00998896826904002,0.0164390741212733,0.00773578394039021,0.0283070329503552,0.00864060788046547,0.0118047387066933,0.0108925034379609,0.00800924529150862,0.00751984969883458,0.0114701845974171,0.00879634958757122,0.00929917642070776,0.00717997993763162,0.00715640080895273,0.0170001345097499,0.00588193237864949,0.00636823810777366,0.00717528664379361,0.00808394138782117,0.0061714930393607,0.00579772476739541,0.00649385234188524,0.00878389745675272,0.00549156732211888,0.00620832759643686,0.00639652855280996,0.00708250809965027,0.00577123582845022,0.00522837963664315,0.00827548902496661,0.00585723771650428,0.00684023349499326,0.00462057460998145,0.00646069168616548,0.00535701189348684,0.00627782804049941,0.00557875770670077,0.00457621262983116,0.00495847458197835,0.0053957376244881,0.00610346382307179,0.004543100779346,0.00453479317728428,0.00586119606662358,0.00508123896503384,0.0054419155523536,0.0043692384128001,0.00435611628416598,0.00465983258197835,0.00469915504884869,0.00484459353592523,0.00521600128346732,0.00477260895208054,0.00407685687287965,0.00430352350192965,0.00539090652498112,0.00462489354259315,0.00501238432172837,0.00503031952154898,0.0042817823338308,0.00381108020605194,0.00395165332317519,0.00430490398324171,0.00459726386185013,0.00426924747951089,0.00448567000955474,0.00484240785132747,0.00402164662600055,0.0037694476632138,0.00369958104884387,0.00394274329976708,0.0041031986366576,0.00426975194356271,0.00416545774942279,0.00431747756951232,0.00405735892825504,0.00466600037117968,0.00474076936204425,0.00457112905580145,0.00379563687821399,0.00366259940198435,0.00364533381303273,0.00385895747370559,0.00391593062867086,0.00382084180238964,0.00394130257126253,0.00426094304235278,0.00390105660850175,0.00436587057635562,0.00422961054642455],"mode":"markers+lines","name":"eval","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="build-the-inference-symbols" class="section level3">
<h3>Build the inference symbols</h3>
<p>Two symbols:</p>
<ul>
<li>first unrolled to the length of the inference sequence.</li>
<li>second of length one on which to iterate up to the number of the desired inference steps.</li>
</ul>
<pre class="r"><code>ctx &lt;- mx.cpu()

pred_length = 80
data = mx.nd.array(x[, , 1, drop = F])
infer_length_ini &lt;- dim(data)[2]

symbol.infer.ini &lt;- rnn.graph.unroll(seq_len = infer_length_ini,
                                     num_rnn_layer = 2, 
                                     num_hidden = 50,
                                     input_size = NULL,
                                     num_embed = NULL, 
                                     num_decode = 1,
                                     masking = F, 
                                     loss_output = &quot;linear&quot;,
                                     dropout = 0, 
                                     ignore_label = -1,
                                     cell_type = &quot;lstm&quot;,
                                     output_last_state = T,
                                     config = &quot;one-to-one&quot;)

symbol.infer &lt;- rnn.graph.unroll(seq_len = 1,
                                 num_rnn_layer = 2, 
                                 num_hidden = 50,
                                 input_size = NULL,
                                 num_embed = NULL, 
                                 num_decode = 1,
                                 masking = F, 
                                 loss_output = &quot;linear&quot;,
                                 dropout = 0, 
                                 ignore_label = -1,
                                 cell_type = &quot;lstm&quot;,
                                 output_last_state = T,
                                 config = &quot;one-to-one&quot;)</code></pre>
</div>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>predict &lt;- numeric()

infer &lt;- mx.infer.rnn.one.unroll(infer.data = data, 
                                 symbol = symbol.infer.ini,
                                 num_hidden = 50,
                                 arg.params = model$arg.params,
                                 aux.params = model$aux.params,
                                 init_states = NULL,
                                 ctx = ctx)

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  
  infer &lt;- mx.infer.rnn.one.unroll(infer.data = data, 
                                   symbol = symbol.infer,
                                   num_hidden = 50,
                                   arg.params = model$arg.params,
                                   aux.params = model$aux.params,
                                   init_states = infer[-1],
                                   ctx = ctx)
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)</code></pre>
<div id="2db820245d63" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2db820245d63">{"x":{"visdat":{"2db84f664a97":["function () ","plotlyVisDat"]},"cur_data":"2db84f664a97","attrs":{"2db84f664a97":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"hist","alpha":1,"sizes":[10,100],"type":"scatter"},"2db84f664a97.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[0.167145510337144,-0.0937278752506381,-0.348213861032726,-0.578969647636044,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.093727875250638,0.348213861032723,0.578969647636047,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252508,0.937415119882691,0.815349095244605,0.637718377193685,0.416628205616462,0.16714551033714,-0.0937278752506343,-0.348213861032723,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193682,-0.416628205616465,-0.167145510337144,0.0937278752506377,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244605,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506341,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882693,-0.815349095244603,-0.637718377193688,-0.416628205616465,-0.167145510337144,0.0937278752506375,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244606,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506338,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.90907697049524,-0.985932238226408,-0.995597853252507],"mode":"lines","name":"real","alpha":1,"sizes":[10,100],"type":"scatter"},"2db84f664a97.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[0.107312090694904,-0.23061928153038,-0.501808404922485,-0.734783053398132,-0.891999244689941,-0.992242455482483,-1.03746461868286,-1.00477623939514,-0.907171607017517,-0.758947014808655,-0.571927428245544,-0.362078726291656,-0.150315642356873,0.0544986575841904,0.257867038249969,0.450825661420822,0.615623712539673,0.743844747543335,0.831154465675354,0.866750717163086,0.841384887695312,0.755185961723328,0.607695579528809,0.399543821811676,0.136320114135742,-0.165702775120735,-0.446903109550476,-0.694353580474854,-0.870475769042969,-0.978065967559814,-1.03409349918365,-1.01253509521484,-0.923479080200195,-0.782018423080444,-0.599898934364319,-0.392185270786285,-0.179729819297791,0.0257639065384865,0.229377135634422,0.425012677907944,0.594560503959656,0.728129386901855,0.821682691574097,0.86533784866333,0.848678231239319,0.770986437797546,0.63221287727356,0.432334035634995,0.176439687609673,-0.122774302959442,-0.409867912530899,-0.661934375762939,-0.85146427154541,-0.965196967124939,-1.03074538707733,-1.02008998394012,-0.93945837020874,-0.804674506187439,-0.627509474754333,-0.422217845916748,-0.209259167313576,-0.00291072716936469,0.200789242982864,0.398663282394409,0.572754263877869,0.711620092391968,0.811216235160828,0.862701296806335,0.854767084121704,0.785580039024353,0.65550971031189,0.4640192091465,0.215615913271904,-0.0795404985547066,-0.372172802686691,-0.628314852714539,-0.830832242965698,-0.951520562171936,-1.02578175067902,-1.02624368667603],"mode":"lines","name":"pred","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.937415119882691,0.815349095244602,0.637718377193682,0.41662820561646,0.16714551033714,-0.0937278752506408,-0.348213861032727,-0.578969647636047,-0.770269609545552,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.41662820561646,-0.16714551033714,0.0937278752506407,0.348213861032727,0.578969647636047,0.770269609545552,0.909076970495243,0.985932238226409,0.995597853252507,0.937415119882691,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337139,-0.0937278752506388,-0.348213861032727,-0.578969647636047,-0.770269609545551,-0.909076970495242,-0.985932238226409,-0.995597853252507,-0.937415119882691,-0.815349095244603,-0.637718377193683,-0.416628205616461,-0.167145510337141,0.0937278752506405,0.348213861032727,0.578969647636046,0.770269609545551,0.909076970495242,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193683,0.416628205616461,0.167145510337141,-0.0937278752506386,-0.348213861032727,-0.578969647636045,-0.770269609545551,-0.909076970495243,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193684,-0.416628205616461,-0.16714551033714,0.0937278752506385,0.348213861032727,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616461,0.16714551033714,-0.0937278752506383,-0.348213861032726,-0.578969647636045,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.0937278752506382,0.348213861032726,0.578969647636045,0.770269609545551,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882692,0.815349095244603,0.637718377193685,0.416628205616462],"mode":"lines","name":"hist","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[0.167145510337144,-0.0937278752506381,-0.348213861032726,-0.578969647636044,-0.770269609545551,-0.909076970495241,-0.985932238226409,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193685,-0.416628205616462,-0.167145510337144,0.093727875250638,0.348213861032723,0.578969647636047,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252508,0.937415119882691,0.815349095244605,0.637718377193685,0.416628205616462,0.16714551033714,-0.0937278752506343,-0.348213861032723,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882692,-0.815349095244603,-0.637718377193682,-0.416628205616465,-0.167145510337144,0.0937278752506377,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244605,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506341,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.909076970495243,-0.985932238226408,-0.995597853252507,-0.937415119882693,-0.815349095244603,-0.637718377193688,-0.416628205616465,-0.167145510337144,0.0937278752506375,0.348213861032726,0.578969647636041,0.770269609545548,0.909076970495241,0.985932238226409,0.995597853252507,0.937415119882694,0.815349095244606,0.637718377193685,0.416628205616462,0.167145510337141,-0.0937278752506338,-0.348213861032722,-0.578969647636044,-0.77026960954555,-0.90907697049524,-0.985932238226408,-0.995597853252507],"mode":"lines","name":"real","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180],"y":[0.107312090694904,-0.23061928153038,-0.501808404922485,-0.734783053398132,-0.891999244689941,-0.992242455482483,-1.03746461868286,-1.00477623939514,-0.907171607017517,-0.758947014808655,-0.571927428245544,-0.362078726291656,-0.150315642356873,0.0544986575841904,0.257867038249969,0.450825661420822,0.615623712539673,0.743844747543335,0.831154465675354,0.866750717163086,0.841384887695312,0.755185961723328,0.607695579528809,0.399543821811676,0.136320114135742,-0.165702775120735,-0.446903109550476,-0.694353580474854,-0.870475769042969,-0.978065967559814,-1.03409349918365,-1.01253509521484,-0.923479080200195,-0.782018423080444,-0.599898934364319,-0.392185270786285,-0.179729819297791,0.0257639065384865,0.229377135634422,0.425012677907944,0.594560503959656,0.728129386901855,0.821682691574097,0.86533784866333,0.848678231239319,0.770986437797546,0.63221287727356,0.432334035634995,0.176439687609673,-0.122774302959442,-0.409867912530899,-0.661934375762939,-0.85146427154541,-0.965196967124939,-1.03074538707733,-1.02008998394012,-0.93945837020874,-0.804674506187439,-0.627509474754333,-0.422217845916748,-0.209259167313576,-0.00291072716936469,0.200789242982864,0.398663282394409,0.572754263877869,0.711620092391968,0.811216235160828,0.862701296806335,0.854767084121704,0.785580039024353,0.65550971031189,0.4640192091465,0.215615913271904,-0.0795404985547066,-0.372172802686691,-0.628314852714539,-0.830832242965698,-0.951520562171936,-1.02578175067902,-1.02624368667603],"mode":"lines","name":"pred","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
