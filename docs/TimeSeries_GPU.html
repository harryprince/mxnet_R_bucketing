<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-0.9.2/grViz.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET Bucketing</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU">GPU</a></li>
        <li><a href="TimeSeries_CPU">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="CNN_NLP_classification_kaggle.html">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<pre class="r"><code>seq_len = 100
samples = 192

seeds &lt;- runif(samples, min = -pi, max = pi)
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, samples))
y &lt;- pts[-1, ]

p1 = plot_ly(x = 1:dim(x)[2], y = x[1,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p2 = plot_ly(x = 1:length(y[,1]), y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;%
  add_trace(x = 1:length(y[,2]), y = y[,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p1</code></pre>
<div id="2a716ad3ad85" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2a716ad3ad85">{"x":{"visdat":{"2a713dd6043c":["function () ","plotlyVisDat"]},"cur_data":"2a713dd6043c","attrs":{"2a713dd6043c":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.560838530065012,0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864767,0.654558643840493,0.436584993947793,0.188858798208366,-0.0717378125250393,-0.327445609887204,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208366,0.0717378125250392,0.327445609887204,0.560838530065012,0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864768,0.654558643840493,0.436584993947793,0.188858798208367,-0.0717378125250382,-0.327445609887203,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208367,0.0717378125250381,0.327445609887203,0.560838530065012,0.756011231248382,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840493,0.436584993947794,0.188858798208368,-0.0717378125250379,-0.327445609887203,-0.560838530065009,-0.756011231248381,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864769,-0.654558643840493,-0.436584993947795,-0.188858798208368,0.071737812525036,0.327445609887203,0.560838530065012,0.756011231248381,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840494,0.436584993947795,0.188858798208368,-0.0717378125250359,-0.327445609887202,-0.560838530065012,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947796,-0.188858798208368,0.0717378125250358,0.327445609887202,0.560838530065011,0.75601123124838,0.899663016389806,0.982004253727697],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2a713dd6043c.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492294,0.820911677330533,0.645139833979386,0.425402777086529,0.176675223946554,-0.0840924537357671,-0.339129369665346,-0.571055179490013,-0.76406452254574,-0.9050041310663,-0.984269203644732,-0.996457956576542,-0.940739746492294,-0.820911677330533,-0.645139833979387,-0.425402777086529,-0.176675223946554,0.0840924537357665,0.339129369665346,0.571055179490013,0.76406452254574,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492294,0.820911677330533,0.645139833979387,0.42540277708653,0.176675223946553,-0.0840924537357655,-0.339129369665346,-0.571055179490011,-0.76406452254574,-0.9050041310663,-0.984269203644732,-0.996457956576542,-0.940739746492295,-0.820911677330533,-0.645139833979388,-0.42540277708653,-0.176675223946553,0.0840924537357654,0.339129369665346,0.571055179490011,0.76406452254574,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492295,0.820911677330533,0.645139833979388,0.42540277708653,0.176675223946553,-0.0840924537357653,-0.339129369665345,-0.571055179490011,-0.76406452254574,-0.905004131066299,-0.984269203644732,-0.996457956576542,-0.940739746492295,-0.820911677330533,-0.645139833979386,-0.42540277708653,-0.176675223946554,0.0840924537357651,0.339129369665345,0.571055179490011,0.764064522545739,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492295,0.820911677330533,0.645139833979386,0.42540277708653,0.176675223946554,-0.084092453735765,-0.339129369665345,-0.571055179490011,-0.764064522545739,-0.9050041310663,-0.984269203644732,-0.996457956576542,-0.940739746492295,-0.820911677330533,-0.645139833979389,-0.425402777086531,-0.176675223946554,0.0840924537357649,0.339129369665345,0.571055179490011,0.764064522545739,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492295],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2a713dd6043c.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.779198631799293,0.914869924337277,0.98819434342571,0.994174951078047,0.932404178766204,0.807091602542205,0.62677706738689,0.403748710887237,0.153205546966912,-0.107778321795072,-0.361417276038819,-0.59042624019081,-0.779198631799293,-0.914869924337276,-0.98819434342571,-0.994174951078047,-0.932404178766204,-0.807091602542205,-0.62677706738689,-0.403748710887238,-0.153205546966912,0.107778321795072,0.361417276038819,0.59042624019081,0.779198631799293,0.914869924337276,0.98819434342571,0.994174951078048,0.932404178766204,0.807091602542205,0.62677706738689,0.403748710887238,0.153205546966912,-0.107778321795071,-0.361417276038818,-0.590426240190809,-0.779198631799293,-0.914869924337276,-0.98819434342571,-0.994174951078048,-0.932404178766205,-0.807091602542206,-0.62677706738689,-0.403748710887238,-0.153205546966912,0.107778321795071,0.361417276038818,0.590426240190809,0.779198631799292,0.914869924337276,0.98819434342571,0.994174951078048,0.932404178766205,0.807091602542206,0.626777067386892,0.403748710887238,0.153205546966912,-0.107778321795071,-0.361417276038818,-0.59042624019081,-0.779198631799291,-0.914869924337276,-0.988194343425709,-0.994174951078048,-0.932404178766204,-0.807091602542204,-0.626777067386893,-0.40374871088724,-0.153205546966913,0.107778321795072,0.361417276038815,0.590426240190807,0.779198631799291,0.914869924337276,0.98819434342571,0.994174951078048,0.932404178766206,0.807091602542206,0.626777067386891,0.403748710887237,0.153205546966916,-0.107778321795069,-0.361417276038818,-0.59042624019081,-0.779198631799293,-0.914869924337275,-0.988194343425709,-0.994174951078048,-0.932404178766204,-0.807091602542208,-0.626777067386894,-0.40374871088724,-0.153205546966913,0.107778321795072,0.361417276038814,0.590426240190807,0.779198631799291,0.914869924337276,0.98819434342571,0.994174951078048],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2a713dd6043c.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.832890520663393,-0.661270225641282,-0.444585457542435,-0.197602925224278,0.06284591989364,0.319011919428599,0.553437783846623,0.750147777894681,0.895736440557033,0.980282145069882,0.998023241389058,0.947750703118959,0.832890520663393,0.661270225641282,0.444585457542435,0.197602925224278,-0.0628459198936397,-0.319011919428599,-0.553437783846623,-0.750147777894681,-0.895736440557033,-0.980282145069882,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641283,-0.444585457542436,-0.197602925224279,0.0628459198936396,0.319011919428599,0.553437783846622,0.750147777894681,0.895736440557033,0.980282145069881,0.998023241389058,0.947750703118959,0.832890520663393,0.661270225641283,0.444585457542435,0.19760292522428,-0.0628459198936394,-0.319011919428597,-0.553437783846622,-0.750147777894681,-0.895736440557032,-0.980282145069882,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641283,-0.444585457542435,-0.19760292522428,0.0628459198936393,0.319011919428597,0.553437783846622,0.750147777894681,0.895736440557032,0.980282145069882,0.998023241389058,0.947750703118959,0.832890520663395,0.661270225641283,0.444585457542435,0.19760292522428,-0.0628459198936392,-0.3190119194286,-0.553437783846622,-0.750147777894681,-0.895736440557032,-0.980282145069882,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641284,-0.444585457542435,-0.19760292522428,0.0628459198936391,0.3190119194286,0.553437783846622,0.750147777894681,0.895736440557032,0.980282145069882,0.998023241389058,0.947750703118959,0.832890520663393,0.661270225641284,0.444585457542435,0.19760292522428,-0.0628459198936389,-0.319011919428596,-0.553437783846622,-0.750147777894681,-0.895736440557032,-0.980282145069881,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641284,-0.444585457542436,-0.19760292522428],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"2a713dd6043c.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.542183705368368,0.741184528598911,0.889674851070786,0.977535302699394,0.998778338902507,0.951956281868661,0.840259977407604,0.671301344081486,0.45659463353414,0.21077175326975,-0.0494148736631815,-0.306233958617907,-0.542183705368368,-0.741184528598911,-0.889674851070786,-0.977535302699394,-0.998778338902507,-0.951956281868661,-0.840259977407604,-0.671301344081487,-0.456594633534141,-0.21077175326975,0.0494148736631819,0.306233958617907,0.542183705368367,0.74118452859891,0.889674851070785,0.977535302699394,0.998778338902507,0.951956281868661,0.840259977407604,0.671301344081487,0.456594633534141,0.210771753269752,-0.04941487366318,-0.306233958617906,-0.542183705368367,-0.74118452859891,-0.889674851070785,-0.977535302699394,-0.998778338902507,-0.951956281868662,-0.840259977407604,-0.671301344081487,-0.456594633534141,-0.210771753269752,0.0494148736631798,0.306233958617905,0.542183705368367,0.74118452859891,0.889674851070785,0.977535302699393,0.998778338902507,0.951956281868662,0.840259977407605,0.671301344081487,0.456594633534141,0.210771753269752,-0.0494148736631797,-0.306233958617905,-0.542183705368367,-0.741184528598911,-0.889674851070785,-0.977535302699393,-0.998778338902507,-0.951956281868661,-0.840259977407605,-0.671301344081487,-0.456594633534143,-0.210771753269752,0.0494148736631778,0.306233958617905,0.542183705368367,0.741184528598909,0.889674851070785,0.977535302699393,0.998778338902507,0.951956281868661,0.840259977407605,0.671301344081487,0.456594633534143,0.210771753269752,-0.0494148736631777,-0.306233958617905,-0.542183705368367,-0.741184528598909,-0.889674851070785,-0.977535302699393,-0.998778338902507,-0.951956281868662,-0.840259977407605,-0.671301344081487,-0.456594633534143,-0.210771753269752,0.0494148736631776,0.306233958617905,0.542183705368367,0.741184528598909,0.889674851070785,0.977535302699393],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.560838530065012,0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864767,0.654558643840493,0.436584993947793,0.188858798208366,-0.0717378125250393,-0.327445609887204,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208366,0.0717378125250392,0.327445609887204,0.560838530065012,0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864768,0.654558643840493,0.436584993947793,0.188858798208367,-0.0717378125250382,-0.327445609887203,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208367,0.0717378125250381,0.327445609887203,0.560838530065012,0.756011231248382,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840493,0.436584993947794,0.188858798208368,-0.0717378125250379,-0.327445609887203,-0.560838530065009,-0.756011231248381,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864769,-0.654558643840493,-0.436584993947795,-0.188858798208368,0.071737812525036,0.327445609887203,0.560838530065012,0.756011231248381,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840494,0.436584993947795,0.188858798208368,-0.0717378125250359,-0.327445609887202,-0.560838530065012,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947796,-0.188858798208368,0.0717378125250358,0.327445609887202,0.560838530065011,0.75601123124838,0.899663016389806,0.982004253727697],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492294,0.820911677330533,0.645139833979386,0.425402777086529,0.176675223946554,-0.0840924537357671,-0.339129369665346,-0.571055179490013,-0.76406452254574,-0.9050041310663,-0.984269203644732,-0.996457956576542,-0.940739746492294,-0.820911677330533,-0.645139833979387,-0.425402777086529,-0.176675223946554,0.0840924537357665,0.339129369665346,0.571055179490013,0.76406452254574,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492294,0.820911677330533,0.645139833979387,0.42540277708653,0.176675223946553,-0.0840924537357655,-0.339129369665346,-0.571055179490011,-0.76406452254574,-0.9050041310663,-0.984269203644732,-0.996457956576542,-0.940739746492295,-0.820911677330533,-0.645139833979388,-0.42540277708653,-0.176675223946553,0.0840924537357654,0.339129369665346,0.571055179490011,0.76406452254574,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492295,0.820911677330533,0.645139833979388,0.42540277708653,0.176675223946553,-0.0840924537357653,-0.339129369665345,-0.571055179490011,-0.76406452254574,-0.905004131066299,-0.984269203644732,-0.996457956576542,-0.940739746492295,-0.820911677330533,-0.645139833979386,-0.42540277708653,-0.176675223946554,0.0840924537357651,0.339129369665345,0.571055179490011,0.764064522545739,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492295,0.820911677330533,0.645139833979386,0.42540277708653,0.176675223946554,-0.084092453735765,-0.339129369665345,-0.571055179490011,-0.764064522545739,-0.9050041310663,-0.984269203644732,-0.996457956576542,-0.940739746492295,-0.820911677330533,-0.645139833979389,-0.425402777086531,-0.176675223946554,0.0840924537357649,0.339129369665345,0.571055179490011,0.764064522545739,0.9050041310663,0.984269203644732,0.996457956576542,0.940739746492295],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.779198631799293,0.914869924337277,0.98819434342571,0.994174951078047,0.932404178766204,0.807091602542205,0.62677706738689,0.403748710887237,0.153205546966912,-0.107778321795072,-0.361417276038819,-0.59042624019081,-0.779198631799293,-0.914869924337276,-0.98819434342571,-0.994174951078047,-0.932404178766204,-0.807091602542205,-0.62677706738689,-0.403748710887238,-0.153205546966912,0.107778321795072,0.361417276038819,0.59042624019081,0.779198631799293,0.914869924337276,0.98819434342571,0.994174951078048,0.932404178766204,0.807091602542205,0.62677706738689,0.403748710887238,0.153205546966912,-0.107778321795071,-0.361417276038818,-0.590426240190809,-0.779198631799293,-0.914869924337276,-0.98819434342571,-0.994174951078048,-0.932404178766205,-0.807091602542206,-0.62677706738689,-0.403748710887238,-0.153205546966912,0.107778321795071,0.361417276038818,0.590426240190809,0.779198631799292,0.914869924337276,0.98819434342571,0.994174951078048,0.932404178766205,0.807091602542206,0.626777067386892,0.403748710887238,0.153205546966912,-0.107778321795071,-0.361417276038818,-0.59042624019081,-0.779198631799291,-0.914869924337276,-0.988194343425709,-0.994174951078048,-0.932404178766204,-0.807091602542204,-0.626777067386893,-0.40374871088724,-0.153205546966913,0.107778321795072,0.361417276038815,0.590426240190807,0.779198631799291,0.914869924337276,0.98819434342571,0.994174951078048,0.932404178766206,0.807091602542206,0.626777067386891,0.403748710887237,0.153205546966916,-0.107778321795069,-0.361417276038818,-0.59042624019081,-0.779198631799293,-0.914869924337275,-0.988194343425709,-0.994174951078048,-0.932404178766204,-0.807091602542208,-0.626777067386894,-0.40374871088724,-0.153205546966913,0.107778321795072,0.361417276038814,0.590426240190807,0.779198631799291,0.914869924337276,0.98819434342571,0.994174951078048],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.832890520663393,-0.661270225641282,-0.444585457542435,-0.197602925224278,0.06284591989364,0.319011919428599,0.553437783846623,0.750147777894681,0.895736440557033,0.980282145069882,0.998023241389058,0.947750703118959,0.832890520663393,0.661270225641282,0.444585457542435,0.197602925224278,-0.0628459198936397,-0.319011919428599,-0.553437783846623,-0.750147777894681,-0.895736440557033,-0.980282145069882,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641283,-0.444585457542436,-0.197602925224279,0.0628459198936396,0.319011919428599,0.553437783846622,0.750147777894681,0.895736440557033,0.980282145069881,0.998023241389058,0.947750703118959,0.832890520663393,0.661270225641283,0.444585457542435,0.19760292522428,-0.0628459198936394,-0.319011919428597,-0.553437783846622,-0.750147777894681,-0.895736440557032,-0.980282145069882,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641283,-0.444585457542435,-0.19760292522428,0.0628459198936393,0.319011919428597,0.553437783846622,0.750147777894681,0.895736440557032,0.980282145069882,0.998023241389058,0.947750703118959,0.832890520663395,0.661270225641283,0.444585457542435,0.19760292522428,-0.0628459198936392,-0.3190119194286,-0.553437783846622,-0.750147777894681,-0.895736440557032,-0.980282145069882,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641284,-0.444585457542435,-0.19760292522428,0.0628459198936391,0.3190119194286,0.553437783846622,0.750147777894681,0.895736440557032,0.980282145069882,0.998023241389058,0.947750703118959,0.832890520663393,0.661270225641284,0.444585457542435,0.19760292522428,-0.0628459198936389,-0.319011919428596,-0.553437783846622,-0.750147777894681,-0.895736440557032,-0.980282145069881,-0.998023241389058,-0.947750703118959,-0.832890520663393,-0.661270225641284,-0.444585457542436,-0.19760292522428],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.542183705368368,0.741184528598911,0.889674851070786,0.977535302699394,0.998778338902507,0.951956281868661,0.840259977407604,0.671301344081486,0.45659463353414,0.21077175326975,-0.0494148736631815,-0.306233958617907,-0.542183705368368,-0.741184528598911,-0.889674851070786,-0.977535302699394,-0.998778338902507,-0.951956281868661,-0.840259977407604,-0.671301344081487,-0.456594633534141,-0.21077175326975,0.0494148736631819,0.306233958617907,0.542183705368367,0.74118452859891,0.889674851070785,0.977535302699394,0.998778338902507,0.951956281868661,0.840259977407604,0.671301344081487,0.456594633534141,0.210771753269752,-0.04941487366318,-0.306233958617906,-0.542183705368367,-0.74118452859891,-0.889674851070785,-0.977535302699394,-0.998778338902507,-0.951956281868662,-0.840259977407604,-0.671301344081487,-0.456594633534141,-0.210771753269752,0.0494148736631798,0.306233958617905,0.542183705368367,0.74118452859891,0.889674851070785,0.977535302699393,0.998778338902507,0.951956281868662,0.840259977407605,0.671301344081487,0.456594633534141,0.210771753269752,-0.0494148736631797,-0.306233958617905,-0.542183705368367,-0.741184528598911,-0.889674851070785,-0.977535302699393,-0.998778338902507,-0.951956281868661,-0.840259977407605,-0.671301344081487,-0.456594633534143,-0.210771753269752,0.0494148736631778,0.306233958617905,0.542183705368367,0.741184528598909,0.889674851070785,0.977535302699393,0.998778338902507,0.951956281868661,0.840259977407605,0.671301344081487,0.456594633534143,0.210771753269752,-0.0494148736631777,-0.306233958617905,-0.542183705368367,-0.741184528598909,-0.889674851070785,-0.977535302699393,-0.998778338902507,-0.951956281868662,-0.840259977407605,-0.671301344081487,-0.456594633534143,-0.210771753269752,0.0494148736631776,0.306233958617905,0.542183705368367,0.741184528598909,0.889674851070785,0.977535302699393],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<p>Hacky array.iter approach: batch.size = seq.length so that the graph is fed with the expected format.</p>
<pre class="r"><code>batch.size = 16

train.data &lt;- mx.io.arrayiter(data = x[,,1:160, drop = F], label = y[, 1:160], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-(1:160), drop = F], label = y[, -(1:160)], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph(num_rnn_layer =  2, 
                    num_hidden = 50,
                    input_size = NULL,
                    num_embed = NULL, 
                    num_decode = 1,
                    masking = F, 
                    loss_output = &quot;linear&quot;,
                    dropout = 0.2, 
                    ignore_label = -1,
                    cell_type = &quot;lstm&quot;,
                    output_last_state = T,
                    config = &quot;one-to-one&quot;)

graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;LR&quot;, 
          shape=list(data = c(1, seq_len, batch.size), 
                     label = c(seq_len, batch.size)),
          graph.width.px = 800, graph.height.px = 220)</code></pre>
<div id="htmlwidget-1704b64ea8ee1cda9c95" style="width:800px;height:220px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1704b64ea8ee1cda9c95">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"RNN\nRNN\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"5\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"7\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"8\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"9\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [id = \"1\", color = \"black\", fontcolor = \"black\", label = \"1X100X16\"] \n\"2\"->\"3\" [id = \"2\", color = \"black\", fontcolor = \"black\", label = \"1X16X100\"] \n\"3\"->\"4\" [id = \"3\", color = \"black\", fontcolor = \"black\", label = \"50X16X100\"] \n\"4\"->\"5\" [id = \"4\", color = \"black\", fontcolor = \"black\", label = \"50X16X100\"] \n\"5\"->\"6\" [id = \"5\", color = \"black\", fontcolor = \"black\", label = \"50X100X16\"] \n\"6\"->\"7\" [id = \"6\", color = \"black\", fontcolor = \"black\", label = \"50X1600\"] \n\"7\"->\"9\" [id = \"7\", color = \"black\", fontcolor = \"black\", label = \"1X1600\"] \n\"8\"->\"9\" [id = \"8\", color = \"black\", fontcolor = \"black\", label = \"1600\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;Perplexity&quot;, function(label, pred) {
  label = mx.nd.reshape(mx.nd.array(label), shape = -1)
  label = as.array(label)
  res &lt;- mean((label-pred)^2)
  return(res)
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.gpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 3)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.95, eps = 1e-6, wd = 1e-8,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 250, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
##  58.888   5.524  55.494</code></pre>
<pre class="r"><code>plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
        mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)</code></pre>
<div id="2a715280b563" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2a715280b563">{"x":{"visdat":{"2a7150c5a02e":["function () ","plotlyVisDat"]},"cur_data":"2a7150c5a02e","attrs":{"2a7150c5a02e":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.387680753256508,0.128178470370237,0.047442403027397,0.0363762981093569,0.0291099360857646,0.0233171094917546,0.0194209246803553,0.0270336921840892,0.0189822954598484,0.0138159410915294,0.00992869372927119,0.010438993569449,0.0159275669579282,0.011696481461264,0.00843659908500467,0.00722633957576782,0.00705369546359468,0.0110411953781353,0.011761202029375,0.00853368137861261,0.00851632787553361,0.00873570859799249,0.00734721334524248,0.00769819089346062,0.0141508684053275,0.0111090315242924,0.00896030805348055,0.00731821670070068,0.00799955515766546,0.00861661297930183,0.00892354473154881,0.013419902185256,0.00983060882569464,0.00760973994970714,0.0074086054423773,0.00739358568751167,0.00759069715290095,0.00831761854276957,0.01210625434993,0.010543947906944,0.00779847398972329,0.00731184343759026,0.00723078394810626,0.00683334506464071,0.00748925657546548,0.00848605989520189,0.0123702761217203,0.00942794885038923,0.00844484836569701,0.0066561551445616,0.0059395655724151,0.00665461186438921,0.00672348586831682,0.00763041631192604,0.0120639910897796,0.00968778967983395,0.00793546553272918,0.00688520310878457,0.00720596136611527,0.00675572846360589,0.00560048699676309,0.00472772342937264,0.00521892699183777,0.010261892662823,0.00928622039245778,0.00707062468227607,0.00647311517039108,0.00611599698474673,0.00577182160947931,0.00544001544840558,0.00641486328121693,0.00725661809203202,0.0103416966476215,0.00862578485730275,0.00641978167603927,0.00574238329553548,0.00512385399206784,0.00449962479565571,0.00516915427291344,0.00595813143781381,0.00628544344159757,0.00900029870921541,0.00840099297836237,0.00622083591745875,0.00521062774901509,0.00484112779053009,0.00473070667467969,0.00500906613651631,0.0057431156893846,0.0066075444651741,0.00611278775059743,0.00542493914040704,0.0044838994832696,0.00489526096561594,0.00925631146206455,0.00752159461525279,0.00618322976925282,0.00537626761094676,0.00463743015363228,0.00472030423893238,0.00456855955609205,0.00553975286194522,0.00813785165415802,0.00696948895723207,0.0056426710580503,0.0048414866438895,0.00485603684451019,0.00451154587627624,0.00462440323370358,0.00487167278572791,0.00497442859151166,0.00456757243069252,0.00468132108009352,0.00561070820889893,0.0078689192442978,0.0059051333304075,0.00522566729775404,0.00500656671054136,0.00415634187085081,0.00363732208178949,0.00354862912669481,0.00394615495255472,0.0045031033058459,0.00423289442372137,0.00479708532274241,0.00611609271645178,0.00588372111816599,0.00481886465813584,0.00435874831428933,0.00403822940222661,0.0036334809963623,0.0034501552049666,0.00348397929044463,0.00446917372304806,0.00551544230050284,0.00535153763640914,0.00475603079019782,0.0036218478323482,0.00346273350160038,0.00334333753761359,0.00330927392323065,0.00355875403194279,0.00410064607133982,0.00388970370225869,0.00385417388014572,0.00350991513224778,0.00301240667022147,0.00402033084394013,0.00586178229968589,0.0044212238331636,0.00354219834784379,0.0030673451919875,0.00306189036615544,0.00283199897509001,0.00309495154632512,0.00424730978320747,0.00379846143409266,0.00327295020598801,0.00288977070167276,0.00294880786703274,0.00396075087315994,0.00375157036253389,0.00328145858969734,0.00319763138407274,0.00346126875608674,0.00301340136841839,0.00311091597454434,0.00285466454973384,0.00446194226709412,0.00413353045024508,0.00376257484826183,0.00335880770348799,0.00301444327326769,0.0026645500368316,0.00319550074381458,0.00401474564914631,0.00344630368438933,0.00292133376811855,0.00269480422780721,0.00337901470999245,0.0033306980683339,0.00276792354127266,0.00283111314919398,0.00307537459532931,0.00298989037911063,0.00287925772523097,0.00263586291129683,0.00297765880471825,0.0041095575897613,0.00316144735007996,0.00269427225511438,0.00327329845172157,0.00331444177151223,0.00267872392736613,0.00259920016661355,0.00306244685916685,0.00278028305346868,0.00253012810847753,0.00288414360071045,0.00303714334114438,0.002886671387646,0.00256296391217932,0.00296752304634817,0.00338347199031251,0.00285534887014929,0.00299104817774602,0.00306208591132487,0.00254478399458702,0.00233354566317787,0.00273196782086863,0.00297130454933565,0.00283676005756147,0.00264209154960186,0.00291872794753258,0.00355420271298917,0.00311907681270843,0.0025992745315929,0.00259681298743126,0.00268044891600602,0.00278552445628629,0.00247286278932235,0.00235850920339924,0.00284736147366939,0.00294215663681247,0.00246306974447234,0.00273151629718888,0.00300513686894676,0.00252155459385609,0.0026396325970877,0.00270017580093055,0.00254654550616666,0.00260178018525613,0.00255270912913545,0.00242728845484168,0.00255047799890619,0.0024023999960699,0.0032070453545894,0.00267241399862294,0.00242702990950661,0.00251153780669105,0.0026210891930403,0.00273879030336155,0.00235256041947059,0.00254722902290516,0.00278082501489266,0.00256962591534131,0.002414904015421,0.00246373107322506,0.00280008079935296,0.00242375713167129],"mode":"markers+lines","name":"train","alpha":1,"sizes":[10,100],"type":"scatter"},"2a7150c5a02e.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.103379413761603,0.0345576634255933,0.0405262089572354,0.019107735693425,0.0176283119668539,0.012308374905511,0.0272730647090174,0.014586105597018,0.0112987580051164,0.00824788757495329,0.00626144217217259,0.0213547471039807,0.0151008854447366,0.00957033077909152,0.00677094044058497,0.00596610349629472,0.00580196084806304,0.00875128919848713,0.00640605077543884,0.00537079645996634,0.00609208627005781,0.0052441117857607,0.00428946501618147,0.0175412612338432,0.0144255773577152,0.00914296783791096,0.00708454046083358,0.00658431951745033,0.00911238689225295,0.0084076117115865,0.0168305539683407,0.0118615192921289,0.00725604820536767,0.00639885058491093,0.00576214354555573,0.00544605087124737,0.00776012272761224,0.00954323357207289,0.0129106675216986,0.00828474609846426,0.00739635951432649,0.00763062186124626,0.00667598163241417,0.00714311723322014,0.00703205170302605,0.0161652359820588,0.0111008757131109,0.0085176435053528,0.00648804654313075,0.00458916225038897,0.00520980593601623,0.00599619798453482,0.00604807050887057,0.0128224743108053,0.012713016310294,0.00959400275224314,0.00659561257770602,0.00659972148716939,0.00612297674449469,0.00563419307209279,0.00433015103665011,0.00421278771122113,0.00563505725886809,0.00643498064279789,0.0055805508615076,0.00442844101744375,0.00376748524539501,0.00423725025252619,0.00380025297060338,0.00388157119733039,0.00463110412213229,0.00731295684830859,0.0059518048327253,0.00459575399135305,0.00375995902472061,0.00335401693917368,0.0028658953891434,0.00285657947134141,0.00361933282576336,0.00345091341844177,0.00476413096329958,0.00605920637763537,0.00484118224875894,0.00364485942390782,0.00320688240020934,0.00328144357399639,0.00316501752531244,0.00340038695799755,0.00440217293525592,0.00435930165309912,0.00386775730247279,0.00312195032068783,0.00285358390514409,0.0105195506975303,0.0104980905488892,0.00748396019896022,0.00566714807364153,0.00445296871632937,0.00474506782373055,0.00489382294369737,0.00467087381465946,0.00692102143056526,0.009582879643441,0.00597793299518298,0.00434825730571677,0.00383820726425951,0.00404267168069318,0.00386667954223437,0.00438106999394777,0.00521454442950843,0.00427810571631611,0.00385369712095468,0.00459941326155277,0.0109158739019637,0.00814130112044733,0.00559918237319053,0.00476927521058012,0.0046601727548546,0.00346530627197426,0.00288603047045245,0.00339136674513063,0.00419163437645019,0.00455932552766356,0.00387008251483246,0.00529200809013135,0.00730890427338462,0.00422768977831926,0.00386829038998395,0.00398219041393815,0.00327025204057127,0.00323804900154075,0.00250841526027654,0.00355251787407022,0.00441835882580797,0.00666218296944799,0.00597644575825503,0.00416388300762512,0.00319046406992581,0.00279261934824564,0.00300145013023378,0.00297894210929794,0.00341859853494178,0.00409772012591498,0.00368136161606118,0.00429609408918313,0.00245657890022968,0.00266976818266728,0.00472556618398019,0.00371476959082978,0.00290016632661364,0.00262103780946511,0.00227956611433306,0.00223974783112733,0.00224316157785471,0.00337342537916769,0.00372343593681819,0.00362637887169552,0.00273294135715678,0.00235227464899381,0.00254428863523878,0.00298437608586531,0.00251749535799491,0.00259367634995376,0.0024174150545303,0.00238697100380923,0.00200424226392354,0.00261406670032898,0.00326773827494092,0.00464861041098963,0.00368182550686718,0.00340203561548703,0.00291901411046921,0.00260341650953424,0.00226661085273471,0.00280616370673492,0.00253240483006633,0.00229866134722568,0.002098472226702,0.00222896707248276,0.00449894589580006,0.00289498802850714,0.00229556839984285,0.00244841685614718,0.00225709655545498,0.00223728151249622,0.00217892973960867,0.00208184738449545,0.00398256212661768,0.00370789248223021,0.00280662066411437,0.00243692584469453,0.00267832355021858,0.00218421238074854,0.00215409581898273,0.00234032574442418,0.00301346268473546,0.00224465052889003,0.00221869289912101,0.00263589056589182,0.00229557819565083,0.0021070845162025,0.00220284405121448,0.00344173776049742,0.00310353406671931,0.00235765154598913,0.00243410357292855,0.00222453525239734,0.00191548536989025,0.00229323166066241,0.00277631085185879,0.0025633519255498,0.00289185766107628,0.00224453645781818,0.00285386695767033,0.00252628856448636,0.00225160131029263,0.0020515993830817,0.00212334390291236,0.00274993214966097,0.0024693891629667,0.00217718220796148,0.00222396390145799,0.00242377013099358,0.00219783180013462,0.00205817175213448,0.00287070768060947,0.00275613361304712,0.00216768930444813,0.00210046206980817,0.0019583232028081,0.00224766106495403,0.00217253453506383,0.00264623995056752,0.00225570026381441,0.00219108672518958,0.00251675415632747,0.0022649341716674,0.00193694134117827,0.00212570276874084,0.00254496697659774,0.00236900315850428,0.00198216102266561,0.00205979579346857,0.00236479098232174,0.00223128798861017,0.00192149356781313,0.00184393487066878,0.00272243329709547,0.00250283455906089,0.00191833424916089],"mode":"markers+lines","name":"eval","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.387680753256508,0.128178470370237,0.047442403027397,0.0363762981093569,0.0291099360857646,0.0233171094917546,0.0194209246803553,0.0270336921840892,0.0189822954598484,0.0138159410915294,0.00992869372927119,0.010438993569449,0.0159275669579282,0.011696481461264,0.00843659908500467,0.00722633957576782,0.00705369546359468,0.0110411953781353,0.011761202029375,0.00853368137861261,0.00851632787553361,0.00873570859799249,0.00734721334524248,0.00769819089346062,0.0141508684053275,0.0111090315242924,0.00896030805348055,0.00731821670070068,0.00799955515766546,0.00861661297930183,0.00892354473154881,0.013419902185256,0.00983060882569464,0.00760973994970714,0.0074086054423773,0.00739358568751167,0.00759069715290095,0.00831761854276957,0.01210625434993,0.010543947906944,0.00779847398972329,0.00731184343759026,0.00723078394810626,0.00683334506464071,0.00748925657546548,0.00848605989520189,0.0123702761217203,0.00942794885038923,0.00844484836569701,0.0066561551445616,0.0059395655724151,0.00665461186438921,0.00672348586831682,0.00763041631192604,0.0120639910897796,0.00968778967983395,0.00793546553272918,0.00688520310878457,0.00720596136611527,0.00675572846360589,0.00560048699676309,0.00472772342937264,0.00521892699183777,0.010261892662823,0.00928622039245778,0.00707062468227607,0.00647311517039108,0.00611599698474673,0.00577182160947931,0.00544001544840558,0.00641486328121693,0.00725661809203202,0.0103416966476215,0.00862578485730275,0.00641978167603927,0.00574238329553548,0.00512385399206784,0.00449962479565571,0.00516915427291344,0.00595813143781381,0.00628544344159757,0.00900029870921541,0.00840099297836237,0.00622083591745875,0.00521062774901509,0.00484112779053009,0.00473070667467969,0.00500906613651631,0.0057431156893846,0.0066075444651741,0.00611278775059743,0.00542493914040704,0.0044838994832696,0.00489526096561594,0.00925631146206455,0.00752159461525279,0.00618322976925282,0.00537626761094676,0.00463743015363228,0.00472030423893238,0.00456855955609205,0.00553975286194522,0.00813785165415802,0.00696948895723207,0.0056426710580503,0.0048414866438895,0.00485603684451019,0.00451154587627624,0.00462440323370358,0.00487167278572791,0.00497442859151166,0.00456757243069252,0.00468132108009352,0.00561070820889893,0.0078689192442978,0.0059051333304075,0.00522566729775404,0.00500656671054136,0.00415634187085081,0.00363732208178949,0.00354862912669481,0.00394615495255472,0.0045031033058459,0.00423289442372137,0.00479708532274241,0.00611609271645178,0.00588372111816599,0.00481886465813584,0.00435874831428933,0.00403822940222661,0.0036334809963623,0.0034501552049666,0.00348397929044463,0.00446917372304806,0.00551544230050284,0.00535153763640914,0.00475603079019782,0.0036218478323482,0.00346273350160038,0.00334333753761359,0.00330927392323065,0.00355875403194279,0.00410064607133982,0.00388970370225869,0.00385417388014572,0.00350991513224778,0.00301240667022147,0.00402033084394013,0.00586178229968589,0.0044212238331636,0.00354219834784379,0.0030673451919875,0.00306189036615544,0.00283199897509001,0.00309495154632512,0.00424730978320747,0.00379846143409266,0.00327295020598801,0.00288977070167276,0.00294880786703274,0.00396075087315994,0.00375157036253389,0.00328145858969734,0.00319763138407274,0.00346126875608674,0.00301340136841839,0.00311091597454434,0.00285466454973384,0.00446194226709412,0.00413353045024508,0.00376257484826183,0.00335880770348799,0.00301444327326769,0.0026645500368316,0.00319550074381458,0.00401474564914631,0.00344630368438933,0.00292133376811855,0.00269480422780721,0.00337901470999245,0.0033306980683339,0.00276792354127266,0.00283111314919398,0.00307537459532931,0.00298989037911063,0.00287925772523097,0.00263586291129683,0.00297765880471825,0.0041095575897613,0.00316144735007996,0.00269427225511438,0.00327329845172157,0.00331444177151223,0.00267872392736613,0.00259920016661355,0.00306244685916685,0.00278028305346868,0.00253012810847753,0.00288414360071045,0.00303714334114438,0.002886671387646,0.00256296391217932,0.00296752304634817,0.00338347199031251,0.00285534887014929,0.00299104817774602,0.00306208591132487,0.00254478399458702,0.00233354566317787,0.00273196782086863,0.00297130454933565,0.00283676005756147,0.00264209154960186,0.00291872794753258,0.00355420271298917,0.00311907681270843,0.0025992745315929,0.00259681298743126,0.00268044891600602,0.00278552445628629,0.00247286278932235,0.00235850920339924,0.00284736147366939,0.00294215663681247,0.00246306974447234,0.00273151629718888,0.00300513686894676,0.00252155459385609,0.0026396325970877,0.00270017580093055,0.00254654550616666,0.00260178018525613,0.00255270912913545,0.00242728845484168,0.00255047799890619,0.0024023999960699,0.0032070453545894,0.00267241399862294,0.00242702990950661,0.00251153780669105,0.0026210891930403,0.00273879030336155,0.00235256041947059,0.00254722902290516,0.00278082501489266,0.00256962591534131,0.002414904015421,0.00246373107322506,0.00280008079935296,0.00242375713167129],"mode":"markers+lines","name":"train","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.103379413761603,0.0345576634255933,0.0405262089572354,0.019107735693425,0.0176283119668539,0.012308374905511,0.0272730647090174,0.014586105597018,0.0112987580051164,0.00824788757495329,0.00626144217217259,0.0213547471039807,0.0151008854447366,0.00957033077909152,0.00677094044058497,0.00596610349629472,0.00580196084806304,0.00875128919848713,0.00640605077543884,0.00537079645996634,0.00609208627005781,0.0052441117857607,0.00428946501618147,0.0175412612338432,0.0144255773577152,0.00914296783791096,0.00708454046083358,0.00658431951745033,0.00911238689225295,0.0084076117115865,0.0168305539683407,0.0118615192921289,0.00725604820536767,0.00639885058491093,0.00576214354555573,0.00544605087124737,0.00776012272761224,0.00954323357207289,0.0129106675216986,0.00828474609846426,0.00739635951432649,0.00763062186124626,0.00667598163241417,0.00714311723322014,0.00703205170302605,0.0161652359820588,0.0111008757131109,0.0085176435053528,0.00648804654313075,0.00458916225038897,0.00520980593601623,0.00599619798453482,0.00604807050887057,0.0128224743108053,0.012713016310294,0.00959400275224314,0.00659561257770602,0.00659972148716939,0.00612297674449469,0.00563419307209279,0.00433015103665011,0.00421278771122113,0.00563505725886809,0.00643498064279789,0.0055805508615076,0.00442844101744375,0.00376748524539501,0.00423725025252619,0.00380025297060338,0.00388157119733039,0.00463110412213229,0.00731295684830859,0.0059518048327253,0.00459575399135305,0.00375995902472061,0.00335401693917368,0.0028658953891434,0.00285657947134141,0.00361933282576336,0.00345091341844177,0.00476413096329958,0.00605920637763537,0.00484118224875894,0.00364485942390782,0.00320688240020934,0.00328144357399639,0.00316501752531244,0.00340038695799755,0.00440217293525592,0.00435930165309912,0.00386775730247279,0.00312195032068783,0.00285358390514409,0.0105195506975303,0.0104980905488892,0.00748396019896022,0.00566714807364153,0.00445296871632937,0.00474506782373055,0.00489382294369737,0.00467087381465946,0.00692102143056526,0.009582879643441,0.00597793299518298,0.00434825730571677,0.00383820726425951,0.00404267168069318,0.00386667954223437,0.00438106999394777,0.00521454442950843,0.00427810571631611,0.00385369712095468,0.00459941326155277,0.0109158739019637,0.00814130112044733,0.00559918237319053,0.00476927521058012,0.0046601727548546,0.00346530627197426,0.00288603047045245,0.00339136674513063,0.00419163437645019,0.00455932552766356,0.00387008251483246,0.00529200809013135,0.00730890427338462,0.00422768977831926,0.00386829038998395,0.00398219041393815,0.00327025204057127,0.00323804900154075,0.00250841526027654,0.00355251787407022,0.00441835882580797,0.00666218296944799,0.00597644575825503,0.00416388300762512,0.00319046406992581,0.00279261934824564,0.00300145013023378,0.00297894210929794,0.00341859853494178,0.00409772012591498,0.00368136161606118,0.00429609408918313,0.00245657890022968,0.00266976818266728,0.00472556618398019,0.00371476959082978,0.00290016632661364,0.00262103780946511,0.00227956611433306,0.00223974783112733,0.00224316157785471,0.00337342537916769,0.00372343593681819,0.00362637887169552,0.00273294135715678,0.00235227464899381,0.00254428863523878,0.00298437608586531,0.00251749535799491,0.00259367634995376,0.0024174150545303,0.00238697100380923,0.00200424226392354,0.00261406670032898,0.00326773827494092,0.00464861041098963,0.00368182550686718,0.00340203561548703,0.00291901411046921,0.00260341650953424,0.00226661085273471,0.00280616370673492,0.00253240483006633,0.00229866134722568,0.002098472226702,0.00222896707248276,0.00449894589580006,0.00289498802850714,0.00229556839984285,0.00244841685614718,0.00225709655545498,0.00223728151249622,0.00217892973960867,0.00208184738449545,0.00398256212661768,0.00370789248223021,0.00280662066411437,0.00243692584469453,0.00267832355021858,0.00218421238074854,0.00215409581898273,0.00234032574442418,0.00301346268473546,0.00224465052889003,0.00221869289912101,0.00263589056589182,0.00229557819565083,0.0021070845162025,0.00220284405121448,0.00344173776049742,0.00310353406671931,0.00235765154598913,0.00243410357292855,0.00222453525239734,0.00191548536989025,0.00229323166066241,0.00277631085185879,0.0025633519255498,0.00289185766107628,0.00224453645781818,0.00285386695767033,0.00252628856448636,0.00225160131029263,0.0020515993830817,0.00212334390291236,0.00274993214966097,0.0024693891629667,0.00217718220796148,0.00222396390145799,0.00242377013099358,0.00219783180013462,0.00205817175213448,0.00287070768060947,0.00275613361304712,0.00216768930444813,0.00210046206980817,0.0019583232028081,0.00224766106495403,0.00217253453506383,0.00264623995056752,0.00225570026381441,0.00219108672518958,0.00251675415632747,0.0022649341716674,0.00193694134117827,0.00212570276874084,0.00254496697659774,0.00236900315850428,0.00198216102266561,0.00205979579346857,0.00236479098232174,0.00223128798861017,0.00192149356781313,0.00184393487066878,0.00272243329709547,0.00250283455906089,0.00191833424916089],"mode":"markers+lines","name":"eval","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>internals &lt;- model$symbol$get.internals()
sym_state &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state&quot;))
sym_state_cell &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state_cell&quot;))
sym_output &lt;- internals$get.output(which(internals$outputs %in% &quot;loss_output&quot;))
symbol &lt;- mx.symbol.Group(sym_output, sym_state, sym_state_cell)

pred_length = 100
predict &lt;- numeric()

data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

infer.data &lt;- mx.io.arrayiter(data = data, label = label, 
                              batch.size = 1, shuffle = FALSE)

mx.symbol.bind &lt;- mxnet:::mx.symbol.bind
infer &lt;- mxnet:::mx.infer.buckets.one(infer.data = infer.data, 
                              symbol = symbol,
                              arg.params = model$arg.params, 
                              aux.params = model$aux.params, 
                              input.params = NULL,
                              ctx = ctx)

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  label = pred
  
  infer.data &lt;- mx.io.arrayiter(data = data, label = label,  
                                batch.size = 1, shuffle = FALSE)
  
  infer &lt;- mxnet:::mx.infer.buckets.one(infer.data = infer.data, 
                                symbol = symbol,
                                ctx = ctx,
                                arg.params = model$arg.params,
                                aux.params = model$aux.params,
                                input.params = list(rnn.state = infer[[2]], 
                                                    rnn.state.cell = infer[[3]]))
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
  
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)</code></pre>
<div id="2a714b5c09be" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="2a714b5c09be">{"x":{"visdat":{"2a7161094224":["function () ","plotlyVisDat"]},"cur_data":"2a7161094224","attrs":{"2a7161094224":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864767,0.654558643840493,0.436584993947793,0.188858798208366,-0.0717378125250393,-0.327445609887204,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208366,0.0717378125250392,0.327445609887204,0.560838530065012,0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864768,0.654558643840493,0.436584993947793,0.188858798208367,-0.0717378125250382,-0.327445609887203,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208367,0.0717378125250381,0.327445609887203,0.560838530065012,0.756011231248382,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840493,0.436584993947794,0.188858798208368,-0.0717378125250379,-0.327445609887203,-0.560838530065009,-0.756011231248381,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864769,-0.654558643840493,-0.436584993947795,-0.188858798208368,0.071737812525036,0.327445609887203,0.560838530065012,0.756011231248381,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840494,0.436584993947795,0.188858798208368,-0.0717378125250359,-0.327445609887202,-0.560838530065012,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947796,-0.188858798208368,0.0717378125250358,0.327445609887202,0.560838530065011,0.75601123124838,0.899663016389806,0.982004253727697,0.997423524012805],"mode":"lines","name":"hist","alpha":1,"sizes":[10,100],"type":"scatter"},"2a7161094224.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.94487002945675,0.827925203864769,0.654558643840494,0.436584993947796,0.188858798208368,-0.0717378125250357,-0.327445609887202,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840496,-0.436584993947796,-0.188858798208368,0.0717378125250356,0.327445609887202,0.560838530065005,0.756011231248383,0.899663016389805,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864771,0.654558643840497,0.436584993947796,0.188858798208368,-0.071737812525039,-0.327445609887199,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947799,-0.188858798208372,0.0717378125250353,0.327445609887202,0.560838530065011,0.756011231248378,0.899663016389804,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864771,0.654558643840497,0.436584993947796,0.188858798208368,-0.0717378125250387,-0.327445609887198,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727696,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947799,-0.188858798208372,0.0717378125250351,0.327445609887202,0.560838530065011,0.756011231248378,0.899663016389804,0.982004253727696,0.997423524012805,0.944870029456749,0.827925203864771,0.654558643840497,0.436584993947796,0.188858798208369,-0.0717378125250314,-0.327445609887198,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727696,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.4365849939478,-0.188858798208372,0.0717378125250348,0.327445609887201,0.560838530065011,0.756011231248377,0.899663016389804,0.982004253727696,0.997423524012805,0.944870029456751,0.827925203864771,0.654558643840497,0.436584993947796],"mode":"lines","name":"real","alpha":1,"sizes":[10,100],"type":"scatter"},"2a7161094224.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.955447137355804,0.861835598945618,0.723084688186646,0.543560683727264,0.335919171571732,0.120607160031796,-0.0903572738170624,-0.297600865364075,-0.495927155017853,-0.66586297750473,-0.798660159111023,-0.889235138893127,-0.922035455703735,-0.886652648448944,-0.782804906368256,-0.613986372947693,-0.38902485370636,-0.127250641584396,0.153463006019592,0.428158015012741,0.662709951400757,0.846363246440887,0.969270288944244,1.0208215713501,1.00425624847412,0.932103216648102,0.814504384994507,0.655604422092438,0.461210608482361,0.247802212834358,0.0337472856044769,-0.175290808081627,-0.380639672279358,-0.569670140743256,-0.724611282348633,-0.841514348983765,-0.910487115383148,-0.916015565395355,-0.852387011051178,-0.721489250659943,-0.52805632352829,-0.285460144281387,-0.0140899382531643,0.268517971038818,0.529800832271576,0.744094789028168,0.904682219028473,0.999086141586304,1.02164959907532,0.980802118778229,0.889268636703491,0.754496812820435,0.579884886741638,0.375208675861359,0.159860774874687,-0.0520203039050102,-0.259769350290298,-0.461043447256088,-0.637422442436218,-0.777124166488647,-0.876442611217499,-0.920994162559509,-0.898377895355225,-0.806903481483459,-0.649649083614349,-0.433803290128708,-0.177240803837776,0.101232163608074,0.37991389632225,0.62330025434494,0.816721558570862,0.951866090297699,1.01674628257751,1.01187014579773,0.948986411094666,0.839297592639923,0.687773942947388,0.499003022909164,0.287508457899094,0.0726935788989067,-0.137100845575333,-0.343463242053986,-0.537156045436859,-0.698926270008087,-0.823126137256622,-0.90219783782959,-0.920168459415436,-0.869229316711426,-0.750442981719971,-0.567885339260101,-0.332773357629776,-0.0654140561819077,0.216950088739395,0.484983086585999,0.708475649356842,0.879726350307465,0.987163960933685,1.02264499664307,0.992451310157776,0.909467339515686],"mode":"lines","name":"pred","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864767,0.654558643840493,0.436584993947793,0.188858798208366,-0.0717378125250393,-0.327445609887204,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208366,0.0717378125250392,0.327445609887204,0.560838530065012,0.756011231248382,0.899663016389807,0.982004253727697,0.997423524012805,0.944870029456748,0.827925203864768,0.654558643840493,0.436584993947793,0.188858798208367,-0.0717378125250382,-0.327445609887203,-0.560838530065012,-0.756011231248382,-0.899663016389807,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864767,-0.654558643840493,-0.436584993947793,-0.188858798208367,0.0717378125250381,0.327445609887203,0.560838530065012,0.756011231248382,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840493,0.436584993947794,0.188858798208368,-0.0717378125250379,-0.327445609887203,-0.560838530065009,-0.756011231248381,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.944870029456749,-0.827925203864769,-0.654558643840493,-0.436584993947795,-0.188858798208368,0.071737812525036,0.327445609887203,0.560838530065012,0.756011231248381,0.899663016389806,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864769,0.654558643840494,0.436584993947795,0.188858798208368,-0.0717378125250359,-0.327445609887202,-0.560838530065012,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947796,-0.188858798208368,0.0717378125250358,0.327445609887202,0.560838530065011,0.75601123124838,0.899663016389806,0.982004253727697,0.997423524012805],"mode":"lines","name":"hist","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.94487002945675,0.827925203864769,0.654558643840494,0.436584993947796,0.188858798208368,-0.0717378125250357,-0.327445609887202,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840496,-0.436584993947796,-0.188858798208368,0.0717378125250356,0.327445609887202,0.560838530065005,0.756011231248383,0.899663016389805,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864771,0.654558643840497,0.436584993947796,0.188858798208368,-0.071737812525039,-0.327445609887199,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727697,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947799,-0.188858798208372,0.0717378125250353,0.327445609887202,0.560838530065011,0.756011231248378,0.899663016389804,0.982004253727697,0.997423524012805,0.944870029456749,0.827925203864771,0.654558643840497,0.436584993947796,0.188858798208368,-0.0717378125250387,-0.327445609887198,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727696,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.436584993947799,-0.188858798208372,0.0717378125250351,0.327445609887202,0.560838530065011,0.756011231248378,0.899663016389804,0.982004253727696,0.997423524012805,0.944870029456749,0.827925203864771,0.654558643840497,0.436584993947796,0.188858798208369,-0.0717378125250314,-0.327445609887198,-0.560838530065008,-0.75601123124838,-0.899663016389806,-0.982004253727696,-0.997423524012805,-0.94487002945675,-0.827925203864769,-0.654558643840494,-0.4365849939478,-0.188858798208372,0.0717378125250348,0.327445609887201,0.560838530065011,0.756011231248377,0.899663016389804,0.982004253727696,0.997423524012805,0.944870029456751,0.827925203864771,0.654558643840497,0.436584993947796],"mode":"lines","name":"real","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.955447137355804,0.861835598945618,0.723084688186646,0.543560683727264,0.335919171571732,0.120607160031796,-0.0903572738170624,-0.297600865364075,-0.495927155017853,-0.66586297750473,-0.798660159111023,-0.889235138893127,-0.922035455703735,-0.886652648448944,-0.782804906368256,-0.613986372947693,-0.38902485370636,-0.127250641584396,0.153463006019592,0.428158015012741,0.662709951400757,0.846363246440887,0.969270288944244,1.0208215713501,1.00425624847412,0.932103216648102,0.814504384994507,0.655604422092438,0.461210608482361,0.247802212834358,0.0337472856044769,-0.175290808081627,-0.380639672279358,-0.569670140743256,-0.724611282348633,-0.841514348983765,-0.910487115383148,-0.916015565395355,-0.852387011051178,-0.721489250659943,-0.52805632352829,-0.285460144281387,-0.0140899382531643,0.268517971038818,0.529800832271576,0.744094789028168,0.904682219028473,0.999086141586304,1.02164959907532,0.980802118778229,0.889268636703491,0.754496812820435,0.579884886741638,0.375208675861359,0.159860774874687,-0.0520203039050102,-0.259769350290298,-0.461043447256088,-0.637422442436218,-0.777124166488647,-0.876442611217499,-0.920994162559509,-0.898377895355225,-0.806903481483459,-0.649649083614349,-0.433803290128708,-0.177240803837776,0.101232163608074,0.37991389632225,0.62330025434494,0.816721558570862,0.951866090297699,1.01674628257751,1.01187014579773,0.948986411094666,0.839297592639923,0.687773942947388,0.499003022909164,0.287508457899094,0.0726935788989067,-0.137100845575333,-0.343463242053986,-0.537156045436859,-0.698926270008087,-0.823126137256622,-0.90219783782959,-0.920168459415436,-0.869229316711426,-0.750442981719971,-0.567885339260101,-0.332773357629776,-0.0654140561819077,0.216950088739395,0.484983086585999,0.708475649356842,0.879726350307465,0.987163960933685,1.02264499664307,0.992451310157776,0.909467339515686],"mode":"lines","name":"pred","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
