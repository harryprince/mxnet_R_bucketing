<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-0.9.2/grViz.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET R</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU">GPU</a></li>
        <li><a href="TimeSeries_CPU">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="CNN_NLP_classification_kaggle.html">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<pre class="r"><code>seq_len = 100
samples = 192

seeds &lt;- runif(samples, min = -pi, max = pi)
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, samples))
y &lt;- pts[-1, ]

p1 = plot_ly(x = 1:dim(x)[2], y = x[1,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p2 = plot_ly(x = 1:length(y[,1]), y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;%
  add_trace(x = 1:length(y[,2]), y = y[,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p1</code></pre>
<div id="3c3026acf67a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="3c3026acf67a">{"x":{"visdat":{"3c303d921db6":["function () ","plotlyVisDat"]},"cur_data":"3c303d921db6","attrs":{"3c303d921db6":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.682539579359456,0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802658,0.529291326391727,0.291663691782474,0.034159658575285,-0.225672298912304,-0.470125062170127,-0.682539579359456,-0.848440152165423,-0.956520930714962,-0.999416388561855,-0.974203271141929,-0.882599810740708,-0.730848631802658,-0.529291326391728,-0.291663691782475,-0.0341596585752847,0.225672298912304,0.470125062170127,0.682539579359455,0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802659,0.529291326391728,0.291663691782475,0.0341596585752866,-0.225672298912303,-0.470125062170126,-0.682539579359455,-0.848440152165422,-0.956520930714962,-0.999416388561855,-0.97420327114193,-0.882599810740709,-0.730848631802659,-0.529291326391728,-0.291663691782475,-0.0341596585752867,0.225672298912302,0.470125062170125,0.682539579359455,0.848440152165422,0.956520930714962,0.999416388561855,0.97420327114193,0.882599810740709,0.73084863180266,0.529291326391728,0.291663691782475,0.0341596585752869,-0.225672298912302,-0.470125062170125,-0.682539579359455,-0.848440152165423,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.882599810740708,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.034159658575287,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854,0.97420327114193,0.882599810740708,0.73084863180266,0.529291326391728,0.291663691782477,0.0341596585752871,-0.2256722989123,-0.470125062170125,-0.682539579359455,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.88259981074071,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.0341596585752872,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"3c303d921db6.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.338482748666953,-0.570490857789533,-0.763620957734474,-0.904711551353111,-0.984147547853562,-0.996515515348514,-0.940972597292219,-0.8213039517612,-0.645664799186609,-0.426024657558982,-0.177351639557745,0.0834075995919109,0.338482748666953,0.570490857789532,0.763620957734474,0.904711551353111,0.984147547853562,0.996515515348515,0.940972597292219,0.8213039517612,0.64566479918661,0.426024657558982,0.177351639557745,-0.0834075995919103,-0.338482748666953,-0.570490857789532,-0.763620957734474,-0.904711551353111,-0.984147547853562,-0.996515515348515,-0.940972597292219,-0.8213039517612,-0.645664799186609,-0.426024657558982,-0.177351639557745,0.0834075995919097,0.338482748666953,0.570490857789533,0.763620957734474,0.90471155135311,0.984147547853562,0.996515515348515,0.940972597292219,0.8213039517612,0.645664799186609,0.426024657558982,0.177351639557746,-0.0834075995919096,-0.338482748666953,-0.570490857789533,-0.763620957734474,-0.90471155135311,-0.984147547853562,-0.996515515348515,-0.940972597292219,-0.8213039517612,-0.64566479918661,-0.426024657558983,-0.177351639557746,0.0834075995919095,0.338482748666952,0.570490857789532,0.763620957734474,0.90471155135311,0.984147547853562,0.996515515348514,0.940972597292219,0.8213039517612,0.645664799186611,0.426024657558983,0.177351639557748,-0.0834075995919094,-0.338482748666951,-0.570490857789529,-0.763620957734473,-0.904711551353109,-0.984147547853562,-0.996515515348515,-0.94097259729222,-0.821303951761201,-0.645664799186612,-0.426024657558984,-0.177351639557749,0.0834075995919075,0.338482748666951,0.570490857789529,0.763620957734473,0.904711551353109,0.984147547853562,0.996515515348515,0.94097259729222,0.821303951761201,0.645664799186613,0.426024657558984,0.17735163955775,-0.0834075995919074,-0.338482748666951,-0.570490857789529,-0.763620957734472,-0.904711551353109],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"3c303d921db6.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.152840920185394,-0.403411121731699,-0.626489522000388,-0.806873696667639,-0.932270762328819,-0.99413511618757,-0.988250804764095,-0.915018834157621,-0.779429842143425,-0.590723994455871,-0.361761282763707,-0.108145137489983,0.152840920185394,0.403411121731699,0.626489522000388,0.806873696667638,0.932270762328819,0.99413511618757,0.988250804764095,0.915018834157621,0.779429842143426,0.590723994455871,0.361761282763707,0.108145137489984,-0.152840920185394,-0.403411121731698,-0.626489522000388,-0.806873696667638,-0.932270762328819,-0.99413511618757,-0.988250804764095,-0.915018834157622,-0.779429842143426,-0.590723994455872,-0.361761282763709,-0.108145137489985,0.152840920185393,0.403411121731698,0.626489522000387,0.806873696667638,0.932270762328818,0.994135116187569,0.988250804764095,0.915018834157622,0.779429842143426,0.590723994455872,0.361761282763709,0.108145137489985,-0.152840920185393,-0.403411121731698,-0.626489522000387,-0.806873696667637,-0.932270762328818,-0.994135116187569,-0.988250804764096,-0.915018834157622,-0.779429842143426,-0.590723994455872,-0.361761282763709,-0.108145137489985,0.152840920185391,0.403411121731698,0.626489522000387,0.806873696667636,0.932270762328818,0.99413511618757,0.988250804764096,0.915018834157622,0.779429842143427,0.590723994455872,0.361761282763711,0.108145137489985,-0.152840920185393,-0.403411121731696,-0.626489522000387,-0.806873696667636,-0.932270762328818,-0.99413511618757,-0.988250804764096,-0.915018834157622,-0.779429842143427,-0.590723994455873,-0.361761282763711,-0.108145137489985,0.152840920185393,0.403411121731696,0.626489522000387,0.806873696667636,0.932270762328818,0.994135116187569,0.988250804764096,0.915018834157622,0.779429842143427,0.590723994455873,0.361761282763711,0.108145137489986,-0.152840920185392,-0.403411121731696,-0.626489522000387,-0.806873696667636],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"3c303d921db6.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.558034879202304,0.324247730346916,0.0683636345130955,-0.192179330036545,-0.439625590835554,-0.657112094134759,-0.829817494147761,-0.945972203272841,-0.997660470037858,-0.981359824481675,-0.898181128660857,-0.753792873236296,-0.558034879202304,-0.324247730346916,-0.0683636345130961,0.192179330036544,0.439625590835553,0.657112094134759,0.829817494147761,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660856,0.753792873236297,0.558034879202304,0.324247730346916,0.0683636345130962,-0.192179330036544,-0.439625590835553,-0.657112094134759,-0.82981749414776,-0.945972203272841,-0.997660470037858,-0.981359824481676,-0.898181128660857,-0.753792873236298,-0.558034879202305,-0.324247730346917,-0.0683636345130963,0.192179330036544,0.439625590835552,0.657112094134758,0.829817494147761,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660857,0.753792873236298,0.558034879202305,0.324247730346917,0.0683636345130965,-0.192179330036544,-0.439625590835552,-0.657112094134757,-0.82981749414776,-0.945972203272841,-0.997660470037858,-0.981359824481676,-0.898181128660858,-0.753792873236298,-0.558034879202305,-0.324247730346915,-0.0683636345130966,0.192179330036542,0.439625590835552,0.657112094134759,0.82981749414776,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660858,0.753792873236298,0.558034879202305,0.324247730346919,0.0683636345130967,-0.192179330036542,-0.439625590835552,-0.657112094134759,-0.82981749414776,-0.945972203272841,-0.997660470037858,-0.981359824481676,-0.898181128660858,-0.753792873236298,-0.558034879202305,-0.324247730346919,-0.0683636345130968,0.192179330036541,0.439625590835552,0.657112094134756,0.82981749414776,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660858,0.753792873236298,0.558034879202305,0.324247730346919,0.0683636345130969,-0.192179330036541],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"3c303d921db6.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.129349244828395,0.131702955701039,0.383779817448872,0.6097027188637,0.79407538756935,0.924333130883773,0.99159909886119,0.991289226946208,0.923424632397745,0.792630175182734,0.607819281412318,0.381586508082508,0.129349244828395,-0.131702955701038,-0.383779817448871,-0.609702718863699,-0.794075387569349,-0.924333130883772,-0.99159909886119,-0.991289226946208,-0.923424632397745,-0.792630175182735,-0.607819281412319,-0.381586508082509,-0.129349244828395,0.131702955701038,0.383779817448871,0.609702718863699,0.794075387569349,0.924333130883772,0.99159909886119,0.991289226946208,0.923424632397745,0.792630175182735,0.607819281412319,0.381586508082509,0.129349244828395,-0.131702955701038,-0.383779817448871,-0.609702718863699,-0.794075387569349,-0.924333130883772,-0.99159909886119,-0.991289226946208,-0.923424632397745,-0.792630175182735,-0.607819281412319,-0.381586508082509,-0.129349244828395,0.131702955701038,0.383779817448871,0.609702718863699,0.794075387569349,0.924333130883772,0.99159909886119,0.991289226946208,0.923424632397745,0.792630175182735,0.607819281412319,0.381586508082509,0.129349244828397,-0.131702955701038,-0.383779817448871,-0.609702718863698,-0.794075387569349,-0.924333130883773,-0.99159909886119,-0.991289226946208,-0.923424632397746,-0.792630175182735,-0.607819281412321,-0.38158650808251,-0.129349244828396,0.131702955701036,0.383779817448871,0.609702718863698,0.794075387569349,0.924333130883773,0.99159909886119,0.991289226946208,0.923424632397746,0.792630175182735,0.607819281412321,0.38158650808251,0.129349244828396,-0.131702955701036,-0.383779817448871,-0.609702718863697,-0.794075387569349,-0.924333130883772,-0.99159909886119,-0.991289226946208,-0.923424632397746,-0.792630175182735,-0.607819281412321,-0.38158650808251,-0.129349244828396,0.131702955701036,0.383779817448871,0.609702718863697],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.682539579359456,0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802658,0.529291326391727,0.291663691782474,0.034159658575285,-0.225672298912304,-0.470125062170127,-0.682539579359456,-0.848440152165423,-0.956520930714962,-0.999416388561855,-0.974203271141929,-0.882599810740708,-0.730848631802658,-0.529291326391728,-0.291663691782475,-0.0341596585752847,0.225672298912304,0.470125062170127,0.682539579359455,0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802659,0.529291326391728,0.291663691782475,0.0341596585752866,-0.225672298912303,-0.470125062170126,-0.682539579359455,-0.848440152165422,-0.956520930714962,-0.999416388561855,-0.97420327114193,-0.882599810740709,-0.730848631802659,-0.529291326391728,-0.291663691782475,-0.0341596585752867,0.225672298912302,0.470125062170125,0.682539579359455,0.848440152165422,0.956520930714962,0.999416388561855,0.97420327114193,0.882599810740709,0.73084863180266,0.529291326391728,0.291663691782475,0.0341596585752869,-0.225672298912302,-0.470125062170125,-0.682539579359455,-0.848440152165423,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.882599810740708,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.034159658575287,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854,0.97420327114193,0.882599810740708,0.73084863180266,0.529291326391728,0.291663691782477,0.0341596585752871,-0.2256722989123,-0.470125062170125,-0.682539579359455,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.88259981074071,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.0341596585752872,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.338482748666953,-0.570490857789533,-0.763620957734474,-0.904711551353111,-0.984147547853562,-0.996515515348514,-0.940972597292219,-0.8213039517612,-0.645664799186609,-0.426024657558982,-0.177351639557745,0.0834075995919109,0.338482748666953,0.570490857789532,0.763620957734474,0.904711551353111,0.984147547853562,0.996515515348515,0.940972597292219,0.8213039517612,0.64566479918661,0.426024657558982,0.177351639557745,-0.0834075995919103,-0.338482748666953,-0.570490857789532,-0.763620957734474,-0.904711551353111,-0.984147547853562,-0.996515515348515,-0.940972597292219,-0.8213039517612,-0.645664799186609,-0.426024657558982,-0.177351639557745,0.0834075995919097,0.338482748666953,0.570490857789533,0.763620957734474,0.90471155135311,0.984147547853562,0.996515515348515,0.940972597292219,0.8213039517612,0.645664799186609,0.426024657558982,0.177351639557746,-0.0834075995919096,-0.338482748666953,-0.570490857789533,-0.763620957734474,-0.90471155135311,-0.984147547853562,-0.996515515348515,-0.940972597292219,-0.8213039517612,-0.64566479918661,-0.426024657558983,-0.177351639557746,0.0834075995919095,0.338482748666952,0.570490857789532,0.763620957734474,0.90471155135311,0.984147547853562,0.996515515348514,0.940972597292219,0.8213039517612,0.645664799186611,0.426024657558983,0.177351639557748,-0.0834075995919094,-0.338482748666951,-0.570490857789529,-0.763620957734473,-0.904711551353109,-0.984147547853562,-0.996515515348515,-0.94097259729222,-0.821303951761201,-0.645664799186612,-0.426024657558984,-0.177351639557749,0.0834075995919075,0.338482748666951,0.570490857789529,0.763620957734473,0.904711551353109,0.984147547853562,0.996515515348515,0.94097259729222,0.821303951761201,0.645664799186613,0.426024657558984,0.17735163955775,-0.0834075995919074,-0.338482748666951,-0.570490857789529,-0.763620957734472,-0.904711551353109],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.152840920185394,-0.403411121731699,-0.626489522000388,-0.806873696667639,-0.932270762328819,-0.99413511618757,-0.988250804764095,-0.915018834157621,-0.779429842143425,-0.590723994455871,-0.361761282763707,-0.108145137489983,0.152840920185394,0.403411121731699,0.626489522000388,0.806873696667638,0.932270762328819,0.99413511618757,0.988250804764095,0.915018834157621,0.779429842143426,0.590723994455871,0.361761282763707,0.108145137489984,-0.152840920185394,-0.403411121731698,-0.626489522000388,-0.806873696667638,-0.932270762328819,-0.99413511618757,-0.988250804764095,-0.915018834157622,-0.779429842143426,-0.590723994455872,-0.361761282763709,-0.108145137489985,0.152840920185393,0.403411121731698,0.626489522000387,0.806873696667638,0.932270762328818,0.994135116187569,0.988250804764095,0.915018834157622,0.779429842143426,0.590723994455872,0.361761282763709,0.108145137489985,-0.152840920185393,-0.403411121731698,-0.626489522000387,-0.806873696667637,-0.932270762328818,-0.994135116187569,-0.988250804764096,-0.915018834157622,-0.779429842143426,-0.590723994455872,-0.361761282763709,-0.108145137489985,0.152840920185391,0.403411121731698,0.626489522000387,0.806873696667636,0.932270762328818,0.99413511618757,0.988250804764096,0.915018834157622,0.779429842143427,0.590723994455872,0.361761282763711,0.108145137489985,-0.152840920185393,-0.403411121731696,-0.626489522000387,-0.806873696667636,-0.932270762328818,-0.99413511618757,-0.988250804764096,-0.915018834157622,-0.779429842143427,-0.590723994455873,-0.361761282763711,-0.108145137489985,0.152840920185393,0.403411121731696,0.626489522000387,0.806873696667636,0.932270762328818,0.994135116187569,0.988250804764096,0.915018834157622,0.779429842143427,0.590723994455873,0.361761282763711,0.108145137489986,-0.152840920185392,-0.403411121731696,-0.626489522000387,-0.806873696667636],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.558034879202304,0.324247730346916,0.0683636345130955,-0.192179330036545,-0.439625590835554,-0.657112094134759,-0.829817494147761,-0.945972203272841,-0.997660470037858,-0.981359824481675,-0.898181128660857,-0.753792873236296,-0.558034879202304,-0.324247730346916,-0.0683636345130961,0.192179330036544,0.439625590835553,0.657112094134759,0.829817494147761,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660856,0.753792873236297,0.558034879202304,0.324247730346916,0.0683636345130962,-0.192179330036544,-0.439625590835553,-0.657112094134759,-0.82981749414776,-0.945972203272841,-0.997660470037858,-0.981359824481676,-0.898181128660857,-0.753792873236298,-0.558034879202305,-0.324247730346917,-0.0683636345130963,0.192179330036544,0.439625590835552,0.657112094134758,0.829817494147761,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660857,0.753792873236298,0.558034879202305,0.324247730346917,0.0683636345130965,-0.192179330036544,-0.439625590835552,-0.657112094134757,-0.82981749414776,-0.945972203272841,-0.997660470037858,-0.981359824481676,-0.898181128660858,-0.753792873236298,-0.558034879202305,-0.324247730346915,-0.0683636345130966,0.192179330036542,0.439625590835552,0.657112094134759,0.82981749414776,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660858,0.753792873236298,0.558034879202305,0.324247730346919,0.0683636345130967,-0.192179330036542,-0.439625590835552,-0.657112094134759,-0.82981749414776,-0.945972203272841,-0.997660470037858,-0.981359824481676,-0.898181128660858,-0.753792873236298,-0.558034879202305,-0.324247730346919,-0.0683636345130968,0.192179330036541,0.439625590835552,0.657112094134756,0.82981749414776,0.945972203272841,0.997660470037858,0.981359824481676,0.898181128660858,0.753792873236298,0.558034879202305,0.324247730346919,0.0683636345130969,-0.192179330036541],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.129349244828395,0.131702955701039,0.383779817448872,0.6097027188637,0.79407538756935,0.924333130883773,0.99159909886119,0.991289226946208,0.923424632397745,0.792630175182734,0.607819281412318,0.381586508082508,0.129349244828395,-0.131702955701038,-0.383779817448871,-0.609702718863699,-0.794075387569349,-0.924333130883772,-0.99159909886119,-0.991289226946208,-0.923424632397745,-0.792630175182735,-0.607819281412319,-0.381586508082509,-0.129349244828395,0.131702955701038,0.383779817448871,0.609702718863699,0.794075387569349,0.924333130883772,0.99159909886119,0.991289226946208,0.923424632397745,0.792630175182735,0.607819281412319,0.381586508082509,0.129349244828395,-0.131702955701038,-0.383779817448871,-0.609702718863699,-0.794075387569349,-0.924333130883772,-0.99159909886119,-0.991289226946208,-0.923424632397745,-0.792630175182735,-0.607819281412319,-0.381586508082509,-0.129349244828395,0.131702955701038,0.383779817448871,0.609702718863699,0.794075387569349,0.924333130883772,0.99159909886119,0.991289226946208,0.923424632397745,0.792630175182735,0.607819281412319,0.381586508082509,0.129349244828397,-0.131702955701038,-0.383779817448871,-0.609702718863698,-0.794075387569349,-0.924333130883773,-0.99159909886119,-0.991289226946208,-0.923424632397746,-0.792630175182735,-0.607819281412321,-0.38158650808251,-0.129349244828396,0.131702955701036,0.383779817448871,0.609702718863698,0.794075387569349,0.924333130883773,0.99159909886119,0.991289226946208,0.923424632397746,0.792630175182735,0.607819281412321,0.38158650808251,0.129349244828396,-0.131702955701036,-0.383779817448871,-0.609702718863697,-0.794075387569349,-0.924333130883772,-0.99159909886119,-0.991289226946208,-0.923424632397746,-0.792630175182735,-0.607819281412321,-0.38158650808251,-0.129349244828396,0.131702955701036,0.383779817448871,0.609702718863697],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<p>Hacky array.iter approach: batch.size = seq.length so that the graph is fed with the expected format.</p>
<pre class="r"><code>batch.size = 16

train.data &lt;- mx.io.arrayiter(data = x[,,1:160, drop = F], label = y[, 1:160], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-(1:160), drop = F], label = y[, -(1:160)], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph(num_rnn_layer =  2, 
                    num_hidden = 50,
                    input_size = NULL,
                    num_embed = NULL, 
                    num_decode = 1,
                    masking = F, 
                    loss_output = &quot;linear&quot;,
                    dropout = 0.2, 
                    ignore_label = -1,
                    cell_type = &quot;lstm&quot;,
                    output_last_state = T,
                    config = &quot;one-to-one&quot;)

graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;LR&quot;, 
          shape=list(data = c(1, seq_len, batch.size), 
                     label = c(seq_len, batch.size)),
          graph.width.px = 800, graph.height.px = 220)</code></pre>
<div id="htmlwidget-5512f3a7dab4c027a9b4" style="width:800px;height:220px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-5512f3a7dab4c027a9b4">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"RNN\nRNN\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"5\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"7\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"8\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"9\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [id = \"1\", color = \"black\", fontcolor = \"black\", label = \"1X100X16\"] \n\"2\"->\"3\" [id = \"2\", color = \"black\", fontcolor = \"black\", label = \"1X16X100\"] \n\"3\"->\"4\" [id = \"3\", color = \"black\", fontcolor = \"black\", label = \"50X16X100\"] \n\"4\"->\"5\" [id = \"4\", color = \"black\", fontcolor = \"black\", label = \"50X16X100\"] \n\"5\"->\"6\" [id = \"5\", color = \"black\", fontcolor = \"black\", label = \"50X100X16\"] \n\"6\"->\"7\" [id = \"6\", color = \"black\", fontcolor = \"black\", label = \"50X1600\"] \n\"7\"->\"9\" [id = \"7\", color = \"black\", fontcolor = \"black\", label = \"1X1600\"] \n\"8\"->\"9\" [id = \"8\", color = \"black\", fontcolor = \"black\", label = \"1600\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;Perplexity&quot;, function(label, pred) {
  label = mx.nd.reshape(mx.nd.array(label), shape = -1)
  label = as.array(label)
  res &lt;- mean((label-pred)^2)
  return(res)
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.gpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 3)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.9, eps = 1e-5, wd = 1e-6,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 250, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
##  59.796   5.856  56.514</code></pre>
<pre class="r"><code>plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
        mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)</code></pre>
<div id="3c3051909df2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="3c3051909df2">{"x":{"visdat":{"3c304f0135b4":["function () ","plotlyVisDat"]},"cur_data":"3c304f0135b4","attrs":{"3c304f0135b4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.338335982722899,0.133229855147475,0.0668389462049779,0.0404788091346342,0.0389659437690661,0.0259521647185081,0.0227832731924101,0.0211564285311531,0.0197733374914958,0.0207519438670546,0.0322307083386029,0.0228800911106198,0.0197029446871944,0.0189086856099215,0.0190391215755415,0.0194162943165787,0.0222628562775728,0.0219863015753434,0.0179316464171653,0.0178510522280754,0.0171340316696026,0.0181974422554612,0.0147672873146245,0.0130544206186481,0.0241265393708487,0.017844979730641,0.0151246399255639,0.0140146372393326,0.0134827503031426,0.0159721660384548,0.016986276258261,0.0130814430069376,0.0110963900814024,0.0104819380378338,0.0140967936408125,0.013478385810295,0.0110580005210833,0.00995477215448839,0.00970817223906697,0.00849961527332187,0.0146157335600507,0.0129358140307418,0.0106548118103885,0.00951205128844324,0.00961623247413616,0.011272291777196,0.0104763893414292,0.00878448898075959,0.00845534786273521,0.00823548131434697,0.00789613074914606,0.00966419302818112,0.00892096390903237,0.00826193872842802,0.00838364355156851,0.00879715934902707,0.0082742862665001,0.00708078559272881,0.00781745279591555,0.00828717253850282,0.00728157517961464,0.0071228876219039,0.00768647257050061,0.00844731668375448,0.00744516372166355,0.00741277175778647,0.00683027712331906,0.00788494072905432,0.00716719481821006,0.00682230249768284,0.00760951401816307,0.00775720915109531,0.00735091338021311,0.00668978885819583,0.00659972503597396,0.00714348441943542,0.00623642679159887,0.00661829660825139,0.00711025489369346,0.0071722194797269,0.00618445090469043,0.00614370524205853,0.00566250335379992,0.00617789090829262,0.00595438780143551,0.00706301931254662,0.00647311930303762,0.00572838004264162,0.00620619874988079,0.00593119157146215,0.00597767591314464,0.00562522148596,0.00571380466527736,0.0060584690733436,0.00642596714620211,0.00721760308334038,0.00601905042845308,0.00595615977010006,0.00544119019827459,0.00622200784520742,0.00584804126688332,0.00522590120940751,0.00538910147561445,0.00566968760393348,0.00586420706810001,0.00562798149337159,0.00667368472085444,0.00615273162209371,0.00547034908799387,0.00522897403235113,0.00542801897720535,0.00551990620720568,0.00527666740171732,0.00565723278069821,0.00542266399846218,0.00550127883181814,0.0052122877440782,0.0048830804776265,0.00555286275604017,0.00510593231586289,0.00569620299925655,0.00522876624638681,0.00480817581005156,0.00511528105261455,0.00552191415579002,0.00540545199249777,0.00465781791863259,0.00506956608927984,0.00529712122992818,0.00541103703208924,0.00591511679797135,0.00531946693096172,0.00452766588163995,0.00475458510879593,0.00495734999092968,0.00509361704464405,0.00512516973847937,0.00486380286109868,0.0049003312610522,0.00483965280444329,0.00492208911636947,0.00504171577816818,0.00459307071240341,0.00527184631420351,0.0048663902088922,0.00452866570264431,0.00495009104468218,0.00495291446067908,0.00493737117420659,0.00455644808839946,0.00477413929446592,0.00477726491111324,0.00482370539418443,0.00508377474070275,0.00542533905646661,0.00463957586454663,0.00434046124469386,0.00439386647894362,0.00481194900357304,0.0047386298820665,0.00463982166171034,0.00480687164611052,0.00459740782760348,0.00418502277793067,0.00413734758249088,0.00459619210832256,0.00458661344323305,0.00497640797618646,0.00444322389312016,0.00454203643031034,0.00439054866007542,0.00454255316827866,0.00434250773086613,0.00460716311667457,0.00455320683203669,0.00424644851712485,0.00425106176298821,0.00457990696294104,0.00452688136160916,0.00459651420869416,0.00477723808767126,0.0045557149085572,0.00433061519221485,0.00414898498773571,0.00460154946888933,0.00420968745771667,0.00423371050418744,0.00433788200804076,0.00462304613662652,0.00452805910650265,0.00429693924197812,0.00452544097987943,0.00443148629719079,0.0045942655459523,0.00426037997952462,0.00427710751914094,0.00415640510365053,0.00446999767595558,0.00462582081913708,0.00422492638522699,0.00405585959497866,0.00430875755886265,0.00461723012395026,0.00484862208179578,0.00412310348084622,0.00405758273137349,0.00404726259578979,0.00453069505148083,0.0043965840061969,0.00426003650540206,0.00412626904655675,0.00420553335109328,0.00421123964258698,0.00403127111849377,0.00416669576927845,0.00480402029275332,0.00441266992466785,0.00441367030039039,0.00447227640362049,0.00440804025808547,0.00420155038403871,0.00419594472537401,0.00424842843164738,0.00426943189629699,0.00447183315912651,0.00433791361098603,0.00407684624274121,0.0042570502373368,0.00433307021526009,0.00431023731665816,0.00418906520494932,0.00423093390553362,0.0042648770509393,0.00435723717086601,0.00430927202592506,0.00411822513172398,0.0040337102218089,0.00418232932191815,0.00431491067873036,0.00435073620511907,0.00447178483092256,0.00432058526418845,0.00418726582732749,0.00411065172459496,0.00442059807463136,0.00424840676737388,0.00411253919318564,0.00421872810933023,0.00408255859722724,0.00416771250727788],"mode":"markers+lines","name":"train","alpha":1,"sizes":[10,100],"type":"scatter"},"3c304f0135b4.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.194680211549444,0.07651017237628,0.0157165238806937,0.0384378621071495,0.0183834221247358,0.0162274060682273,0.0143051321608791,0.0142775755510352,0.0129075263643381,0.0311621457303256,0.01523683991128,0.0126661200140758,0.0112708955951846,0.0121645386800118,0.0114686844415243,0.0123085571208697,0.0157561442348756,0.0133220538404273,0.0126308493216483,0.0121435316503536,0.0124638152915741,0.0119780810939091,0.0105141550579235,0.0323862102184174,0.0222439350326498,0.0152800050262032,0.0156107936662769,0.0130833299430143,0.0129439047826525,0.0262485007394142,0.0127542769632872,0.0107436778448534,0.00895040284271957,0.00987165438549309,0.0172602099313127,0.010766214601583,0.0107978046460716,0.00999592332167817,0.00890439554173166,0.00860168206841767,0.0105084304848114,0.00858978163899502,0.0075163682158979,0.00742433816109066,0.00778888345387353,0.00798357278142072,0.00665365288759783,0.00553510279008617,0.00570956116343504,0.00564443388850575,0.00535266958657516,0.00941814950003897,0.00767716762194978,0.00740061350442611,0.00666580406766673,0.00585948296893249,0.00534481459449373,0.00451384559313767,0.00810519964776461,0.00692424224687502,0.00608173482200236,0.0066849011983693,0.00613289889669176,0.00559234927126395,0.00520881916094398,0.0053399008849437,0.00560202808810814,0.00708785152143064,0.00635858543368961,0.00620206822469903,0.00571795268465054,0.00521207705643116,0.00516993280196409,0.00436090981833091,0.00700289041755268,0.00562598375902216,0.00544794401175299,0.00579686648301967,0.00538511087336522,0.00486630127955304,0.00453767949796872,0.00551305389314539,0.00520443241298575,0.00548334100226946,0.00515883392317257,0.00502764935818201,0.00451948586757793,0.00423461449049398,0.006047422946059,0.00451152385867028,0.0043316202480804,0.00429819299661552,0.00481778795163868,0.0043101559284861,0.00781769676327882,0.00597967936680881,0.0052370245654928,0.00546486060808398,0.00413462568736956,0.00477795271308869,0.00414500263326239,0.00505828496304757,0.00430965104187728,0.00451254784187176,0.00431151039743642,0.00491949987327682,0.00616290817157773,0.00520786038876165,0.00414439331160872,0.00420172596131979,0.00419797092421337,0.0049002377048496,0.00394060692104446,0.00442886966454973,0.00402236899959114,0.00490467462970987,0.00425033550256524,0.00387139762372957,0.0041304749126457,0.00449676840308715,0.00519854929740708,0.00384787469773047,0.00430461861855772,0.00463740681414426,0.004426763307039,0.00374438088440207,0.00409543052681202,0.0043405478414037,0.00518877521138464,0.00480069946686376,0.00439162534286605,0.00358231557012533,0.00395377480898219,0.00391333195679802,0.00396997076989482,0.0047018275264966,0.00388004786673661,0.00382647780885306,0.00458449900073023,0.00388847012410319,0.00413530600447938,0.00374273512007459,0.0034039303842407,0.00483690099122502,0.00368679649649138,0.00437964449117529,0.00443884853027891,0.00389856174662653,0.0035436785059265,0.0041923012070531,0.00372785207047197,0.00352550347981899,0.00390566891675933,0.00509814696215093,0.00468199512723025,0.0034200961885149,0.00339600685834514,0.0040284653340609,0.00419914429583407,0.00360898167567458,0.00346593887988873,0.00452210138464505,0.00341639597428035,0.00328221386301381,0.00402180716414044,0.00356431111913928,0.00394004512268194,0.00453911749450667,0.00365636806406631,0.00375712280706547,0.00372995578935475,0.00338246800743635,0.00353750273349216,0.00441415077548252,0.00337763666314028,0.00330209500459283,0.00396669646198337,0.00412632987545003,0.0039852668496003,0.00357330256580878,0.00338692000553212,0.00375266323649617,0.00317682112965904,0.00383096392306508,0.00393738321329857,0.00323765095363356,0.00371369948256929,0.00391852034103224,0.00365053418047009,0.003620391552239,0.0038511232853373,0.00350998312313684,0.0038422413058679,0.00428403578373989,0.00324385146154476,0.00340160751342413,0.0030977543821187,0.0041676227837702,0.0039829108299935,0.0031813428981183,0.00318162447295092,0.00336566438189792,0.00433515757686256,0.00419191061731325,0.00320356725557142,0.00357921257192094,0.00386798150189246,0.0034678650006021,0.00331723544684823,0.00337025915179445,0.00351670455952752,0.00409783713173056,0.00309549182127084,0.0035245637705121,0.00415362261740524,0.00358949424666158,0.00355335819027092,0.00389921954652339,0.00332785929680562,0.00350114751211602,0.00382084124514027,0.00318073695725522,0.00322005330477044,0.00421402039609034,0.0041289795781182,0.00310511509493112,0.00359290026896166,0.0038571410864209,0.00342767246864788,0.00372469262043032,0.00374522762092487,0.00325673419163581,0.00337001549226104,0.00371714395285855,0.00377388529733915,0.0033075260461918,0.00362752011691984,0.00333881611713778,0.00402701670808959,0.00388989966354181,0.00353600817410595,0.00319895979540249,0.00319990799971924,0.00370289709325915,0.00401727846363454,0.00321146877180469,0.00336282978214676,0.00345443207339548,0.00350916232135875,0.00319813344256778],"mode":"markers+lines","name":"eval","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.338335982722899,0.133229855147475,0.0668389462049779,0.0404788091346342,0.0389659437690661,0.0259521647185081,0.0227832731924101,0.0211564285311531,0.0197733374914958,0.0207519438670546,0.0322307083386029,0.0228800911106198,0.0197029446871944,0.0189086856099215,0.0190391215755415,0.0194162943165787,0.0222628562775728,0.0219863015753434,0.0179316464171653,0.0178510522280754,0.0171340316696026,0.0181974422554612,0.0147672873146245,0.0130544206186481,0.0241265393708487,0.017844979730641,0.0151246399255639,0.0140146372393326,0.0134827503031426,0.0159721660384548,0.016986276258261,0.0130814430069376,0.0110963900814024,0.0104819380378338,0.0140967936408125,0.013478385810295,0.0110580005210833,0.00995477215448839,0.00970817223906697,0.00849961527332187,0.0146157335600507,0.0129358140307418,0.0106548118103885,0.00951205128844324,0.00961623247413616,0.011272291777196,0.0104763893414292,0.00878448898075959,0.00845534786273521,0.00823548131434697,0.00789613074914606,0.00966419302818112,0.00892096390903237,0.00826193872842802,0.00838364355156851,0.00879715934902707,0.0082742862665001,0.00708078559272881,0.00781745279591555,0.00828717253850282,0.00728157517961464,0.0071228876219039,0.00768647257050061,0.00844731668375448,0.00744516372166355,0.00741277175778647,0.00683027712331906,0.00788494072905432,0.00716719481821006,0.00682230249768284,0.00760951401816307,0.00775720915109531,0.00735091338021311,0.00668978885819583,0.00659972503597396,0.00714348441943542,0.00623642679159887,0.00661829660825139,0.00711025489369346,0.0071722194797269,0.00618445090469043,0.00614370524205853,0.00566250335379992,0.00617789090829262,0.00595438780143551,0.00706301931254662,0.00647311930303762,0.00572838004264162,0.00620619874988079,0.00593119157146215,0.00597767591314464,0.00562522148596,0.00571380466527736,0.0060584690733436,0.00642596714620211,0.00721760308334038,0.00601905042845308,0.00595615977010006,0.00544119019827459,0.00622200784520742,0.00584804126688332,0.00522590120940751,0.00538910147561445,0.00566968760393348,0.00586420706810001,0.00562798149337159,0.00667368472085444,0.00615273162209371,0.00547034908799387,0.00522897403235113,0.00542801897720535,0.00551990620720568,0.00527666740171732,0.00565723278069821,0.00542266399846218,0.00550127883181814,0.0052122877440782,0.0048830804776265,0.00555286275604017,0.00510593231586289,0.00569620299925655,0.00522876624638681,0.00480817581005156,0.00511528105261455,0.00552191415579002,0.00540545199249777,0.00465781791863259,0.00506956608927984,0.00529712122992818,0.00541103703208924,0.00591511679797135,0.00531946693096172,0.00452766588163995,0.00475458510879593,0.00495734999092968,0.00509361704464405,0.00512516973847937,0.00486380286109868,0.0049003312610522,0.00483965280444329,0.00492208911636947,0.00504171577816818,0.00459307071240341,0.00527184631420351,0.0048663902088922,0.00452866570264431,0.00495009104468218,0.00495291446067908,0.00493737117420659,0.00455644808839946,0.00477413929446592,0.00477726491111324,0.00482370539418443,0.00508377474070275,0.00542533905646661,0.00463957586454663,0.00434046124469386,0.00439386647894362,0.00481194900357304,0.0047386298820665,0.00463982166171034,0.00480687164611052,0.00459740782760348,0.00418502277793067,0.00413734758249088,0.00459619210832256,0.00458661344323305,0.00497640797618646,0.00444322389312016,0.00454203643031034,0.00439054866007542,0.00454255316827866,0.00434250773086613,0.00460716311667457,0.00455320683203669,0.00424644851712485,0.00425106176298821,0.00457990696294104,0.00452688136160916,0.00459651420869416,0.00477723808767126,0.0045557149085572,0.00433061519221485,0.00414898498773571,0.00460154946888933,0.00420968745771667,0.00423371050418744,0.00433788200804076,0.00462304613662652,0.00452805910650265,0.00429693924197812,0.00452544097987943,0.00443148629719079,0.0045942655459523,0.00426037997952462,0.00427710751914094,0.00415640510365053,0.00446999767595558,0.00462582081913708,0.00422492638522699,0.00405585959497866,0.00430875755886265,0.00461723012395026,0.00484862208179578,0.00412310348084622,0.00405758273137349,0.00404726259578979,0.00453069505148083,0.0043965840061969,0.00426003650540206,0.00412626904655675,0.00420553335109328,0.00421123964258698,0.00403127111849377,0.00416669576927845,0.00480402029275332,0.00441266992466785,0.00441367030039039,0.00447227640362049,0.00440804025808547,0.00420155038403871,0.00419594472537401,0.00424842843164738,0.00426943189629699,0.00447183315912651,0.00433791361098603,0.00407684624274121,0.0042570502373368,0.00433307021526009,0.00431023731665816,0.00418906520494932,0.00423093390553362,0.0042648770509393,0.00435723717086601,0.00430927202592506,0.00411822513172398,0.0040337102218089,0.00418232932191815,0.00431491067873036,0.00435073620511907,0.00447178483092256,0.00432058526418845,0.00418726582732749,0.00411065172459496,0.00442059807463136,0.00424840676737388,0.00411253919318564,0.00421872810933023,0.00408255859722724,0.00416771250727788],"mode":"markers+lines","name":"train","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.194680211549444,0.07651017237628,0.0157165238806937,0.0384378621071495,0.0183834221247358,0.0162274060682273,0.0143051321608791,0.0142775755510352,0.0129075263643381,0.0311621457303256,0.01523683991128,0.0126661200140758,0.0112708955951846,0.0121645386800118,0.0114686844415243,0.0123085571208697,0.0157561442348756,0.0133220538404273,0.0126308493216483,0.0121435316503536,0.0124638152915741,0.0119780810939091,0.0105141550579235,0.0323862102184174,0.0222439350326498,0.0152800050262032,0.0156107936662769,0.0130833299430143,0.0129439047826525,0.0262485007394142,0.0127542769632872,0.0107436778448534,0.00895040284271957,0.00987165438549309,0.0172602099313127,0.010766214601583,0.0107978046460716,0.00999592332167817,0.00890439554173166,0.00860168206841767,0.0105084304848114,0.00858978163899502,0.0075163682158979,0.00742433816109066,0.00778888345387353,0.00798357278142072,0.00665365288759783,0.00553510279008617,0.00570956116343504,0.00564443388850575,0.00535266958657516,0.00941814950003897,0.00767716762194978,0.00740061350442611,0.00666580406766673,0.00585948296893249,0.00534481459449373,0.00451384559313767,0.00810519964776461,0.00692424224687502,0.00608173482200236,0.0066849011983693,0.00613289889669176,0.00559234927126395,0.00520881916094398,0.0053399008849437,0.00560202808810814,0.00708785152143064,0.00635858543368961,0.00620206822469903,0.00571795268465054,0.00521207705643116,0.00516993280196409,0.00436090981833091,0.00700289041755268,0.00562598375902216,0.00544794401175299,0.00579686648301967,0.00538511087336522,0.00486630127955304,0.00453767949796872,0.00551305389314539,0.00520443241298575,0.00548334100226946,0.00515883392317257,0.00502764935818201,0.00451948586757793,0.00423461449049398,0.006047422946059,0.00451152385867028,0.0043316202480804,0.00429819299661552,0.00481778795163868,0.0043101559284861,0.00781769676327882,0.00597967936680881,0.0052370245654928,0.00546486060808398,0.00413462568736956,0.00477795271308869,0.00414500263326239,0.00505828496304757,0.00430965104187728,0.00451254784187176,0.00431151039743642,0.00491949987327682,0.00616290817157773,0.00520786038876165,0.00414439331160872,0.00420172596131979,0.00419797092421337,0.0049002377048496,0.00394060692104446,0.00442886966454973,0.00402236899959114,0.00490467462970987,0.00425033550256524,0.00387139762372957,0.0041304749126457,0.00449676840308715,0.00519854929740708,0.00384787469773047,0.00430461861855772,0.00463740681414426,0.004426763307039,0.00374438088440207,0.00409543052681202,0.0043405478414037,0.00518877521138464,0.00480069946686376,0.00439162534286605,0.00358231557012533,0.00395377480898219,0.00391333195679802,0.00396997076989482,0.0047018275264966,0.00388004786673661,0.00382647780885306,0.00458449900073023,0.00388847012410319,0.00413530600447938,0.00374273512007459,0.0034039303842407,0.00483690099122502,0.00368679649649138,0.00437964449117529,0.00443884853027891,0.00389856174662653,0.0035436785059265,0.0041923012070531,0.00372785207047197,0.00352550347981899,0.00390566891675933,0.00509814696215093,0.00468199512723025,0.0034200961885149,0.00339600685834514,0.0040284653340609,0.00419914429583407,0.00360898167567458,0.00346593887988873,0.00452210138464505,0.00341639597428035,0.00328221386301381,0.00402180716414044,0.00356431111913928,0.00394004512268194,0.00453911749450667,0.00365636806406631,0.00375712280706547,0.00372995578935475,0.00338246800743635,0.00353750273349216,0.00441415077548252,0.00337763666314028,0.00330209500459283,0.00396669646198337,0.00412632987545003,0.0039852668496003,0.00357330256580878,0.00338692000553212,0.00375266323649617,0.00317682112965904,0.00383096392306508,0.00393738321329857,0.00323765095363356,0.00371369948256929,0.00391852034103224,0.00365053418047009,0.003620391552239,0.0038511232853373,0.00350998312313684,0.0038422413058679,0.00428403578373989,0.00324385146154476,0.00340160751342413,0.0030977543821187,0.0041676227837702,0.0039829108299935,0.0031813428981183,0.00318162447295092,0.00336566438189792,0.00433515757686256,0.00419191061731325,0.00320356725557142,0.00357921257192094,0.00386798150189246,0.0034678650006021,0.00331723544684823,0.00337025915179445,0.00351670455952752,0.00409783713173056,0.00309549182127084,0.0035245637705121,0.00415362261740524,0.00358949424666158,0.00355335819027092,0.00389921954652339,0.00332785929680562,0.00350114751211602,0.00382084124514027,0.00318073695725522,0.00322005330477044,0.00421402039609034,0.0041289795781182,0.00310511509493112,0.00359290026896166,0.0038571410864209,0.00342767246864788,0.00372469262043032,0.00374522762092487,0.00325673419163581,0.00337001549226104,0.00371714395285855,0.00377388529733915,0.0033075260461918,0.00362752011691984,0.00333881611713778,0.00402701670808959,0.00388989966354181,0.00353600817410595,0.00319895979540249,0.00319990799971924,0.00370289709325915,0.00401727846363454,0.00321146877180469,0.00336282978214676,0.00345443207339548,0.00350916232135875,0.00319813344256778],"mode":"markers+lines","name":"eval","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>internals &lt;- model$symbol$get.internals()
sym_state &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state&quot;))
sym_state_cell &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state_cell&quot;))
sym_output &lt;- internals$get.output(which(internals$outputs %in% &quot;loss_output&quot;))
symbol &lt;- mx.symbol.Group(sym_output, sym_state, sym_state_cell)

pred_length = 100
predict &lt;- numeric()

data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

infer.data &lt;- mx.io.arrayiter(data = data, label = label, 
                              batch.size = 1, shuffle = FALSE)

mx.symbol.bind &lt;- mxnet:::mx.symbol.bind
infer &lt;- mxnet:::mx.infer.buckets.one(infer.data = infer.data, 
                              symbol = symbol,
                              arg.params = model$arg.params, 
                              aux.params = model$aux.params, 
                              input.params = NULL,
                              ctx = ctx)

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  label = pred
  
  infer.data &lt;- mx.io.arrayiter(data = data, label = label,  
                                batch.size = 1, shuffle = FALSE)
  
  infer &lt;- mxnet:::mx.infer.buckets.one(infer.data = infer.data, 
                                symbol = symbol,
                                ctx = ctx,
                                arg.params = model$arg.params,
                                aux.params = model$aux.params,
                                input.params = list(rnn.state = infer[[2]], 
                                                    rnn.state.cell = infer[[3]]))
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
  
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)</code></pre>
<div id="3c30d272d49" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="3c30d272d49">{"x":{"visdat":{"3c30717a92e7":["function () ","plotlyVisDat"]},"cur_data":"3c30717a92e7","attrs":{"3c30717a92e7":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802658,0.529291326391727,0.291663691782474,0.034159658575285,-0.225672298912304,-0.470125062170127,-0.682539579359456,-0.848440152165423,-0.956520930714962,-0.999416388561855,-0.974203271141929,-0.882599810740708,-0.730848631802658,-0.529291326391728,-0.291663691782475,-0.0341596585752847,0.225672298912304,0.470125062170127,0.682539579359455,0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802659,0.529291326391728,0.291663691782475,0.0341596585752866,-0.225672298912303,-0.470125062170126,-0.682539579359455,-0.848440152165422,-0.956520930714962,-0.999416388561855,-0.97420327114193,-0.882599810740709,-0.730848631802659,-0.529291326391728,-0.291663691782475,-0.0341596585752867,0.225672298912302,0.470125062170125,0.682539579359455,0.848440152165422,0.956520930714962,0.999416388561855,0.97420327114193,0.882599810740709,0.73084863180266,0.529291326391728,0.291663691782475,0.0341596585752869,-0.225672298912302,-0.470125062170125,-0.682539579359455,-0.848440152165423,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.882599810740708,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.034159658575287,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854,0.97420327114193,0.882599810740708,0.73084863180266,0.529291326391728,0.291663691782477,0.0341596585752871,-0.2256722989123,-0.470125062170125,-0.682539579359455,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.88259981074071,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.0341596585752872,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854,0.97420327114193],"mode":"lines","name":"hist","alpha":1,"sizes":[10,100],"type":"scatter"},"3c30717a92e7.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.88259981074071,0.73084863180266,0.529291326391728,0.291663691782477,0.0341596585752873,-0.2256722989123,-0.470125062170125,-0.682539579359452,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.88259981074071,-0.73084863180266,-0.529291326391732,-0.291663691782477,-0.0341596585752875,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165423,0.956520930714963,0.999416388561854,0.97420327114193,0.882599810740709,0.730848631802663,0.529291326391732,0.291663691782478,0.0341596585752876,-0.225672298912303,-0.470125062170122,-0.682539579359452,-0.848440152165421,-0.956520930714962,-0.999416388561855,-0.974203271141931,-0.88259981074071,-0.730848631802661,-0.529291326391729,-0.291663691782481,-0.0341596585752913,0.2256722989123,0.470125062170125,0.682539579359454,0.848440152165419,0.956520930714961,0.999416388561854,0.97420327114193,0.882599810740709,0.730848631802663,0.529291326391732,0.291663691782478,0.0341596585752878,-0.225672298912303,-0.470125062170121,-0.682539579359452,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.974203271141931,-0.882599810740711,-0.730848631802661,-0.529291326391729,-0.291663691782481,-0.0341596585752915,0.2256722989123,0.470125062170124,0.682539579359454,0.848440152165419,0.956520930714961,0.999416388561854,0.97420327114193,0.882599810740709,0.730848631802663,0.529291326391732,0.291663691782478,0.0341596585752881,-0.225672298912296,-0.470125062170121,-0.682539579359451,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.974203271141931,-0.882599810740711,-0.730848631802661,-0.529291326391729,-0.291663691782482,-0.0341596585752918,0.225672298912299,0.470125062170124,0.682539579359454,0.848440152165419,0.956520930714961,0.999416388561854,0.97420327114193,0.882599810740712,0.730848631802663,0.529291326391732,0.291663691782478],"mode":"lines","name":"real","alpha":1,"sizes":[10,100],"type":"scatter"},"3c30717a92e7.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.887960612773895,0.7173832654953,0.491001546382904,0.219447374343872,-0.104511111974716,-0.415441662073135,-0.661334156990051,-0.870025932788849,-1.0125424861908,-1.07943916320801,-1.08359825611115,-1.0324090719223,-0.909650504589081,-0.726537764072418,-0.52925443649292,-0.327259510755539,-0.107846364378929,0.114512726664543,0.366630285978317,0.599281489849091,0.770266115665436,0.917364835739136,0.995441615581512,0.985739290714264,0.93245005607605,0.809273779392242,0.609378039836884,0.367209672927856,0.0713319927453995,-0.248790755867958,-0.531082093715668,-0.760660648345947,-0.942979335784912,-1.05025672912598,-1.08777630329132,-1.06588745117188,-0.983438849449158,-0.823881208896637,-0.63051164150238,-0.433017283678055,-0.222223654389381,0.000800877809524536,0.231892436742783,0.49251914024353,0.68668669462204,0.846255481243134,0.970886766910553,0.995284378528595,0.967678487300873,0.881197035312653,0.718510508537292,0.495914995670319,0.229404032230377,-0.0852054059505463,-0.396523207426071,-0.645908713340759,-0.857704699039459,-1.0050106048584,-1.07645690441132,-1.08400619029999,-1.03429555892944,-0.912510633468628,-0.731356978416443,-0.535429894924164,-0.333496659994125,-0.113603428006172,0.108928740024567,0.360430508852005,0.595278680324554,0.767096102237701,0.914832353591919,0.995122730731964,0.986311614513397,0.934449791908264,0.813457608222961,0.615637302398682,0.374933570623398,0.0810287445783615,-0.238657504320145,-0.523181915283203,-0.753720223903656,-0.938154876232147,-1.04793238639832,-1.08750319480896,-1.06735193729401,-0.986986756324768,-0.829226732254028,-0.636393487453461,-0.439139127731323,-0.228949651122093,-0.00590737536549568,0.224243640899658,0.485353052616119,0.681568086147308,0.841811418533325,0.968409478664398,0.995662987232208,0.969189822673798,0.884806931018829,0.724637985229492],"mode":"lines","name":"pred","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802658,0.529291326391727,0.291663691782474,0.034159658575285,-0.225672298912304,-0.470125062170127,-0.682539579359456,-0.848440152165423,-0.956520930714962,-0.999416388561855,-0.974203271141929,-0.882599810740708,-0.730848631802658,-0.529291326391728,-0.291663691782475,-0.0341596585752847,0.225672298912304,0.470125062170127,0.682539579359455,0.848440152165423,0.956520930714962,0.999416388561855,0.974203271141929,0.882599810740708,0.730848631802659,0.529291326391728,0.291663691782475,0.0341596585752866,-0.225672298912303,-0.470125062170126,-0.682539579359455,-0.848440152165422,-0.956520930714962,-0.999416388561855,-0.97420327114193,-0.882599810740709,-0.730848631802659,-0.529291326391728,-0.291663691782475,-0.0341596585752867,0.225672298912302,0.470125062170125,0.682539579359455,0.848440152165422,0.956520930714962,0.999416388561855,0.97420327114193,0.882599810740709,0.73084863180266,0.529291326391728,0.291663691782475,0.0341596585752869,-0.225672298912302,-0.470125062170125,-0.682539579359455,-0.848440152165423,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.882599810740708,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.034159658575287,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854,0.97420327114193,0.882599810740708,0.73084863180266,0.529291326391728,0.291663691782477,0.0341596585752871,-0.2256722989123,-0.470125062170125,-0.682539579359455,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.88259981074071,-0.73084863180266,-0.529291326391728,-0.291663691782477,-0.0341596585752872,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165421,0.956520930714962,0.999416388561854,0.97420327114193],"mode":"lines","name":"hist","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.88259981074071,0.73084863180266,0.529291326391728,0.291663691782477,0.0341596585752873,-0.2256722989123,-0.470125062170125,-0.682539579359452,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.97420327114193,-0.88259981074071,-0.73084863180266,-0.529291326391732,-0.291663691782477,-0.0341596585752875,0.2256722989123,0.470125062170125,0.682539579359455,0.848440152165423,0.956520930714963,0.999416388561854,0.97420327114193,0.882599810740709,0.730848631802663,0.529291326391732,0.291663691782478,0.0341596585752876,-0.225672298912303,-0.470125062170122,-0.682539579359452,-0.848440152165421,-0.956520930714962,-0.999416388561855,-0.974203271141931,-0.88259981074071,-0.730848631802661,-0.529291326391729,-0.291663691782481,-0.0341596585752913,0.2256722989123,0.470125062170125,0.682539579359454,0.848440152165419,0.956520930714961,0.999416388561854,0.97420327114193,0.882599810740709,0.730848631802663,0.529291326391732,0.291663691782478,0.0341596585752878,-0.225672298912303,-0.470125062170121,-0.682539579359452,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.974203271141931,-0.882599810740711,-0.730848631802661,-0.529291326391729,-0.291663691782481,-0.0341596585752915,0.2256722989123,0.470125062170124,0.682539579359454,0.848440152165419,0.956520930714961,0.999416388561854,0.97420327114193,0.882599810740709,0.730848631802663,0.529291326391732,0.291663691782478,0.0341596585752881,-0.225672298912296,-0.470125062170121,-0.682539579359451,-0.848440152165421,-0.956520930714962,-0.999416388561854,-0.974203271141931,-0.882599810740711,-0.730848631802661,-0.529291326391729,-0.291663691782482,-0.0341596585752918,0.225672298912299,0.470125062170124,0.682539579359454,0.848440152165419,0.956520930714961,0.999416388561854,0.97420327114193,0.882599810740712,0.730848631802663,0.529291326391732,0.291663691782478],"mode":"lines","name":"real","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.887960612773895,0.7173832654953,0.491001546382904,0.219447374343872,-0.104511111974716,-0.415441662073135,-0.661334156990051,-0.870025932788849,-1.0125424861908,-1.07943916320801,-1.08359825611115,-1.0324090719223,-0.909650504589081,-0.726537764072418,-0.52925443649292,-0.327259510755539,-0.107846364378929,0.114512726664543,0.366630285978317,0.599281489849091,0.770266115665436,0.917364835739136,0.995441615581512,0.985739290714264,0.93245005607605,0.809273779392242,0.609378039836884,0.367209672927856,0.0713319927453995,-0.248790755867958,-0.531082093715668,-0.760660648345947,-0.942979335784912,-1.05025672912598,-1.08777630329132,-1.06588745117188,-0.983438849449158,-0.823881208896637,-0.63051164150238,-0.433017283678055,-0.222223654389381,0.000800877809524536,0.231892436742783,0.49251914024353,0.68668669462204,0.846255481243134,0.970886766910553,0.995284378528595,0.967678487300873,0.881197035312653,0.718510508537292,0.495914995670319,0.229404032230377,-0.0852054059505463,-0.396523207426071,-0.645908713340759,-0.857704699039459,-1.0050106048584,-1.07645690441132,-1.08400619029999,-1.03429555892944,-0.912510633468628,-0.731356978416443,-0.535429894924164,-0.333496659994125,-0.113603428006172,0.108928740024567,0.360430508852005,0.595278680324554,0.767096102237701,0.914832353591919,0.995122730731964,0.986311614513397,0.934449791908264,0.813457608222961,0.615637302398682,0.374933570623398,0.0810287445783615,-0.238657504320145,-0.523181915283203,-0.753720223903656,-0.938154876232147,-1.04793238639832,-1.08750319480896,-1.06735193729401,-0.986986756324768,-0.829226732254028,-0.636393487453461,-0.439139127731323,-0.228949651122093,-0.00590737536549568,0.224243640899658,0.485353052616119,0.681568086147308,0.841811418533325,0.968409478664398,0.995662987232208,0.969189822673798,0.884806931018829,0.724637985229492],"mode":"lines","name":"pred","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
