<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-0.9.2/grViz.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET Bucketing</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU">GPU</a></li>
        <li><a href="TimeSeries_CPU">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="CNN_NLP_classification_kaggle.html">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<pre class="r"><code>seq_len = 100
samples = 192

seeds &lt;- runif(samples, min = -pi, max = pi)
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, samples))
y &lt;- pts[-1, ]

p1 = plot_ly(x = 1:dim(x)[2], y = x[1,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p2 = plot_ly(x = 1:length(y[,1]), y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;%
  add_trace(x = 1:length(y[,2]), y = y[,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

# plotly::export(p1, file = &quot;timeseries_p1.png&quot;)
p1</code></pre>
<div id="6cb24ea7ad3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="6cb24ea7ad3">{"x":{"visdat":{"6cb77805746":["function () ","plotlyVisDat"]},"cur_data":"6cb77805746","attrs":{"6cb77805746":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.29373780600583,0.531130442351019,0.732327416784544,0.883617487992479,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.680952681634838,0.468209498957317,0.223558612678636,-0.0363274236060193,-0.29373780600583,-0.531130442351019,-0.732327416784543,-0.883617487992479,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.680952681634839,-0.468209498957317,-0.223558612678636,0.0363274236060188,0.29373780600583,0.531130442351019,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060186,-0.293737806005831,-0.531130442351018,-0.732327416784544,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060185,0.293737806005831,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060184,-0.293737806005827,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060183,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060181,-0.29373780600583,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.036327423606018,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"6cb77805746.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.195220946687789,0.0652702282860405,0.321313345066328,0.555459488375755,0.75175198549258,0.896813827126982,0.980759288497603,0.997867625138469,0.946972932180369,0.831543598840941,0.659445943431274,0.442408136762714,0.195220946687789,-0.0652702282860401,-0.321313345066328,-0.555459488375755,-0.75175198549258,-0.896813827126982,-0.980759288497602,-0.997867625138469,-0.94697293218037,-0.831543598840941,-0.659445943431274,-0.442408136762714,-0.19522094668779,0.0652702282860396,0.321313345066327,0.555459488375754,0.75175198549258,0.896813827126982,0.980759288497602,0.997867625138469,0.94697293218037,0.831543598840942,0.659445943431275,0.442408136762716,0.19522094668779,-0.0652702282860394,-0.321313345066327,-0.555459488375754,-0.751751985492579,-0.896813827126981,-0.980759288497602,-0.997867625138469,-0.94697293218037,-0.831543598840942,-0.659445943431276,-0.442408136762716,-0.19522094668779,0.0652702282860393,0.321313345066327,0.555459488375754,0.751751985492579,0.896813827126981,0.980759288497602,0.997867625138469,0.94697293218037,0.831543598840942,0.659445943431276,0.442408136762716,0.195220946687792,-0.0652702282860392,-0.321313345066327,-0.555459488375752,-0.751751985492579,-0.896813827126981,-0.980759288497602,-0.997867625138469,-0.94697293218037,-0.831543598840942,-0.659445943431277,-0.442408136762716,-0.19522094668779,0.0652702282860373,0.321313345066327,0.555459488375752,0.751751985492579,0.896813827126981,0.980759288497602,0.997867625138469,0.946972932180371,0.831543598840942,0.659445943431277,0.442408136762716,0.19522094668779,-0.0652702282860372,-0.321313345066327,-0.555459488375752,-0.751751985492579,-0.89681382712698,-0.980759288497602,-0.997867625138469,-0.946972932180371,-0.831543598840943,-0.659445943431277,-0.442408136762716,-0.19522094668779,0.065270228286037,0.321313345066327,0.555459488375752],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"6cb77805746.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.952025429534302,-0.99878947522621,-0.977487668759101,-0.889571693040809,-0.741032876528517,-0.541993894095537,-0.306018923467206,-0.0491892689247669,0.210992553005785,0.456795581130672,0.671468745291894,0.840382424116042,0.952025429534302,0.99878947522621,0.977487668759101,0.889571693040809,0.741032876528518,0.541993894095538,0.306018923467206,0.0491892689247672,-0.210992553005784,-0.456795581130672,-0.671468745291894,-0.840382424116042,-0.952025429534302,-0.99878947522621,-0.977487668759101,-0.88957169304081,-0.741032876528518,-0.541993894095538,-0.306018923467207,-0.0491892689247674,0.210992553005784,0.456795581130671,0.671468745291893,0.840382424116041,0.952025429534302,0.998789475226209,0.977487668759101,0.88957169304081,0.741032876528518,0.541993894095539,0.306018923467206,0.0491892689247675,-0.210992553005784,-0.456795581130671,-0.671468745291893,-0.840382424116041,-0.952025429534302,-0.998789475226209,-0.977487668759101,-0.88957169304081,-0.741032876528518,-0.541993894095539,-0.306018923467208,-0.0491892689247676,0.210992553005784,0.456795581130671,0.671468745291893,0.840382424116041,0.952025429534301,0.998789475226209,0.977487668759101,0.889571693040811,0.741032876528518,0.541993894095538,0.306018923467208,0.0491892689247677,-0.210992553005782,-0.456795581130672,-0.671468745291891,-0.84038242411604,-0.952025429534301,-0.998789475226209,-0.9774876687591,-0.889571693040811,-0.74103287652852,-0.541993894095539,-0.306018923467207,-0.0491892689247661,0.21099255300578,0.456795581130669,0.671468745291893,0.840382424116042,0.952025429534302,0.998789475226209,0.977487668759101,0.88957169304081,0.741032876528517,0.541993894095542,0.30601892346721,0.0491892689247697,-0.210992553005783,-0.456795581130672,-0.67146874529189,-0.84038242411604,-0.952025429534301,-0.998789475226209,-0.977487668759101,-0.889571693040812],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"6cb77805746.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.308665650535287,-0.544329190761289,-0.742897596183429,-0.890838758121993,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802582,-0.669405080339912,-0.454319608896276,-0.208273006905012,0.0519670563194105,0.308665650535287,0.544329190761288,0.742897596183428,0.890838758121993,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802583,0.669405080339912,0.454319608896276,0.208273006905013,-0.05196705631941,-0.308665650535287,-0.544329190761288,-0.742897596183428,-0.890838758121992,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802583,-0.669405080339912,-0.454319608896277,-0.208273006905014,0.0519670563194089,0.308665650535287,0.544329190761288,0.742897596183428,0.890838758121992,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802582,0.669405080339913,0.454319608896276,0.208273006905015,-0.0519670563194097,-0.308665650535287,-0.544329190761287,-0.742897596183429,-0.890838758121992,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802582,-0.669405080339913,-0.454319608896277,-0.208273006905015,0.0519670563194096,0.308665650535284,0.544329190761287,0.742897596183428,0.890838758121992,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802582,0.669405080339913,0.454319608896277,0.208273006905015,-0.0519670563194095,-0.308665650535287,-0.544329190761287,-0.742897596183428,-0.890838758121992,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802582,-0.669405080339913,-0.454319608896277,-0.208273006905015,0.0519670563194093,0.308665650535287,0.544329190761287,0.742897596183428,0.890838758121992,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802582,0.669405080339913,0.454319608896277,0.208273006905015,-0.0519670563194092,-0.308665650535287,-0.544329190761287,-0.742897596183428,-0.890838758121992],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"6cb77805746.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.511284651389004,-0.271431003813584,-0.0130797818892101,0.246162805555552,0.488629804604973,0.697797489969497,0.859411429557476,0.962457900465652,0.999914455993977,0.969228493783081,0.872491211446686,0.7162950949101,0.511284651389004,0.271431003813584,0.0130797818892104,-0.246162805555551,-0.488629804604973,-0.697797489969497,-0.859411429557476,-0.962457900465652,-0.999914455993977,-0.969228493783081,-0.872491211446687,-0.716295094910101,-0.511284651389004,-0.271431003813584,-0.0130797818892105,0.246162805555551,0.488629804604972,0.697797489969496,0.859411429557475,0.962457900465652,0.999914455993977,0.969228493783081,0.872491211446687,0.716295094910101,0.511284651389004,0.271431003813584,0.0130797818892106,-0.246162805555551,-0.488629804604972,-0.697797489969496,-0.859411429557476,-0.962457900465652,-0.999914455993977,-0.969228493783081,-0.872491211446687,-0.716295094910101,-0.511284651389004,-0.271431003813584,-0.0130797818892107,0.246162805555551,0.488629804604972,0.697797489969496,0.859411429557475,0.962457900465652,0.999914455993977,0.969228493783081,0.872491211446687,0.716295094910101,0.511284651389006,0.271431003813584,0.0130797818892108,-0.246162805555549,-0.488629804604972,-0.697797489969497,-0.859411429557475,-0.962457900465652,-0.999914455993977,-0.969228493783081,-0.872491211446688,-0.716295094910101,-0.511284651389004,-0.271431003813586,-0.013079781889211,0.246162805555549,0.488629804604972,0.697797489969497,0.859411429557475,0.962457900465651,0.999914455993977,0.969228493783081,0.872491211446688,0.716295094910101,0.511284651389004,0.271431003813586,0.0130797818892111,-0.246162805555549,-0.488629804604971,-0.697797489969495,-0.859411429557475,-0.962457900465651,-0.999914455993977,-0.969228493783081,-0.872491211446688,-0.716295094910102,-0.511284651389004,-0.271431003813586,-0.0130797818892112,0.246162805555548],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.29373780600583,0.531130442351019,0.732327416784544,0.883617487992479,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.680952681634838,0.468209498957317,0.223558612678636,-0.0363274236060193,-0.29373780600583,-0.531130442351019,-0.732327416784543,-0.883617487992479,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.680952681634839,-0.468209498957317,-0.223558612678636,0.0363274236060188,0.29373780600583,0.531130442351019,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060186,-0.293737806005831,-0.531130442351018,-0.732327416784544,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060185,0.293737806005831,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060184,-0.293737806005827,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060183,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060181,-0.29373780600583,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.036327423606018,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.195220946687789,0.0652702282860405,0.321313345066328,0.555459488375755,0.75175198549258,0.896813827126982,0.980759288497603,0.997867625138469,0.946972932180369,0.831543598840941,0.659445943431274,0.442408136762714,0.195220946687789,-0.0652702282860401,-0.321313345066328,-0.555459488375755,-0.75175198549258,-0.896813827126982,-0.980759288497602,-0.997867625138469,-0.94697293218037,-0.831543598840941,-0.659445943431274,-0.442408136762714,-0.19522094668779,0.0652702282860396,0.321313345066327,0.555459488375754,0.75175198549258,0.896813827126982,0.980759288497602,0.997867625138469,0.94697293218037,0.831543598840942,0.659445943431275,0.442408136762716,0.19522094668779,-0.0652702282860394,-0.321313345066327,-0.555459488375754,-0.751751985492579,-0.896813827126981,-0.980759288497602,-0.997867625138469,-0.94697293218037,-0.831543598840942,-0.659445943431276,-0.442408136762716,-0.19522094668779,0.0652702282860393,0.321313345066327,0.555459488375754,0.751751985492579,0.896813827126981,0.980759288497602,0.997867625138469,0.94697293218037,0.831543598840942,0.659445943431276,0.442408136762716,0.195220946687792,-0.0652702282860392,-0.321313345066327,-0.555459488375752,-0.751751985492579,-0.896813827126981,-0.980759288497602,-0.997867625138469,-0.94697293218037,-0.831543598840942,-0.659445943431277,-0.442408136762716,-0.19522094668779,0.0652702282860373,0.321313345066327,0.555459488375752,0.751751985492579,0.896813827126981,0.980759288497602,0.997867625138469,0.946972932180371,0.831543598840942,0.659445943431277,0.442408136762716,0.19522094668779,-0.0652702282860372,-0.321313345066327,-0.555459488375752,-0.751751985492579,-0.89681382712698,-0.980759288497602,-0.997867625138469,-0.946972932180371,-0.831543598840943,-0.659445943431277,-0.442408136762716,-0.19522094668779,0.065270228286037,0.321313345066327,0.555459488375752],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.952025429534302,-0.99878947522621,-0.977487668759101,-0.889571693040809,-0.741032876528517,-0.541993894095537,-0.306018923467206,-0.0491892689247669,0.210992553005785,0.456795581130672,0.671468745291894,0.840382424116042,0.952025429534302,0.99878947522621,0.977487668759101,0.889571693040809,0.741032876528518,0.541993894095538,0.306018923467206,0.0491892689247672,-0.210992553005784,-0.456795581130672,-0.671468745291894,-0.840382424116042,-0.952025429534302,-0.99878947522621,-0.977487668759101,-0.88957169304081,-0.741032876528518,-0.541993894095538,-0.306018923467207,-0.0491892689247674,0.210992553005784,0.456795581130671,0.671468745291893,0.840382424116041,0.952025429534302,0.998789475226209,0.977487668759101,0.88957169304081,0.741032876528518,0.541993894095539,0.306018923467206,0.0491892689247675,-0.210992553005784,-0.456795581130671,-0.671468745291893,-0.840382424116041,-0.952025429534302,-0.998789475226209,-0.977487668759101,-0.88957169304081,-0.741032876528518,-0.541993894095539,-0.306018923467208,-0.0491892689247676,0.210992553005784,0.456795581130671,0.671468745291893,0.840382424116041,0.952025429534301,0.998789475226209,0.977487668759101,0.889571693040811,0.741032876528518,0.541993894095538,0.306018923467208,0.0491892689247677,-0.210992553005782,-0.456795581130672,-0.671468745291891,-0.84038242411604,-0.952025429534301,-0.998789475226209,-0.9774876687591,-0.889571693040811,-0.74103287652852,-0.541993894095539,-0.306018923467207,-0.0491892689247661,0.21099255300578,0.456795581130669,0.671468745291893,0.840382424116042,0.952025429534302,0.998789475226209,0.977487668759101,0.88957169304081,0.741032876528517,0.541993894095542,0.30601892346721,0.0491892689247697,-0.210992553005783,-0.456795581130672,-0.67146874529189,-0.84038242411604,-0.952025429534301,-0.998789475226209,-0.977487668759101,-0.889571693040812],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.308665650535287,-0.544329190761289,-0.742897596183429,-0.890838758121993,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802582,-0.669405080339912,-0.454319608896276,-0.208273006905012,0.0519670563194105,0.308665650535287,0.544329190761288,0.742897596183428,0.890838758121993,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802583,0.669405080339912,0.454319608896276,0.208273006905013,-0.05196705631941,-0.308665650535287,-0.544329190761288,-0.742897596183428,-0.890838758121992,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802583,-0.669405080339912,-0.454319608896277,-0.208273006905014,0.0519670563194089,0.308665650535287,0.544329190761288,0.742897596183428,0.890838758121992,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802582,0.669405080339913,0.454319608896276,0.208273006905015,-0.0519670563194097,-0.308665650535287,-0.544329190761287,-0.742897596183429,-0.890838758121992,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802582,-0.669405080339913,-0.454319608896277,-0.208273006905015,0.0519670563194096,0.308665650535284,0.544329190761287,0.742897596183428,0.890838758121992,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802582,0.669405080339913,0.454319608896277,0.208273006905015,-0.0519670563194095,-0.308665650535287,-0.544329190761287,-0.742897596183428,-0.890838758121992,-0.978070730875198,-0.998648799657565,-0.951170603088441,-0.838871701802582,-0.669405080339913,-0.454319608896277,-0.208273006905015,0.0519670563194093,0.308665650535287,0.544329190761287,0.742897596183428,0.890838758121992,0.978070730875198,0.998648799657565,0.951170603088441,0.838871701802582,0.669405080339913,0.454319608896277,0.208273006905015,-0.0519670563194092,-0.308665650535287,-0.544329190761287,-0.742897596183428,-0.890838758121992],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.511284651389004,-0.271431003813584,-0.0130797818892101,0.246162805555552,0.488629804604973,0.697797489969497,0.859411429557476,0.962457900465652,0.999914455993977,0.969228493783081,0.872491211446686,0.7162950949101,0.511284651389004,0.271431003813584,0.0130797818892104,-0.246162805555551,-0.488629804604973,-0.697797489969497,-0.859411429557476,-0.962457900465652,-0.999914455993977,-0.969228493783081,-0.872491211446687,-0.716295094910101,-0.511284651389004,-0.271431003813584,-0.0130797818892105,0.246162805555551,0.488629804604972,0.697797489969496,0.859411429557475,0.962457900465652,0.999914455993977,0.969228493783081,0.872491211446687,0.716295094910101,0.511284651389004,0.271431003813584,0.0130797818892106,-0.246162805555551,-0.488629804604972,-0.697797489969496,-0.859411429557476,-0.962457900465652,-0.999914455993977,-0.969228493783081,-0.872491211446687,-0.716295094910101,-0.511284651389004,-0.271431003813584,-0.0130797818892107,0.246162805555551,0.488629804604972,0.697797489969496,0.859411429557475,0.962457900465652,0.999914455993977,0.969228493783081,0.872491211446687,0.716295094910101,0.511284651389006,0.271431003813584,0.0130797818892108,-0.246162805555549,-0.488629804604972,-0.697797489969497,-0.859411429557475,-0.962457900465652,-0.999914455993977,-0.969228493783081,-0.872491211446688,-0.716295094910101,-0.511284651389004,-0.271431003813586,-0.013079781889211,0.246162805555549,0.488629804604972,0.697797489969497,0.859411429557475,0.962457900465651,0.999914455993977,0.969228493783081,0.872491211446688,0.716295094910101,0.511284651389004,0.271431003813586,0.0130797818892111,-0.246162805555549,-0.488629804604971,-0.697797489969495,-0.859411429557475,-0.962457900465651,-0.999914455993977,-0.969228493783081,-0.872491211446688,-0.716295094910102,-0.511284651389004,-0.271431003813586,-0.0130797818892112,0.246162805555548],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<p>Hacky array.iter approach: batch.size = seq.length so that the graph is fed with the expected format.</p>
<pre class="r"><code>batch.size = 16

train.data &lt;- mx.io.arrayiter(data = x[,,1:160, drop = F], label = y[, 1:160], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-(1:160), drop = F], label = y[, -(1:160)], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph(num_rnn_layer =  2, 
                    num_hidden = 64,
                    input_size = NULL,
                    num_embed = NULL, 
                    num_decode = 1,
                    masking = F, 
                    loss_output = &quot;linear&quot;,
                    dropout = 0.25, 
                    ignore_label = -1,
                    cell_type = &quot;lstm&quot;,
                    output_last_state = T,
                    config = &quot;one-to-one&quot;)

graph = graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;LR&quot;, 
                  shape=list(data = c(1, seq_len, batch.size), 
                             label = c(seq_len, batch.size)),
                   graph.width.px = 800, graph.height.px = 160)</code></pre>
<div id="htmlwidget-867194db4433806ed426" style="width:800px;height:160px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-867194db4433806ed426">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"RNN\nRNN\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"5\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"7\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"8\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"9\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [id = \"1\", color = \"black\", fontcolor = \"black\", label = \"1X100X16\"] \n\"2\"->\"3\" [id = \"2\", color = \"black\", fontcolor = \"black\", label = \"1X16X100\"] \n\"3\"->\"4\" [id = \"3\", color = \"black\", fontcolor = \"black\", label = \"64X16X100\"] \n\"4\"->\"5\" [id = \"4\", color = \"black\", fontcolor = \"black\", label = \"64X16X100\"] \n\"5\"->\"6\" [id = \"5\", color = \"black\", fontcolor = \"black\", label = \"64X100X16\"] \n\"6\"->\"7\" [id = \"6\", color = \"black\", fontcolor = \"black\", label = \"64X1600\"] \n\"7\"->\"9\" [id = \"7\", color = \"black\", fontcolor = \"black\", label = \"1X1600\"] \n\"8\"->\"9\" [id = \"8\", color = \"black\", fontcolor = \"black\", label = \"1600\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="figure">
<img src="time_graph.png" />

</div>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;Perplexity&quot;, function(label, pred) {
  label = mx.nd.reshape(mx.nd.array(label), shape = -1)
  label = as.array(label)
  res &lt;- mean((label-pred)^2)
  return(res)
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.gpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 2.5)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.9, eps = 1e-5, wd = 1e-8,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 250, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
##  60.936   5.588  57.701</code></pre>
<pre class="r"><code>p &lt;- plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
             mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)

# plotly::export(p, file = &quot;logger_one_to_one.png&quot;)
p</code></pre>
<div id="6cb767d3be0" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="6cb767d3be0">{"x":{"visdat":{"6cb386a355a":["function () ","plotlyVisDat"]},"cur_data":"6cb386a355a","attrs":{"6cb386a355a":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.35372166645293,0.0971257077986138,0.0387639019455933,0.0502248501841375,0.0323027654671994,0.0360351867841763,0.0321990049899219,0.0321221981445751,0.0386204620212305,0.0286767802509724,0.028916746246847,0.0242372864245194,0.0234966019034467,0.0273963109102444,0.0245231460400413,0.0208535218272717,0.0184331606220796,0.0172640195072861,0.0227816312437009,0.0205363676447052,0.0177810428348596,0.0170941092935463,0.0168023666661579,0.0161881875688919,0.0156075906371524,0.0246374631329754,0.0172184884872301,0.0143015799784507,0.0129558014905389,0.0116413873849622,0.011848106842441,0.0175956418529535,0.015169801843532,0.0116654653844689,0.0100335866678882,0.0106148200039445,0.0102593006902083,0.00899408675883613,0.0101252442311631,0.014946928344208,0.0110417962167777,0.00962347870956764,0.00890460891097658,0.00785557950902955,0.0106615322071508,0.00871115232918044,0.00806726485345792,0.00827977559293664,0.0079283703363288,0.00832631108355383,0.0128178216394284,0.0101346753952531,0.00919054087476082,0.00821445900759505,0.00815172321483888,0.00718101475052424,0.00830967094193599,0.00779470371381354,0.00728257141759164,0.00724751134885226,0.00831539767089042,0.00851655525533781,0.00727424160601025,0.00741018514904305,0.00631763565022506,0.00736114434915997,0.00688105380067902,0.00688264100268952,0.00616606720255081,0.00746954855772989,0.00699000942719869,0.00590262987305512,0.00628337343834538,0.00581536433596723,0.00721606041383964,0.0065500587669499,0.00586145315652452,0.00566611053511758,0.00596839954977777,0.00670246883576751,0.00576323656436225,0.00537895533199392,0.00637043239982007,0.00572840339529027,0.00570679750259979,0.0052972251154033,0.00683165768141289,0.00603619379487202,0.00582798878446043,0.00562571768466846,0.0055764710831023,0.00602358510791937,0.00531988360232182,0.00522061608126233,0.00609068835991521,0.00522441394202523,0.00504830049712746,0.00540495833241466,0.00513080284270869,0.00587147491253877,0.00535785091691603,0.00540868333744251,0.00518525045584677,0.00565449776686806,0.00569207078763827,0.00504972783629215,0.0051827486033135,0.00539232400572184,0.0053815810314614,0.00525288436061803,0.00530748873723248,0.00567672815965914,0.00531521552541677,0.0047897375120417,0.0047790318046521,0.00489149164210021,0.00516118825675214,0.00525052994102978,0.00497316814169476,0.00561095234846956,0.00497807432422264,0.00473707556729148,0.00516330501702638,0.00505027993905083,0.00590901295103528,0.00531218630043191,0.00475815590144615,0.00456643814243265,0.00455910091590168,0.00500421769452389,0.00500946744504591,0.00540853201861004,0.00519375390693296,0.00471337849803824,0.00523049688324153,0.00529323727322223,0.00464383595273658,0.00436793999851029,0.00482999561068967,0.00456010184802997,0.00537260284279766,0.0047947083257756,0.00472482938731603,0.00479974250181595,0.00472839581725055,0.00471188751204534,0.00446884580526928,0.00508970100678149,0.00470352787056456,0.00438823854360119,0.00491994278072449,0.00449003692870004,0.0045979329841418,0.00435057541919469,0.00450784078220654,0.00488783337200909,0.00455717115846836,0.00442168541631147,0.00448044082286135,0.00458804275873275,0.00431953826884139,0.00486632446856159,0.00444435198152156,0.00444226551258686,0.00423073433184433,0.00486153162435149,0.00432827418537993,0.00400276686181633,0.0045491769460312,0.00436046239074502,0.00434957512211083,0.00462336668894651,0.00476814609184446,0.00453934578978639,0.00429597930912996,0.0041774637938442,0.00417981546896375,0.00424742129376754,0.00422300793222617,0.0045990021838111,0.00462492350780173,0.00403644218475043,0.00433903460554068,0.00437553977396255,0.00409469310739159,0.00425086975921548,0.00454593377974156,0.004286762569229,0.00393031221452831,0.00428462985456827,0.00451978923576912,0.00437805707412766,0.00457574467593951,0.00438628143080679,0.00436950302560887,0.00409390619818737,0.00400030999765599,0.00436250089944307,0.00446546391525752,0.00420033038417468,0.00412338154753498,0.0041314062137956,0.00447106036179321,0.00410562124040242,0.00393638827488106,0.00423522709798683,0.00420010821378105,0.0044281891679316,0.00405964348180274,0.00408975281579788,0.00426202246187155,0.00447859904948306,0.00410657012347623,0.00427470534758463,0.00420326427045064,0.00419399170506723,0.00423902895944588,0.00427475440025142,0.00415369649876927,0.00433984926131193,0.00396315692869712,0.00397917883413508,0.00391459770252313,0.00431195350328399,0.00404260824444071,0.00416364883887552,0.00382995837940778,0.00397085928583463,0.00407448631114183,0.00431196186645714,0.0043033070711838,0.00415364180728418,0.00402049835972723,0.00435739459586025,0.00409535805692273,0.00445160228009803,0.00431205501717325,0.00387622224155955,0.003890077914202,0.00382321486436695,0.00405229747533465,0.00424143135660783,0.00411772012773498,0.00442484873674922,0.0042792477115368,0.00478312726628891,0.00418208861948142,0.00405705079026294,0.00374058836107031,0.00370043025534061],"mode":"markers+lines","name":"train","alpha":1,"sizes":[10,100],"type":"scatter"},"6cb386a355a.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.335242470737856,0.0451963434374181,0.0256388893395508,0.0233613009421006,0.014968615912011,0.0196042107754793,0.0186882930124782,0.0330003475327122,0.015090066415369,0.0149819717181858,0.0164478232729097,0.013694302848454,0.0140118271467786,0.0121065546574952,0.0136426424477464,0.0115242455152601,0.0104548992162136,0.0111865665058205,0.0141027252974528,0.0120300612699618,0.0106951372619804,0.011577201423885,0.00992153696821894,0.00988611546605911,0.0128630888373036,0.0119572357183392,0.00966680643687723,0.00933061224290119,0.00820329465245319,0.00769334123237438,0.00883275518322392,0.0119293126979264,0.0088429159024972,0.00751607213516988,0.00701065349780532,0.00753522201077854,0.00702414530164664,0.00614732607645849,0.0203604373029656,0.012942107093019,0.00983646224267689,0.00896891668930592,0.00783165057779468,0.00677535752063815,0.00721854511792522,0.00605830678024238,0.00595372825105268,0.0063274869222014,0.00535681242682901,0.0106601280404008,0.0122964443920581,0.00963937751796754,0.00867840867522801,0.00801563753319436,0.00780131705850347,0.00551455329092962,0.00631967190547895,0.00551295471409189,0.00543675324830326,0.0052089218901405,0.00887424150797643,0.00748705006351563,0.00813342491795591,0.00636224361786047,0.00488896436806328,0.00550306055519854,0.00534997610306817,0.00497741285935967,0.00578744337102505,0.00667603470079078,0.00539785317280828,0.00607440832564472,0.00531572277356307,0.00493044976654978,0.00538161933341623,0.00471087926412063,0.004236429619358,0.00441713424846571,0.00675872917983988,0.00567085038630599,0.00428634130559528,0.00491832624356987,0.00456296168993183,0.00433205337583242,0.00422300025524693,0.00439336703421102,0.00589049493270051,0.00462131060991519,0.00510005098949592,0.00441105259247486,0.00427849056616139,0.00450276407232534,0.00381276977115009,0.00644811119524759,0.0049537279227679,0.0040197591676968,0.00432632813639472,0.00419477919100695,0.00558477897634602,0.00479711518999982,0.00457530625108732,0.00501445231460473,0.00439183771392332,0.00448260452008228,0.00440737296588379,0.0040750566450009,0.00537769231316686,0.00476002235555034,0.00423091808376484,0.00424279561539801,0.00412190446050786,0.00560648302054371,0.00451206594635924,0.0040025959635103,0.00472927344135108,0.00420275005339278,0.00442375903749048,0.00417354641714097,0.00521286973412324,0.00457449212512378,0.00377206241947101,0.00395752666476976,0.00410868001598286,0.00464675596249927,0.00520607968101317,0.00446206790368253,0.00396199376021464,0.00365198692356357,0.00415072875061499,0.00462022956576076,0.0046476429575689,0.00433184014869319,0.00399339561515136,0.00382755119956464,0.00518837884988274,0.00446789117732905,0.00352424079644214,0.00363111179564809,0.00392640018243124,0.0043720740212346,0.00452968417951456,0.00387931025247773,0.00448825235086513,0.00403849988067866,0.00392573306293015,0.00366540529616593,0.00390343276723518,0.00438128508382204,0.00391295155571001,0.00424786315618693,0.00393617803428552,0.00357133305940463,0.0034941659390435,0.0035680947845436,0.00498435221006991,0.00398958950664687,0.00357244284444505,0.00383507536602303,0.00372176028218878,0.00373263572287093,0.00422479427132809,0.00413416710718306,0.00356515252469073,0.00368511939145737,0.00398295012394377,0.00407561662820706,0.00349290031777454,0.00338279433670571,0.00413851681399864,0.00337900221489899,0.00372241805233559,0.00349407842519893,0.00476109292708315,0.00369278977337637,0.00327358455883056,0.00380808084444302,0.00341932232179076,0.0035951781324896,0.00335753857045175,0.00464410022891177,0.00360258113990383,0.00321615529873865,0.00421010476585537,0.00349827898090526,0.00335611410817467,0.0034995445780694,0.00400787623684741,0.00334593563707061,0.00337287025700802,0.00396600090030977,0.00398024627488434,0.00363615448609513,0.00335540385333124,0.00433707728657642,0.00361357947932841,0.00372460292233345,0.00338500117232593,0.00362966599972483,0.00396771969172435,0.00346836366133841,0.00328717260264214,0.00347396820314223,0.00390301618840796,0.003492049570968,0.00312241556274098,0.00337417604054947,0.00407008415176715,0.00380922950118705,0.00322521089697642,0.00335375228675005,0.004095681232942,0.0039206475091394,0.00332343605039884,0.00342589073674162,0.00357930479981815,0.00407553428277409,0.00349223674301384,0.00334748235013802,0.00385972116153689,0.00359064825548876,0.00325936141835521,0.00377432430514634,0.00332696071787615,0.00331905734685058,0.00393374107062403,0.00335638760180768,0.00305855787500967,0.00363538793247669,0.00362774382901311,0.00320192465993132,0.00411784310640811,0.00348651430720368,0.00378288069967776,0.00374518941749004,0.00353786581072233,0.00354702860188795,0.00358163728524534,0.00346487001516168,0.00322272332083576,0.00328310081093518,0.00391760948449842,0.00392801073220364,0.00378897437288705,0.00437306315695363,0.0035683109050818,0.00358660404021387,0.00374644480252454,0.00322326946248693,0.00331919124793795,0.00316004064161272],"mode":"markers+lines","name":"eval","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.35372166645293,0.0971257077986138,0.0387639019455933,0.0502248501841375,0.0323027654671994,0.0360351867841763,0.0321990049899219,0.0321221981445751,0.0386204620212305,0.0286767802509724,0.028916746246847,0.0242372864245194,0.0234966019034467,0.0273963109102444,0.0245231460400413,0.0208535218272717,0.0184331606220796,0.0172640195072861,0.0227816312437009,0.0205363676447052,0.0177810428348596,0.0170941092935463,0.0168023666661579,0.0161881875688919,0.0156075906371524,0.0246374631329754,0.0172184884872301,0.0143015799784507,0.0129558014905389,0.0116413873849622,0.011848106842441,0.0175956418529535,0.015169801843532,0.0116654653844689,0.0100335866678882,0.0106148200039445,0.0102593006902083,0.00899408675883613,0.0101252442311631,0.014946928344208,0.0110417962167777,0.00962347870956764,0.00890460891097658,0.00785557950902955,0.0106615322071508,0.00871115232918044,0.00806726485345792,0.00827977559293664,0.0079283703363288,0.00832631108355383,0.0128178216394284,0.0101346753952531,0.00919054087476082,0.00821445900759505,0.00815172321483888,0.00718101475052424,0.00830967094193599,0.00779470371381354,0.00728257141759164,0.00724751134885226,0.00831539767089042,0.00851655525533781,0.00727424160601025,0.00741018514904305,0.00631763565022506,0.00736114434915997,0.00688105380067902,0.00688264100268952,0.00616606720255081,0.00746954855772989,0.00699000942719869,0.00590262987305512,0.00628337343834538,0.00581536433596723,0.00721606041383964,0.0065500587669499,0.00586145315652452,0.00566611053511758,0.00596839954977777,0.00670246883576751,0.00576323656436225,0.00537895533199392,0.00637043239982007,0.00572840339529027,0.00570679750259979,0.0052972251154033,0.00683165768141289,0.00603619379487202,0.00582798878446043,0.00562571768466846,0.0055764710831023,0.00602358510791937,0.00531988360232182,0.00522061608126233,0.00609068835991521,0.00522441394202523,0.00504830049712746,0.00540495833241466,0.00513080284270869,0.00587147491253877,0.00535785091691603,0.00540868333744251,0.00518525045584677,0.00565449776686806,0.00569207078763827,0.00504972783629215,0.0051827486033135,0.00539232400572184,0.0053815810314614,0.00525288436061803,0.00530748873723248,0.00567672815965914,0.00531521552541677,0.0047897375120417,0.0047790318046521,0.00489149164210021,0.00516118825675214,0.00525052994102978,0.00497316814169476,0.00561095234846956,0.00497807432422264,0.00473707556729148,0.00516330501702638,0.00505027993905083,0.00590901295103528,0.00531218630043191,0.00475815590144615,0.00456643814243265,0.00455910091590168,0.00500421769452389,0.00500946744504591,0.00540853201861004,0.00519375390693296,0.00471337849803824,0.00523049688324153,0.00529323727322223,0.00464383595273658,0.00436793999851029,0.00482999561068967,0.00456010184802997,0.00537260284279766,0.0047947083257756,0.00472482938731603,0.00479974250181595,0.00472839581725055,0.00471188751204534,0.00446884580526928,0.00508970100678149,0.00470352787056456,0.00438823854360119,0.00491994278072449,0.00449003692870004,0.0045979329841418,0.00435057541919469,0.00450784078220654,0.00488783337200909,0.00455717115846836,0.00442168541631147,0.00448044082286135,0.00458804275873275,0.00431953826884139,0.00486632446856159,0.00444435198152156,0.00444226551258686,0.00423073433184433,0.00486153162435149,0.00432827418537993,0.00400276686181633,0.0045491769460312,0.00436046239074502,0.00434957512211083,0.00462336668894651,0.00476814609184446,0.00453934578978639,0.00429597930912996,0.0041774637938442,0.00417981546896375,0.00424742129376754,0.00422300793222617,0.0045990021838111,0.00462492350780173,0.00403644218475043,0.00433903460554068,0.00437553977396255,0.00409469310739159,0.00425086975921548,0.00454593377974156,0.004286762569229,0.00393031221452831,0.00428462985456827,0.00451978923576912,0.00437805707412766,0.00457574467593951,0.00438628143080679,0.00436950302560887,0.00409390619818737,0.00400030999765599,0.00436250089944307,0.00446546391525752,0.00420033038417468,0.00412338154753498,0.0041314062137956,0.00447106036179321,0.00410562124040242,0.00393638827488106,0.00423522709798683,0.00420010821378105,0.0044281891679316,0.00405964348180274,0.00408975281579788,0.00426202246187155,0.00447859904948306,0.00410657012347623,0.00427470534758463,0.00420326427045064,0.00419399170506723,0.00423902895944588,0.00427475440025142,0.00415369649876927,0.00433984926131193,0.00396315692869712,0.00397917883413508,0.00391459770252313,0.00431195350328399,0.00404260824444071,0.00416364883887552,0.00382995837940778,0.00397085928583463,0.00407448631114183,0.00431196186645714,0.0043033070711838,0.00415364180728418,0.00402049835972723,0.00435739459586025,0.00409535805692273,0.00445160228009803,0.00431205501717325,0.00387622224155955,0.003890077914202,0.00382321486436695,0.00405229747533465,0.00424143135660783,0.00411772012773498,0.00442484873674922,0.0042792477115368,0.00478312726628891,0.00418208861948142,0.00405705079026294,0.00374058836107031,0.00370043025534061],"mode":"markers+lines","name":"train","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.335242470737856,0.0451963434374181,0.0256388893395508,0.0233613009421006,0.014968615912011,0.0196042107754793,0.0186882930124782,0.0330003475327122,0.015090066415369,0.0149819717181858,0.0164478232729097,0.013694302848454,0.0140118271467786,0.0121065546574952,0.0136426424477464,0.0115242455152601,0.0104548992162136,0.0111865665058205,0.0141027252974528,0.0120300612699618,0.0106951372619804,0.011577201423885,0.00992153696821894,0.00988611546605911,0.0128630888373036,0.0119572357183392,0.00966680643687723,0.00933061224290119,0.00820329465245319,0.00769334123237438,0.00883275518322392,0.0119293126979264,0.0088429159024972,0.00751607213516988,0.00701065349780532,0.00753522201077854,0.00702414530164664,0.00614732607645849,0.0203604373029656,0.012942107093019,0.00983646224267689,0.00896891668930592,0.00783165057779468,0.00677535752063815,0.00721854511792522,0.00605830678024238,0.00595372825105268,0.0063274869222014,0.00535681242682901,0.0106601280404008,0.0122964443920581,0.00963937751796754,0.00867840867522801,0.00801563753319436,0.00780131705850347,0.00551455329092962,0.00631967190547895,0.00551295471409189,0.00543675324830326,0.0052089218901405,0.00887424150797643,0.00748705006351563,0.00813342491795591,0.00636224361786047,0.00488896436806328,0.00550306055519854,0.00534997610306817,0.00497741285935967,0.00578744337102505,0.00667603470079078,0.00539785317280828,0.00607440832564472,0.00531572277356307,0.00493044976654978,0.00538161933341623,0.00471087926412063,0.004236429619358,0.00441713424846571,0.00675872917983988,0.00567085038630599,0.00428634130559528,0.00491832624356987,0.00456296168993183,0.00433205337583242,0.00422300025524693,0.00439336703421102,0.00589049493270051,0.00462131060991519,0.00510005098949592,0.00441105259247486,0.00427849056616139,0.00450276407232534,0.00381276977115009,0.00644811119524759,0.0049537279227679,0.0040197591676968,0.00432632813639472,0.00419477919100695,0.00558477897634602,0.00479711518999982,0.00457530625108732,0.00501445231460473,0.00439183771392332,0.00448260452008228,0.00440737296588379,0.0040750566450009,0.00537769231316686,0.00476002235555034,0.00423091808376484,0.00424279561539801,0.00412190446050786,0.00560648302054371,0.00451206594635924,0.0040025959635103,0.00472927344135108,0.00420275005339278,0.00442375903749048,0.00417354641714097,0.00521286973412324,0.00457449212512378,0.00377206241947101,0.00395752666476976,0.00410868001598286,0.00464675596249927,0.00520607968101317,0.00446206790368253,0.00396199376021464,0.00365198692356357,0.00415072875061499,0.00462022956576076,0.0046476429575689,0.00433184014869319,0.00399339561515136,0.00382755119956464,0.00518837884988274,0.00446789117732905,0.00352424079644214,0.00363111179564809,0.00392640018243124,0.0043720740212346,0.00452968417951456,0.00387931025247773,0.00448825235086513,0.00403849988067866,0.00392573306293015,0.00366540529616593,0.00390343276723518,0.00438128508382204,0.00391295155571001,0.00424786315618693,0.00393617803428552,0.00357133305940463,0.0034941659390435,0.0035680947845436,0.00498435221006991,0.00398958950664687,0.00357244284444505,0.00383507536602303,0.00372176028218878,0.00373263572287093,0.00422479427132809,0.00413416710718306,0.00356515252469073,0.00368511939145737,0.00398295012394377,0.00407561662820706,0.00349290031777454,0.00338279433670571,0.00413851681399864,0.00337900221489899,0.00372241805233559,0.00349407842519893,0.00476109292708315,0.00369278977337637,0.00327358455883056,0.00380808084444302,0.00341932232179076,0.0035951781324896,0.00335753857045175,0.00464410022891177,0.00360258113990383,0.00321615529873865,0.00421010476585537,0.00349827898090526,0.00335611410817467,0.0034995445780694,0.00400787623684741,0.00334593563707061,0.00337287025700802,0.00396600090030977,0.00398024627488434,0.00363615448609513,0.00335540385333124,0.00433707728657642,0.00361357947932841,0.00372460292233345,0.00338500117232593,0.00362966599972483,0.00396771969172435,0.00346836366133841,0.00328717260264214,0.00347396820314223,0.00390301618840796,0.003492049570968,0.00312241556274098,0.00337417604054947,0.00407008415176715,0.00380922950118705,0.00322521089697642,0.00335375228675005,0.004095681232942,0.0039206475091394,0.00332343605039884,0.00342589073674162,0.00357930479981815,0.00407553428277409,0.00349223674301384,0.00334748235013802,0.00385972116153689,0.00359064825548876,0.00325936141835521,0.00377432430514634,0.00332696071787615,0.00331905734685058,0.00393374107062403,0.00335638760180768,0.00305855787500967,0.00363538793247669,0.00362774382901311,0.00320192465993132,0.00411784310640811,0.00348651430720368,0.00378288069967776,0.00374518941749004,0.00353786581072233,0.00354702860188795,0.00358163728524534,0.00346487001516168,0.00322272332083576,0.00328310081093518,0.00391760948449842,0.00392801073220364,0.00378897437288705,0.00437306315695363,0.0035683109050818,0.00358660404021387,0.00374644480252454,0.00322326946248693,0.00331919124793795,0.00316004064161272],"mode":"markers+lines","name":"eval","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>internals &lt;- model$symbol$get.internals()
sym_state &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state&quot;))
sym_state_cell &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state_cell&quot;))
sym_output &lt;- internals$get.output(which(internals$outputs %in% &quot;loss_output&quot;))
symbol &lt;- mx.symbol.Group(sym_output, sym_state, sym_state_cell)

pred_length = 100
predict &lt;- numeric()

data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

infer.data &lt;- mx.io.arrayiter(data = data, label = label, 
                              batch.size = 1, shuffle = FALSE)

mx.symbol.bind &lt;- mxnet:::mx.symbol.bind
infer &lt;- mxnet:::mx.infer.buckets.one(infer.data = infer.data, 
                              symbol = symbol,
                              arg.params = model$arg.params, 
                              aux.params = model$aux.params, 
                              input.params = NULL,
                              ctx = ctx)

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  label = pred
  
  infer.data &lt;- mx.io.arrayiter(data = data, label = label,  
                                batch.size = 1, shuffle = FALSE)
  
  infer &lt;- mxnet:::mx.infer.buckets.one(infer.data = infer.data, 
                                symbol = symbol,
                                ctx = ctx,
                                arg.params = model$arg.params,
                                aux.params = model$aux.params,
                                input.params = list(rnn.state = infer[[2]], 
                                                    rnn.state.cell = infer[[3]]))
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
  
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

p = plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)

# plotly::export(p, file = &quot;timeseries_pred.png&quot;)
p</code></pre>
<div id="6cb1ef3691b" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="6cb1ef3691b">{"x":{"visdat":{"6cb21e8f12b":["function () ","plotlyVisDat"]},"cur_data":"6cb21e8f12b","attrs":{"6cb21e8f12b":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.531130442351019,0.732327416784544,0.883617487992479,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.680952681634838,0.468209498957317,0.223558612678636,-0.0363274236060193,-0.29373780600583,-0.531130442351019,-0.732327416784543,-0.883617487992479,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.680952681634839,-0.468209498957317,-0.223558612678636,0.0363274236060188,0.29373780600583,0.531130442351019,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060186,-0.293737806005831,-0.531130442351018,-0.732327416784544,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060185,0.293737806005831,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060184,-0.293737806005827,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060183,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060181,-0.29373780600583,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.036327423606018,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668],"mode":"lines","name":"hist","alpha":1,"sizes":[10,100],"type":"scatter"},"6cb21e8f12b.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957318,0.223558612678638,-0.0363274236060179,-0.293737806005827,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386461,-0.68095268163484,-0.468209498957318,-0.223558612678638,0.0363274236060178,0.293737806005826,0.531130442351017,0.732327416784541,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386461,0.68095268163484,0.468209498957318,0.223558612678635,-0.0363274236060141,-0.293737806005826,-0.531130442351017,-0.732327416784543,-0.883617487992479,-0.974690487640667,-0.999339941308336,-0.95588602946318,-0.84729006438646,-0.680952681634843,-0.468209498957321,-0.223558612678639,0.0363274236060175,0.29373780600583,0.531130442351014,0.73232741678454,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386462,0.68095268163484,0.468209498957318,0.223558612678635,-0.0363274236060139,-0.293737806005826,-0.531130442351017,-0.732327416784543,-0.883617487992476,-0.974690487640667,-0.999339941308336,-0.95588602946318,-0.84729006438646,-0.680952681634843,-0.468209498957321,-0.223558612678639,0.0363274236060173,0.293737806005829,0.531130442351014,0.73232741678454,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386462,0.680952681634841,0.468209498957318,0.223558612678642,-0.0363274236060136,-0.293737806005826,-0.531130442351017,-0.732327416784543,-0.883617487992476,-0.974690487640667,-0.999339941308336,-0.95588602946318,-0.84729006438646,-0.680952681634843,-0.468209498957322,-0.223558612678639,0.036327423606017,0.293737806005829,0.531130442351014,0.73232741678454,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386462,0.680952681634841],"mode":"lines","name":"real","alpha":1,"sizes":[10,100],"type":"scatter"},"6cb21e8f12b.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.959930300712585,0.893717885017395,0.784646391868591,0.61908221244812,0.388546049594879,0.0866983309388161,-0.233842819929123,-0.51024055480957,-0.748635232448578,-0.916138589382172,-1.0222977399826,-1.06522536277771,-1.01755177974701,-0.905198931694031,-0.750120759010315,-0.564414858818054,-0.367487251758575,-0.185627430677414,-0.0610476583242416,-0.0187508538365364,-0.0548965223133564,-0.22749650478363,-0.626682460308075,-0.877080202102661,-1.00487220287323,-1.03845989704132,-0.986639499664307,-0.878527462482452,-0.727801084518433,-0.545783996582031,-0.353310883045197,-0.17847266793251,-0.0663027688860893,-0.0473912470042706,-0.158492207527161,-0.52390730381012,-0.828925848007202,-0.987207889556885,-1.03886485099792,-0.999899983406067,-0.900257587432861,-0.757315874099731,-0.580541491508484,-0.388934195041656,-0.208783239126205,-0.0829931050539017,-0.0499115437269211,-0.145889073610306,-0.496386468410492,-0.815743207931519,-0.98205828666687,-1.03853237628937,-1.00312209129333,-0.905768692493439,-0.764939963817596,-0.589673399925232,-0.398440003395081,-0.217131763696671,-0.0878814607858658,-0.0508677661418915,-0.142587408423424,-0.488432854413986,-0.811864852905273,-0.980488777160645,-1.0383894443512,-1.0040568113327,-0.90739381313324,-0.767195224761963,-0.592381298542023,-0.401265323162079,-0.219626724720001,-0.0893530920147896,-0.051128663122654,-0.141447201371193,-0.485639452934265,-0.810477912425995,-0.979908406734467,-1.03833532333374,-1.00441360473633,-0.908010959625244,-0.768045008182526,-0.593396425247192,-0.402320563793182,-0.220555007457733,-0.0898913741111755,-0.0511864945292473,-0.140876203775406,-0.484253227710724,-0.809775292873383,-0.97960352897644,-1.03830826282501,-1.00461184978485,-0.908350169658661,-0.768507361412048,-0.593944787979126,-0.402887552976608,-0.221050649881363,-0.0901718586683273,-0.051192183047533,-0.140480935573578],"mode":"lines","name":"pred","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.531130442351019,0.732327416784544,0.883617487992479,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.680952681634838,0.468209498957317,0.223558612678636,-0.0363274236060193,-0.29373780600583,-0.531130442351019,-0.732327416784543,-0.883617487992479,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.680952681634839,-0.468209498957317,-0.223558612678636,0.0363274236060188,0.29373780600583,0.531130442351019,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060186,-0.293737806005831,-0.531130442351018,-0.732327416784544,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060185,0.293737806005831,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060184,-0.293737806005827,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.0363274236060183,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668,0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957317,0.223558612678638,-0.0363274236060181,-0.29373780600583,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386459,-0.68095268163484,-0.468209498957317,-0.223558612678638,0.036327423606018,0.29373780600583,0.531130442351018,0.732327416784543,0.883617487992478,0.974690487640668],"mode":"lines","name":"hist","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.999339941308336,0.955886029463179,0.847290064386459,0.68095268163484,0.468209498957318,0.223558612678638,-0.0363274236060179,-0.293737806005827,-0.531130442351018,-0.732327416784543,-0.883617487992478,-0.974690487640668,-0.999339941308336,-0.955886029463179,-0.847290064386461,-0.68095268163484,-0.468209498957318,-0.223558612678638,0.0363274236060178,0.293737806005826,0.531130442351017,0.732327416784541,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386461,0.68095268163484,0.468209498957318,0.223558612678635,-0.0363274236060141,-0.293737806005826,-0.531130442351017,-0.732327416784543,-0.883617487992479,-0.974690487640667,-0.999339941308336,-0.95588602946318,-0.84729006438646,-0.680952681634843,-0.468209498957321,-0.223558612678639,0.0363274236060175,0.29373780600583,0.531130442351014,0.73232741678454,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386462,0.68095268163484,0.468209498957318,0.223558612678635,-0.0363274236060139,-0.293737806005826,-0.531130442351017,-0.732327416784543,-0.883617487992476,-0.974690487640667,-0.999339941308336,-0.95588602946318,-0.84729006438646,-0.680952681634843,-0.468209498957321,-0.223558612678639,0.0363274236060173,0.293737806005829,0.531130442351014,0.73232741678454,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386462,0.680952681634841,0.468209498957318,0.223558612678642,-0.0363274236060136,-0.293737806005826,-0.531130442351017,-0.732327416784543,-0.883617487992476,-0.974690487640667,-0.999339941308336,-0.95588602946318,-0.84729006438646,-0.680952681634843,-0.468209498957322,-0.223558612678639,0.036327423606017,0.293737806005829,0.531130442351014,0.73232741678454,0.883617487992477,0.974690487640668,0.999339941308336,0.955886029463181,0.847290064386462,0.680952681634841],"mode":"lines","name":"real","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.959930300712585,0.893717885017395,0.784646391868591,0.61908221244812,0.388546049594879,0.0866983309388161,-0.233842819929123,-0.51024055480957,-0.748635232448578,-0.916138589382172,-1.0222977399826,-1.06522536277771,-1.01755177974701,-0.905198931694031,-0.750120759010315,-0.564414858818054,-0.367487251758575,-0.185627430677414,-0.0610476583242416,-0.0187508538365364,-0.0548965223133564,-0.22749650478363,-0.626682460308075,-0.877080202102661,-1.00487220287323,-1.03845989704132,-0.986639499664307,-0.878527462482452,-0.727801084518433,-0.545783996582031,-0.353310883045197,-0.17847266793251,-0.0663027688860893,-0.0473912470042706,-0.158492207527161,-0.52390730381012,-0.828925848007202,-0.987207889556885,-1.03886485099792,-0.999899983406067,-0.900257587432861,-0.757315874099731,-0.580541491508484,-0.388934195041656,-0.208783239126205,-0.0829931050539017,-0.0499115437269211,-0.145889073610306,-0.496386468410492,-0.815743207931519,-0.98205828666687,-1.03853237628937,-1.00312209129333,-0.905768692493439,-0.764939963817596,-0.589673399925232,-0.398440003395081,-0.217131763696671,-0.0878814607858658,-0.0508677661418915,-0.142587408423424,-0.488432854413986,-0.811864852905273,-0.980488777160645,-1.0383894443512,-1.0040568113327,-0.90739381313324,-0.767195224761963,-0.592381298542023,-0.401265323162079,-0.219626724720001,-0.0893530920147896,-0.051128663122654,-0.141447201371193,-0.485639452934265,-0.810477912425995,-0.979908406734467,-1.03833532333374,-1.00441360473633,-0.908010959625244,-0.768045008182526,-0.593396425247192,-0.402320563793182,-0.220555007457733,-0.0898913741111755,-0.0511864945292473,-0.140876203775406,-0.484253227710724,-0.809775292873383,-0.97960352897644,-1.03830826282501,-1.00461184978485,-0.908350169658661,-0.768507361412048,-0.593944787979126,-0.402887552976608,-0.221050649881363,-0.0901718586683273,-0.051192183047533,-0.140480935573578],"mode":"lines","name":"pred","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
