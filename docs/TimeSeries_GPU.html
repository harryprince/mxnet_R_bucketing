<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Time-Series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<script src="site_libs/viz-0.3/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="site_libs/grViz-binding-0.9.2/grViz.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="navigation">
  <div class="container">
  <div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
    <i class="fa fa-bars fa-lg fa-inverse"></i>
  </button>
  <a class="navbar-brand" href="index.html">MXNET R</a>
  </div>
  
  <div id="navbar" class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Language Model<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="LanguageModel_GPU.html">GPU</a></li>
        <li><a href="LanguageModel_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">NLP Classification<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="NLP_Classification_GPU.html">GPU</a></li>
        <li><a href="NLP_Classification_CPU.html">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Time Series<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="TimeSeries_GPU">GPU</a></li>
        <li><a href="TimeSeries_CPU">CPU</a></li>
        </ul>
  </li>
  
  <li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown">Translation<b class="caret"></b></a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="">GPU</a></li>
        <li><a href="">CPU</a></li>
        </ul>
  </li>
  
  <li><a href="">CNN NLP Classification</a></li>
  
  </ul>
  
  <ul class="nav navbar-nav navbar-right">
    <li class=navbar-right><a href="mailto:nimus44@gmail.com" ><i class="fa fa-envelope fa-lg"></i></a></li>
    <li class=navbar-right><a href="https://github.com/jeremiedb" ><i class="fa fa-github fa-lg"></i></a></li>
  </ul>
  
  </div><!--/.nav-collapse -->
  </div><!--/.container -->
  </nav><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Time-Series</h1>

</div>


<p>This is a minimalistic demo on how to model time-series with RNN, including training and inference.</p>
<pre class="r"><code>library(&quot;readr&quot;)
library(&quot;dplyr&quot;)
library(&quot;plotly&quot;)
library(&quot;mxnet&quot;)</code></pre>
<div id="data-preparation" class="section level3">
<h3>Data preparation</h3>
<pre class="r"><code>seq_len = 100
samples = 192

seeds &lt;- runif(samples, min = -pi, max = pi)
pts &lt;- sapply(seeds, function(x) sin(x + pi/12 * (0:(seq_len))))

x &lt;- pts[1:seq_len, ]
x &lt;- array(x, dim = c(1, seq_len, samples))
y &lt;- pts[-1, ]

p1 = plot_ly(x = 1:dim(x)[2], y = x[1,,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,3], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,4], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;% 
  add_trace(x = 1:dim(x)[2], y = x[1,,5], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p2 = plot_ly(x = 1:length(y[,1]), y = y[,1], type = &quot;scatter&quot;, mode = &quot;lines&quot;) %&gt;%
  add_trace(x = 1:length(y[,2]), y = y[,2], type = &quot;scatter&quot;, mode = &quot;lines&quot;)

p1</code></pre>
<div id="1a2efb5507a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="1a2efb5507a">{"x":{"visdat":{"1a2e37521f18":["function () ","plotlyVisDat"]},"cur_data":"1a2e37521f18","attrs":{"1a2e37521f18":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.636921527031719,0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049163,-0.16612590248677,-0.415687937760018,-0.636921527031719,-0.814749966798797,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.77092864027975,-0.579812462440537,-0.3491830234714,-0.0947573385049164,0.16612590248677,0.415687937760018,0.636921527031719,0.814749966798797,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049183,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.770928640279749,-0.579812462440538,-0.349183023471399,-0.0947573385049184,0.16612590248677,0.415687937760016,0.636921527031718,0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471399,0.0947573385049186,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200554,-0.986104550503118,-0.909507305303714,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049187,0.166125902486766,0.415687937760016,0.636921527031718,0.814749966798795,0.93705454276652,0.995500400200554,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471403,0.0947573385049188,-0.166125902486766,-0.415687937760016,-0.636921527031717,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503118,-0.909507305303716,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049189,0.166125902486766,0.415687937760016,0.636921527031717,0.814749966798795,0.937054542766519,0.995500400200554],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"1a2e37521f18.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.857892609238201,-0.695671888821164,-0.486042278833119,-0.24328969076544,0.0160426876726797,0.274281783457701,0.513829028972159,0.718359675304783,0.87393529691088,0.969953672278865,0.999871307805278,0.961649366070224,0.857892609238201,0.695671888821164,0.486042278833119,0.243289690765441,-0.0160426876726794,-0.274281783457701,-0.513829028972159,-0.718359675304783,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070224,-0.857892609238201,-0.695671888821164,-0.48604227883312,-0.243289690765441,0.0160426876726792,0.2742817834577,0.513829028972158,0.718359675304783,0.87393529691088,0.969953672278865,0.999871307805278,0.961649366070224,0.857892609238201,0.695671888821164,0.48604227883312,0.243289690765441,-0.0160426876726782,-0.2742817834577,-0.513829028972159,-0.718359675304783,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070224,-0.857892609238201,-0.695671888821165,-0.48604227883312,-0.243289690765441,0.0160426876726781,0.274281783457699,0.513829028972157,0.718359675304783,0.87393529691088,0.969953672278865,0.999871307805278,0.961649366070224,0.857892609238202,0.695671888821165,0.48604227883312,0.243289690765443,-0.016042687672678,-0.274281783457701,-0.513829028972156,-0.718359675304782,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070225,-0.857892609238202,-0.695671888821165,-0.486042278833118,-0.243289690765445,0.0160426876726761,0.274281783457699,0.513829028972158,0.718359675304784,0.873935296910878,0.969953672278865,0.999871307805278,0.961649366070224,0.8578926092382,0.695671888821167,0.486042278833122,0.243289690765442,-0.0160426876726795,-0.274281783457696,-0.513829028972155,-0.718359675304781,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070225,-0.857892609238202,-0.695671888821165,-0.486042278833119,-0.243289690765445],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"1a2e37521f18.2":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239607,-0.715590817291615,-0.510417447714938,-0.270459972581203,-0.0120710972722969,0.247140403367285,0.489509693936214,0.698519707816407,0.85992675796731,0.9627312206589,0.999927141651152,0.968979680397611,0.871997855239607,0.715590817291615,0.510417447714939,0.270459972581203,0.0120710972722973,-0.247140403367284,-0.489509693936214,-0.698519707816407,-0.85992675796731,-0.962731220658899,-0.999927141651152,-0.968979680397611,-0.871997855239607,-0.715590817291615,-0.510417447714939,-0.270459972581204,-0.0120710972722974,0.247140403367284,0.489509693936213,0.698519707816406,0.859926757967309,0.962731220658899,0.999927141651152,0.968979680397611,0.871997855239608,0.715590817291615,0.51041744771494,0.270459972581204,0.0120710972722966,-0.247140403367283,-0.489509693936213,-0.698519707816406,-0.859926757967309,-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239608,-0.715590817291615,-0.51041744771494,-0.270459972581205,-0.0120710972722968,0.247140403367283,0.489509693936213,0.698519707816406,0.859926757967309,0.962731220658899,0.999927141651152,0.968979680397611,0.871997855239608,0.715590817291615,0.510417447714938,0.270459972581205,0.0120710972722969,-0.247140403367283,-0.489509693936213,-0.698519707816405,-0.859926757967309,-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239608,-0.715590817291615,-0.510417447714938,-0.270459972581205,-0.012071097272297,0.247140403367283,0.489509693936213,0.698519707816405,0.859926757967309,0.9627312206589,0.999927141651152,0.968979680397611,0.871997855239608,0.715590817291615,0.510417447714941,0.270459972581205,0.0120710972722971,-0.247140403367283,-0.489509693936213,-0.698519707816405,-0.859926757967309,-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239608],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"1a2e37521f18.3":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.522671490051539,-0.284209810734213,-0.0263797024942707,0.233248138876137,0.476980505042911,0.688207438038564,0.852534171448455,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942726,0.725513971077329,0.522671490051539,0.284209810734214,0.026379702494271,-0.233248138876136,-0.47698050504291,-0.688207438038564,-0.852534171448455,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942726,-0.72551397107733,-0.52267149005154,-0.284209810734214,-0.026379702494272,0.233248138876135,0.476980505042911,0.688207438038564,0.852534171448455,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942727,0.725513971077331,0.52267149005154,0.284209810734215,0.0263797024942721,-0.233248138876135,-0.476980505042909,-0.688207438038563,-0.852534171448455,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942727,-0.725513971077331,-0.52267149005154,-0.284209810734215,-0.0263797024942722,0.233248138876135,0.476980505042909,0.688207438038562,0.852534171448454,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942727,0.725513971077331,0.522671490051541,0.284209810734215,0.0263797024942724,-0.233248138876133,-0.47698050504291,-0.688207438038565,-0.852534171448455,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942727,-0.72551397107733,-0.522671490051538,-0.284209810734215,-0.0263797024942707,0.233248138876135,0.47698050504291,0.688207438038565,0.852534171448455,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942727,0.72551397107733,0.522671490051539,0.284209810734215,0.0263797024942708,-0.233248138876135,-0.47698050504291,-0.688207438038562,-0.852534171448454,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942727,-0.72551397107733,-0.522671490051539,-0.284209810734215,-0.0263797024942709,0.233248138876135],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"},"1a2e37521f18.4":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.698292167075829,0.489232437782849,0.246832326349797,-0.012389000214287,-0.270766036887558,-0.510690815608975,-0.715812859203117,-0.872153439379247,-0.969058203963388,-0.999923253391824,-0.962645185552915,-0.859764439164961,-0.69829216707583,-0.489232437782849,-0.246832326349798,0.012389000214286,0.270766036887558,0.510690815608975,0.715812859203117,0.872153439379247,0.969058203963388,0.999923253391824,0.962645185552914,0.859764439164962,0.69829216707583,0.489232437782849,0.246832326349798,-0.0123890002142859,-0.270766036887557,-0.510690815608976,-0.715812859203116,-0.872153439379247,-0.969058203963388,-0.999923253391824,-0.962645185552915,-0.859764439164962,-0.69829216707583,-0.489232437782849,-0.246832326349798,0.0123890002142857,0.270766036887557,0.510690815608974,0.715812859203117,0.872153439379247,0.969058203963388,0.999923253391824,0.962645185552915,0.859764439164962,0.69829216707583,0.489232437782849,0.246832326349798,-0.0123890002142856,-0.270766036887557,-0.510690815608975,-0.715812859203116,-0.872153439379247,-0.969058203963387,-0.999923253391824,-0.962645185552915,-0.859764439164962,-0.698292167075832,-0.489232437782851,-0.246832326349798,0.0123890002142837,0.270766036887557,0.510690815608975,0.715812859203116,0.872153439379247,0.969058203963387,0.999923253391824,0.962645185552916,0.859764439164962,0.69829216707583,0.489232437782851,0.246832326349799,-0.0123890002142836,-0.270766036887557,-0.510690815608975,-0.715812859203116,-0.872153439379247,-0.969058203963387,-0.999923253391824,-0.962645185552916,-0.859764439164962,-0.69829216707583,-0.489232437782851,-0.246832326349799,0.0123890002142835,0.270766036887556,0.510690815608972,0.715812859203115,0.872153439379247,0.969058203963387,0.999923253391824,0.962645185552916,0.859764439164962,0.69829216707583,0.489232437782851,0.246832326349799,-0.0123890002142833],"mode":"lines","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.636921527031719,0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049163,-0.16612590248677,-0.415687937760018,-0.636921527031719,-0.814749966798797,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.77092864027975,-0.579812462440537,-0.3491830234714,-0.0947573385049164,0.16612590248677,0.415687937760018,0.636921527031719,0.814749966798797,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049183,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.770928640279749,-0.579812462440538,-0.349183023471399,-0.0947573385049184,0.16612590248677,0.415687937760016,0.636921527031718,0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471399,0.0947573385049186,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200554,-0.986104550503118,-0.909507305303714,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049187,0.166125902486766,0.415687937760016,0.636921527031718,0.814749966798795,0.93705454276652,0.995500400200554,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471403,0.0947573385049188,-0.166125902486766,-0.415687937760016,-0.636921527031717,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503118,-0.909507305303716,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049189,0.166125902486766,0.415687937760016,0.636921527031717,0.814749966798795,0.937054542766519,0.995500400200554],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.857892609238201,-0.695671888821164,-0.486042278833119,-0.24328969076544,0.0160426876726797,0.274281783457701,0.513829028972159,0.718359675304783,0.87393529691088,0.969953672278865,0.999871307805278,0.961649366070224,0.857892609238201,0.695671888821164,0.486042278833119,0.243289690765441,-0.0160426876726794,-0.274281783457701,-0.513829028972159,-0.718359675304783,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070224,-0.857892609238201,-0.695671888821164,-0.48604227883312,-0.243289690765441,0.0160426876726792,0.2742817834577,0.513829028972158,0.718359675304783,0.87393529691088,0.969953672278865,0.999871307805278,0.961649366070224,0.857892609238201,0.695671888821164,0.48604227883312,0.243289690765441,-0.0160426876726782,-0.2742817834577,-0.513829028972159,-0.718359675304783,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070224,-0.857892609238201,-0.695671888821165,-0.48604227883312,-0.243289690765441,0.0160426876726781,0.274281783457699,0.513829028972157,0.718359675304783,0.87393529691088,0.969953672278865,0.999871307805278,0.961649366070224,0.857892609238202,0.695671888821165,0.48604227883312,0.243289690765443,-0.016042687672678,-0.274281783457701,-0.513829028972156,-0.718359675304782,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070225,-0.857892609238202,-0.695671888821165,-0.486042278833118,-0.243289690765445,0.0160426876726761,0.274281783457699,0.513829028972158,0.718359675304784,0.873935296910878,0.969953672278865,0.999871307805278,0.961649366070224,0.8578926092382,0.695671888821167,0.486042278833122,0.243289690765442,-0.0160426876726795,-0.274281783457696,-0.513829028972155,-0.718359675304781,-0.87393529691088,-0.969953672278865,-0.999871307805278,-0.961649366070225,-0.857892609238202,-0.695671888821165,-0.486042278833119,-0.243289690765445],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239607,-0.715590817291615,-0.510417447714938,-0.270459972581203,-0.0120710972722969,0.247140403367285,0.489509693936214,0.698519707816407,0.85992675796731,0.9627312206589,0.999927141651152,0.968979680397611,0.871997855239607,0.715590817291615,0.510417447714939,0.270459972581203,0.0120710972722973,-0.247140403367284,-0.489509693936214,-0.698519707816407,-0.85992675796731,-0.962731220658899,-0.999927141651152,-0.968979680397611,-0.871997855239607,-0.715590817291615,-0.510417447714939,-0.270459972581204,-0.0120710972722974,0.247140403367284,0.489509693936213,0.698519707816406,0.859926757967309,0.962731220658899,0.999927141651152,0.968979680397611,0.871997855239608,0.715590817291615,0.51041744771494,0.270459972581204,0.0120710972722966,-0.247140403367283,-0.489509693936213,-0.698519707816406,-0.859926757967309,-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239608,-0.715590817291615,-0.51041744771494,-0.270459972581205,-0.0120710972722968,0.247140403367283,0.489509693936213,0.698519707816406,0.859926757967309,0.962731220658899,0.999927141651152,0.968979680397611,0.871997855239608,0.715590817291615,0.510417447714938,0.270459972581205,0.0120710972722969,-0.247140403367283,-0.489509693936213,-0.698519707816405,-0.859926757967309,-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239608,-0.715590817291615,-0.510417447714938,-0.270459972581205,-0.012071097272297,0.247140403367283,0.489509693936213,0.698519707816405,0.859926757967309,0.9627312206589,0.999927141651152,0.968979680397611,0.871997855239608,0.715590817291615,0.510417447714941,0.270459972581205,0.0120710972722971,-0.247140403367283,-0.489509693936213,-0.698519707816405,-0.859926757967309,-0.9627312206589,-0.999927141651152,-0.968979680397611,-0.871997855239608],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-0.522671490051539,-0.284209810734213,-0.0263797024942707,0.233248138876137,0.476980505042911,0.688207438038564,0.852534171448455,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942726,0.725513971077329,0.522671490051539,0.284209810734214,0.026379702494271,-0.233248138876136,-0.47698050504291,-0.688207438038564,-0.852534171448455,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942726,-0.72551397107733,-0.52267149005154,-0.284209810734214,-0.026379702494272,0.233248138876135,0.476980505042911,0.688207438038564,0.852534171448455,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942727,0.725513971077331,0.52267149005154,0.284209810734215,0.0263797024942721,-0.233248138876135,-0.476980505042909,-0.688207438038563,-0.852534171448455,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942727,-0.725513971077331,-0.52267149005154,-0.284209810734215,-0.0263797024942722,0.233248138876135,0.476980505042909,0.688207438038562,0.852534171448454,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942727,0.725513971077331,0.522671490051541,0.284209810734215,0.0263797024942724,-0.233248138876133,-0.47698050504291,-0.688207438038565,-0.852534171448455,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942727,-0.72551397107733,-0.522671490051538,-0.284209810734215,-0.0263797024942707,0.233248138876135,0.47698050504291,0.688207438038565,0.852534171448455,0.958762109953466,0.99965199509445,0.972417248772778,0.878913873942727,0.72551397107733,0.522671490051539,0.284209810734215,0.0263797024942708,-0.233248138876135,-0.47698050504291,-0.688207438038562,-0.852534171448454,-0.958762109953466,-0.99965199509445,-0.972417248772778,-0.878913873942727,-0.72551397107733,-0.522671490051539,-0.284209810734215,-0.0263797024942709,0.233248138876135],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.698292167075829,0.489232437782849,0.246832326349797,-0.012389000214287,-0.270766036887558,-0.510690815608975,-0.715812859203117,-0.872153439379247,-0.969058203963388,-0.999923253391824,-0.962645185552915,-0.859764439164961,-0.69829216707583,-0.489232437782849,-0.246832326349798,0.012389000214286,0.270766036887558,0.510690815608975,0.715812859203117,0.872153439379247,0.969058203963388,0.999923253391824,0.962645185552914,0.859764439164962,0.69829216707583,0.489232437782849,0.246832326349798,-0.0123890002142859,-0.270766036887557,-0.510690815608976,-0.715812859203116,-0.872153439379247,-0.969058203963388,-0.999923253391824,-0.962645185552915,-0.859764439164962,-0.69829216707583,-0.489232437782849,-0.246832326349798,0.0123890002142857,0.270766036887557,0.510690815608974,0.715812859203117,0.872153439379247,0.969058203963388,0.999923253391824,0.962645185552915,0.859764439164962,0.69829216707583,0.489232437782849,0.246832326349798,-0.0123890002142856,-0.270766036887557,-0.510690815608975,-0.715812859203116,-0.872153439379247,-0.969058203963387,-0.999923253391824,-0.962645185552915,-0.859764439164962,-0.698292167075832,-0.489232437782851,-0.246832326349798,0.0123890002142837,0.270766036887557,0.510690815608975,0.715812859203116,0.872153439379247,0.969058203963387,0.999923253391824,0.962645185552916,0.859764439164962,0.69829216707583,0.489232437782851,0.246832326349799,-0.0123890002142836,-0.270766036887557,-0.510690815608975,-0.715812859203116,-0.872153439379247,-0.969058203963387,-0.999923253391824,-0.962645185552916,-0.859764439164962,-0.69829216707583,-0.489232437782851,-0.246832326349799,0.0123890002142835,0.270766036887556,0.510690815608972,0.715812859203115,0.872153439379247,0.969058203963387,0.999923253391824,0.962645185552916,0.859764439164962,0.69829216707583,0.489232437782851,0.246832326349799,-0.0123890002142833],"mode":"lines","type":"scatter","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="create-data-iterators" class="section level3">
<h3>Create data iterators</h3>
<pre class="r"><code>batch.size = 16

train.data &lt;- mx.io.arrayiter(data = x[,,1:160, drop = F], label = y[, 1:160], 
                              batch.size = batch.size, shuffle = TRUE)

eval.data &lt;- mx.io.arrayiter(data = x[,,-(1:160), drop = F], label = y[, -(1:160)], 
                              batch.size = batch.size, shuffle = FALSE)</code></pre>
</div>
<div id="model-architecture" class="section level3">
<h3>Model architecture</h3>
<pre class="r"><code>symbol &lt;- rnn.graph(num_rnn_layer =  2, 
                    num_hidden = 50,
                    input_size = NULL,
                    num_embed = NULL, 
                    num_decode = 1,
                    masking = F, 
                    loss_output = &quot;linear&quot;,
                    dropout = 0.2, 
                    ignore_label = -1,
                    cell_type = &quot;lstm&quot;,
                    output_last_state = T,
                    config = &quot;one-to-one&quot;)

graph.viz(symbol, type = &quot;graph&quot;, direction = &quot;LR&quot;, 
          shape=list(data = c(1, seq_len, batch.size), 
                     label = c(seq_len, batch.size)),
          graph.width.px = 800, graph.height.px = 220)</code></pre>
<div id="htmlwidget-c738205ed58205707c9b" style="width:800px;height:220px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-c738205ed58205707c9b">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\n\n  \"1\" [label = \"data\ndata\", shape = \"oval\", penwidth = \"2\", color = \"#8dd3c7\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#8DD3C7FF\"] \n  \"2\" [label = \"SwapAxis\nswap_pre\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"3\" [label = \"RNN\nRNN\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"4\" [label = \"_copy\nmask\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"5\" [label = \"SwapAxis\nswap_post\", shape = \"box\", penwidth = \"2\", color = \"#fccde5\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FCCDE5FF\"] \n  \"6\" [label = \"Reshape\nreshape0\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"7\" [label = \"FullyConnected\ndecode\n1\", shape = \"box\", penwidth = \"2\", color = \"#fb8072\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FB8072FF\"] \n  \"8\" [label = \"Reshape\nreshape1\", shape = \"oval\", penwidth = \"2\", color = \"#fdb462\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#FDB462FF\"] \n  \"9\" [label = \"LinearRegressionOutput\nloss\", shape = \"box\", penwidth = \"2\", color = \"#b3de69\", style = \"filled\", fontcolor = \"black\", fillcolor = \"#B3DE69FF\"] \n\"1\"->\"2\" [id = \"1\", color = \"black\", fontcolor = \"black\", label = \"1X100X16\"] \n\"2\"->\"3\" [id = \"2\", color = \"black\", fontcolor = \"black\", label = \"1X16X100\"] \n\"3\"->\"4\" [id = \"3\", color = \"black\", fontcolor = \"black\", label = \"50X16X100\"] \n\"4\"->\"5\" [id = \"4\", color = \"black\", fontcolor = \"black\", label = \"50X16X100\"] \n\"5\"->\"6\" [id = \"5\", color = \"black\", fontcolor = \"black\", label = \"50X100X16\"] \n\"6\"->\"7\" [id = \"6\", color = \"black\", fontcolor = \"black\", label = \"50X1600\"] \n\"7\"->\"9\" [id = \"7\", color = \"black\", fontcolor = \"black\", label = \"1X1600\"] \n\"8\"->\"9\" [id = \"8\", color = \"black\", fontcolor = \"black\", label = \"1600\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fit-a-lstm-model" class="section level3">
<h3>Fit a LSTM model</h3>
<p>Needs a custom metric to handle labels in a matrix rather than flat format in the iterator.</p>
<pre class="r"><code>mx.metric.mse.seq &lt;- mx.metric.custom(&quot;Perplexity&quot;, function(label, pred) {
  label = mx.nd.reshape(mx.nd.array(label), shape = -1)
  label = as.array(label)
  res &lt;- mean((label-pred)^2)
  return(res)
})</code></pre>
<pre class="r"><code>ctx &lt;- mx.gpu()

initializer &lt;- mx.init.Xavier(rnd_type = &quot;gaussian&quot;, 
                              factor_type = &quot;avg&quot;, 
                              magnitude = 3)

optimizer &lt;- mx.opt.create(&quot;adadelta&quot;, rho = 0.9, eps = 1e-5, wd = 1e-6,
                           clip_gradient = 1, rescale.grad = 1/batch.size)

logger &lt;- mx.metric.logger()
epoch.end.callback &lt;- mx.callback.log.train.metric(period = 10, logger = logger)

system.time(
  model &lt;- mx.model.buckets(symbol = symbol,
                            train.data = train.data, 
                            eval.data = eval.data, 
                            num.round = 250, ctx = ctx, verbose = TRUE,
                            metric = mx.metric.mse.seq, 
                            initializer = initializer, optimizer = optimizer, 
                            batch.end.callback = NULL, 
                            epoch.end.callback = epoch.end.callback)
)</code></pre>
<pre><code>##    user  system elapsed 
##  53.120   5.784  48.206</code></pre>
<pre class="r"><code>plot_ly(x = seq_len(length(logger$train)), y = logger$train, type = &quot;scatter&quot;, 
        mode = &quot;markers+lines&quot;, name = &quot;train&quot;) %&gt;% 
  add_trace(y = logger$eval, type = &quot;scatter&quot;, 
            mode = &quot;markers+lines&quot;, name = &quot;eval&quot;)</code></pre>
<div id="1a2e1a1ba20b" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="1a2e1a1ba20b">{"x":{"visdat":{"1a2e2f3fa0ec":["function () ","plotlyVisDat"]},"cur_data":"1a2e2f3fa0ec","attrs":{"1a2e2f3fa0ec":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.33947370557083,0.126932523336098,0.0605109320908745,0.0438486682860469,0.0363201629635122,0.0306134137571763,0.023681540181377,0.0313601756255646,0.0270340286818498,0.0197056443477959,0.0185462237699809,0.0188654700517811,0.022148302966605,0.017487662872167,0.0180816096965734,0.0225396529090779,0.0281368023850545,0.0163406785622062,0.0200921918719323,0.0186118075159256,0.0163193002960377,0.0160159933685128,0.0160122155789618,0.0156508538651162,0.020829688499135,0.0158570471538782,0.0133399771517863,0.0136542971191009,0.0126023641398121,0.0163107762421581,0.0172473090147671,0.0130471291665788,0.011871156867417,0.0128942544220939,0.0135051683999706,0.0104167569551552,0.00962066282284557,0.00929438413816732,0.0128197095708329,0.0123268589332741,0.0101877951705522,0.00927790535114148,0.00944427000816496,0.00995295207442592,0.0086904401104773,0.0106322606044099,0.0110211214066575,0.00938067943059449,0.00874783923036434,0.0077766129575376,0.00943257813844605,0.00885318727740173,0.00819150962814974,0.00845990265109782,0.00901784647345388,0.00760053015955434,0.00760383263657642,0.00709367298069092,0.00799939978973388,0.00887492006746803,0.00766403811777124,0.00660507532527902,0.00603347669476783,0.0071559371530737,0.00691866202640355,0.00630390991212404,0.00741216304510522,0.00658019949181104,0.00621947772268564,0.00610663454321039,0.00778841199466391,0.00689402979203527,0.00633183604773338,0.00616116055733762,0.00570068999457079,0.00671531486824822,0.00642642326450351,0.00582421592153799,0.0065836392449294,0.00602533409808551,0.00539937972574506,0.00586993584619623,0.00562304770098494,0.00643061449356009,0.00609400812361201,0.0055201112865883,0.0059693111013331,0.00599005124827657,0.00526584370928137,0.00535093449027302,0.00492290678732933,0.00576874470446977,0.00543720006600983,0.0048660272571936,0.00542128953878303,0.00584246141207153,0.0058332057977833,0.00507447204402007,0.00476436314392275,0.00532995970986989,0.0057724989384795,0.00548241696797159,0.00484049879967169,0.00469469993515741,0.00487991077819699,0.00533947025329096,0.00535022285139,0.00514873111943732,0.0049723325430079,0.00544905568295105,0.00507305898687505,0.00456122553240945,0.00489562568742159,0.00516604105728182,0.00514074455339791,0.00460971806558267,0.00451562530625322,0.00509579599489974,0.00535006257079921,0.00506150295229306,0.00452179608197908,0.00485688865907636,0.0049711101841732,0.00491382801469743,0.0046171204995588,0.0043455450000846,0.00504214030565301,0.00508600706832233,0.00474807302427716,0.00450130556419438,0.00464103539481781,0.00482021639577525,0.00502800450972356,0.00465783880559911,0.00428748904841802,0.00457182290291726,0.00451517625139506,0.0048924871465022,0.00497276764877871,0.00428060950322387,0.00434920939025998,0.00473826572062136,0.00499979227410087,0.00455938022929884,0.00434441991172444,0.00430831991104514,0.00470344688678064,0.0044936753681842,0.00474641073314001,0.00423528680124961,0.00425490749260226,0.00468182100081172,0.004927316425434,0.00443299416222295,0.00429049759465765,0.00432771144822367,0.00446131344365114,0.00449855357044034,0.00511475051613079,0.00448047508912044,0.00443124115743403,0.00430379472365449,0.00420055308087432,0.0044517836840085,0.00450767229067492,0.00449205270105639,0.00529165215946743,0.00503319372662296,0.00458769163526266,0.00472884555554867,0.00433371358023284,0.00461659341711808,0.0045100373557962,0.00449613788658217,0.00413312981160203,0.0042673321396068,0.00405402147781594,0.00441149833862449,0.00457148795621681,0.00475656481757228,0.00420732821082662,0.00426584101980166,0.00383609189217031,0.00425646532579851,0.00427710500091404,0.00435736895881194,0.00467539841812588,0.00459310233993895,0.00404070073850955,0.00400018183355137,0.00390227423518779,0.00453449286036535,0.00415804514466722,0.00448815341372807,0.00409430912231462,0.00402426838411925,0.00406097682013682,0.00411156392961387,0.00445198243779762,0.00445659325903647,0.00432786330688857,0.00456625112695221,0.00385345323704408,0.0044271800211614,0.00422347054233139,0.00409891558728673,0.00407246716081168,0.00452632362468214,0.00394917953558113,0.0039834456098259,0.00421164820669448,0.00423761226112435,0.0039818688521711,0.00432352951393514,0.00428519800321908,0.00431798642837456,0.0043050441666057,0.00386877812803446,0.00441621386496962,0.00410478902909185,0.00456395911213078,0.0041568367195714,0.0041896662857413,0.00449333892199726,0.00415942973439699,0.00409013108086923,0.00412686758862485,0.0042293086690741,0.00400989748499484,0.00424322845560709,0.0041267016583919,0.00442824727117539,0.00420512398654703,0.00391945191363086,0.00416253599285765,0.00426946065581294,0.00427852309676389,0.00426953582613541,0.00415746921196677,0.00436073584149123,0.00423036440477721,0.00394581445138208,0.0040494581729021,0.00392610178585992,0.00450428188328618,0.00444594112510292,0.00425054321264109,0.00408730979776782,0.00419855127814714,0.00405230168282009],"mode":"markers+lines","name":"train","alpha":1,"sizes":[10,100],"type":"scatter"},"1a2e2f3fa0ec.1":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.166791623579304,0.0348596355178963,0.0379625475968033,0.017191662563844,0.0524181750986577,0.0286728156598998,0.021490765613732,0.0330995878078347,0.0240716636566385,0.0202382909612115,0.0238605519274703,0.0247645807813718,0.0202468143712179,0.0185462391354358,0.0177252614884131,0.0120724794982403,0.0115358433604145,0.0103606539607608,0.0229842479549731,0.0154094764083979,0.0150855842898246,0.0184086525123669,0.016718430394173,0.0186939225834819,0.0197481182503492,0.0150237369432905,0.0155723486278906,0.0141301318360517,0.0141788685730009,0.0218722242302942,0.0153754795261636,0.0115310592501673,0.0119739267478254,0.0218909157279074,0.0116081285881816,0.00993740322241714,0.00964143484193221,0.00936185280171794,0.0144054094741812,0.0111706825792636,0.00959998985133622,0.00853107119291897,0.0105363726087664,0.00781975797183474,0.00761437940728779,0.00947251005581877,0.00728523602537755,0.00718060291214446,0.00706947838908844,0.008043560015,0.00938645424095555,0.00849295012065933,0.00775371329662586,0.00813221914634085,0.00618847701461478,0.00567819154231948,0.00605237259200138,0.00601215814984509,0.00973372738731436,0.00803317582719642,0.0072881866901395,0.00525799202046646,0.00536941261197945,0.00584261576744348,0.00569210967805585,0.00690488195375106,0.00651391897206906,0.00607228784145546,0.00584404311383896,0.00568001325399451,0.0059217171321609,0.00514080541321231,0.00535930252124013,0.00491132989123277,0.00633748133722547,0.00639069789517842,0.00583116378567395,0.00520933896598623,0.00511334810955516,0.00444067031235553,0.00486197021719671,0.00460924251140696,0.00534323763847226,0.00612370452272924,0.00576924043337449,0.00480564808474063,0.00546742736875279,0.00478840126486198,0.0052180391033559,0.0046987763386301,0.00450047875570279,0.00468109521710092,0.00426930085288567,0.00513967095373556,0.00518733559244744,0.00536043309756594,0.00438009525340617,0.00403985043332981,0.0051800388432904,0.00508433918022883,0.00502940335441005,0.00417378146361243,0.00409912606649297,0.00485440543734735,0.00427437617949378,0.00470886214887175,0.00438655991578597,0.00517846677402449,0.0048001868497786,0.00458482056659753,0.0042152267850038,0.00479523600498412,0.00487072343972779,0.00465140064780826,0.00410931868216351,0.00390731328319677,0.00509020118902348,0.00506580734235614,0.00458641659075497,0.00391734900714223,0.0044333144831381,0.00474185592820918,0.00450770582502962,0.00414998420876785,0.00376672668042008,0.00471353695227577,0.00475280170004008,0.00429109787313182,0.00411064130799153,0.00387572599153641,0.00487743784695011,0.00449738657138061,0.00424833922612024,0.00388360384755969,0.00425247456786175,0.00453358287672143,0.00453874947591893,0.00441688352116219,0.00399151048638526,0.00395006858554043,0.00456156695220577,0.0046911097325241,0.00399306465124514,0.00390755112544579,0.00381149204299731,0.0044026757893802,0.00448525789186706,0.00425585847193913,0.00382710652716496,0.00382258739543416,0.004664984654471,0.0044025240900531,0.00396169721559784,0.00374550236160553,0.00370831005556943,0.00391923613889065,0.00372669194585038,0.00579158073153224,0.00482652744665863,0.00428020369968244,0.00377088005010314,0.00407107196134297,0.00406162179641415,0.00408335758166175,0.00487289652688066,0.00422918380653956,0.00476173811329617,0.0042892057982785,0.00422789074920142,0.00415170331893216,0.00394669810530805,0.00448805918358049,0.00443075836036657,0.00369220679120162,0.00357462683185316,0.00381440026342786,0.0040108847930193,0.00447203994476366,0.00433873232897066,0.00389335646781548,0.00407071740619141,0.0036419137614471,0.00366586830526463,0.00397738074609033,0.00352534665483111,0.00489848255936492,0.00440137241074318,0.00381307362187021,0.00381341783274115,0.00351890041266183,0.00398242042699892,0.00377283387487713,0.00440467399245628,0.00424236812109236,0.00411524256982656,0.00360531313313218,0.00427668430927258,0.00411701118271742,0.00373528567890645,0.00397125135461921,0.00420739965662116,0.00351171308424139,0.00434333682782467,0.00437368453292928,0.00357693314913354,0.00413362062059543,0.0041678077009592,0.00372780366606837,0.00349220694622325,0.00417915021413935,0.00439746752108704,0.0039615268771349,0.00366609116519466,0.00374260466232081,0.00414986642600548,0.00408352463085222,0.00375432864565748,0.00411420172012455,0.00453594434780576,0.00386599339891057,0.00407891810914607,0.00433395121765061,0.00388362449132673,0.00397051514878477,0.00382907249490166,0.00384249808856087,0.00412861567290117,0.00412233630174235,0.00370513155398192,0.00383815677068473,0.00411800620105567,0.00399746376330383,0.00396532028877562,0.00347887474085801,0.00426781869460882,0.00455601545727134,0.00413091682329793,0.00386743099999871,0.00387884545885955,0.0039559459936947,0.00377966505057826,0.00387585558747667,0.00340087371911306,0.00451455858652964,0.00425252146729899,0.00393029525765873,0.00422655648405329,0.00387519052713202,0.00383110485364394,0.00353575922786657],"mode":"markers+lines","name":"eval","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.33947370557083,0.126932523336098,0.0605109320908745,0.0438486682860469,0.0363201629635122,0.0306134137571763,0.023681540181377,0.0313601756255646,0.0270340286818498,0.0197056443477959,0.0185462237699809,0.0188654700517811,0.022148302966605,0.017487662872167,0.0180816096965734,0.0225396529090779,0.0281368023850545,0.0163406785622062,0.0200921918719323,0.0186118075159256,0.0163193002960377,0.0160159933685128,0.0160122155789618,0.0156508538651162,0.020829688499135,0.0158570471538782,0.0133399771517863,0.0136542971191009,0.0126023641398121,0.0163107762421581,0.0172473090147671,0.0130471291665788,0.011871156867417,0.0128942544220939,0.0135051683999706,0.0104167569551552,0.00962066282284557,0.00929438413816732,0.0128197095708329,0.0123268589332741,0.0101877951705522,0.00927790535114148,0.00944427000816496,0.00995295207442592,0.0086904401104773,0.0106322606044099,0.0110211214066575,0.00938067943059449,0.00874783923036434,0.0077766129575376,0.00943257813844605,0.00885318727740173,0.00819150962814974,0.00845990265109782,0.00901784647345388,0.00760053015955434,0.00760383263657642,0.00709367298069092,0.00799939978973388,0.00887492006746803,0.00766403811777124,0.00660507532527902,0.00603347669476783,0.0071559371530737,0.00691866202640355,0.00630390991212404,0.00741216304510522,0.00658019949181104,0.00621947772268564,0.00610663454321039,0.00778841199466391,0.00689402979203527,0.00633183604773338,0.00616116055733762,0.00570068999457079,0.00671531486824822,0.00642642326450351,0.00582421592153799,0.0065836392449294,0.00602533409808551,0.00539937972574506,0.00586993584619623,0.00562304770098494,0.00643061449356009,0.00609400812361201,0.0055201112865883,0.0059693111013331,0.00599005124827657,0.00526584370928137,0.00535093449027302,0.00492290678732933,0.00576874470446977,0.00543720006600983,0.0048660272571936,0.00542128953878303,0.00584246141207153,0.0058332057977833,0.00507447204402007,0.00476436314392275,0.00532995970986989,0.0057724989384795,0.00548241696797159,0.00484049879967169,0.00469469993515741,0.00487991077819699,0.00533947025329096,0.00535022285139,0.00514873111943732,0.0049723325430079,0.00544905568295105,0.00507305898687505,0.00456122553240945,0.00489562568742159,0.00516604105728182,0.00514074455339791,0.00460971806558267,0.00451562530625322,0.00509579599489974,0.00535006257079921,0.00506150295229306,0.00452179608197908,0.00485688865907636,0.0049711101841732,0.00491382801469743,0.0046171204995588,0.0043455450000846,0.00504214030565301,0.00508600706832233,0.00474807302427716,0.00450130556419438,0.00464103539481781,0.00482021639577525,0.00502800450972356,0.00465783880559911,0.00428748904841802,0.00457182290291726,0.00451517625139506,0.0048924871465022,0.00497276764877871,0.00428060950322387,0.00434920939025998,0.00473826572062136,0.00499979227410087,0.00455938022929884,0.00434441991172444,0.00430831991104514,0.00470344688678064,0.0044936753681842,0.00474641073314001,0.00423528680124961,0.00425490749260226,0.00468182100081172,0.004927316425434,0.00443299416222295,0.00429049759465765,0.00432771144822367,0.00446131344365114,0.00449855357044034,0.00511475051613079,0.00448047508912044,0.00443124115743403,0.00430379472365449,0.00420055308087432,0.0044517836840085,0.00450767229067492,0.00449205270105639,0.00529165215946743,0.00503319372662296,0.00458769163526266,0.00472884555554867,0.00433371358023284,0.00461659341711808,0.0045100373557962,0.00449613788658217,0.00413312981160203,0.0042673321396068,0.00405402147781594,0.00441149833862449,0.00457148795621681,0.00475656481757228,0.00420732821082662,0.00426584101980166,0.00383609189217031,0.00425646532579851,0.00427710500091404,0.00435736895881194,0.00467539841812588,0.00459310233993895,0.00404070073850955,0.00400018183355137,0.00390227423518779,0.00453449286036535,0.00415804514466722,0.00448815341372807,0.00409430912231462,0.00402426838411925,0.00406097682013682,0.00411156392961387,0.00445198243779762,0.00445659325903647,0.00432786330688857,0.00456625112695221,0.00385345323704408,0.0044271800211614,0.00422347054233139,0.00409891558728673,0.00407246716081168,0.00452632362468214,0.00394917953558113,0.0039834456098259,0.00421164820669448,0.00423761226112435,0.0039818688521711,0.00432352951393514,0.00428519800321908,0.00431798642837456,0.0043050441666057,0.00386877812803446,0.00441621386496962,0.00410478902909185,0.00456395911213078,0.0041568367195714,0.0041896662857413,0.00449333892199726,0.00415942973439699,0.00409013108086923,0.00412686758862485,0.0042293086690741,0.00400989748499484,0.00424322845560709,0.0041267016583919,0.00442824727117539,0.00420512398654703,0.00391945191363086,0.00416253599285765,0.00426946065581294,0.00427852309676389,0.00426953582613541,0.00415746921196677,0.00436073584149123,0.00423036440477721,0.00394581445138208,0.0040494581729021,0.00392610178585992,0.00450428188328618,0.00444594112510292,0.00425054321264109,0.00408730979776782,0.00419855127814714,0.00405230168282009],"mode":"markers+lines","name":"train","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],"y":[0.166791623579304,0.0348596355178963,0.0379625475968033,0.017191662563844,0.0524181750986577,0.0286728156598998,0.021490765613732,0.0330995878078347,0.0240716636566385,0.0202382909612115,0.0238605519274703,0.0247645807813718,0.0202468143712179,0.0185462391354358,0.0177252614884131,0.0120724794982403,0.0115358433604145,0.0103606539607608,0.0229842479549731,0.0154094764083979,0.0150855842898246,0.0184086525123669,0.016718430394173,0.0186939225834819,0.0197481182503492,0.0150237369432905,0.0155723486278906,0.0141301318360517,0.0141788685730009,0.0218722242302942,0.0153754795261636,0.0115310592501673,0.0119739267478254,0.0218909157279074,0.0116081285881816,0.00993740322241714,0.00964143484193221,0.00936185280171794,0.0144054094741812,0.0111706825792636,0.00959998985133622,0.00853107119291897,0.0105363726087664,0.00781975797183474,0.00761437940728779,0.00947251005581877,0.00728523602537755,0.00718060291214446,0.00706947838908844,0.008043560015,0.00938645424095555,0.00849295012065933,0.00775371329662586,0.00813221914634085,0.00618847701461478,0.00567819154231948,0.00605237259200138,0.00601215814984509,0.00973372738731436,0.00803317582719642,0.0072881866901395,0.00525799202046646,0.00536941261197945,0.00584261576744348,0.00569210967805585,0.00690488195375106,0.00651391897206906,0.00607228784145546,0.00584404311383896,0.00568001325399451,0.0059217171321609,0.00514080541321231,0.00535930252124013,0.00491132989123277,0.00633748133722547,0.00639069789517842,0.00583116378567395,0.00520933896598623,0.00511334810955516,0.00444067031235553,0.00486197021719671,0.00460924251140696,0.00534323763847226,0.00612370452272924,0.00576924043337449,0.00480564808474063,0.00546742736875279,0.00478840126486198,0.0052180391033559,0.0046987763386301,0.00450047875570279,0.00468109521710092,0.00426930085288567,0.00513967095373556,0.00518733559244744,0.00536043309756594,0.00438009525340617,0.00403985043332981,0.0051800388432904,0.00508433918022883,0.00502940335441005,0.00417378146361243,0.00409912606649297,0.00485440543734735,0.00427437617949378,0.00470886214887175,0.00438655991578597,0.00517846677402449,0.0048001868497786,0.00458482056659753,0.0042152267850038,0.00479523600498412,0.00487072343972779,0.00465140064780826,0.00410931868216351,0.00390731328319677,0.00509020118902348,0.00506580734235614,0.00458641659075497,0.00391734900714223,0.0044333144831381,0.00474185592820918,0.00450770582502962,0.00414998420876785,0.00376672668042008,0.00471353695227577,0.00475280170004008,0.00429109787313182,0.00411064130799153,0.00387572599153641,0.00487743784695011,0.00449738657138061,0.00424833922612024,0.00388360384755969,0.00425247456786175,0.00453358287672143,0.00453874947591893,0.00441688352116219,0.00399151048638526,0.00395006858554043,0.00456156695220577,0.0046911097325241,0.00399306465124514,0.00390755112544579,0.00381149204299731,0.0044026757893802,0.00448525789186706,0.00425585847193913,0.00382710652716496,0.00382258739543416,0.004664984654471,0.0044025240900531,0.00396169721559784,0.00374550236160553,0.00370831005556943,0.00391923613889065,0.00372669194585038,0.00579158073153224,0.00482652744665863,0.00428020369968244,0.00377088005010314,0.00407107196134297,0.00406162179641415,0.00408335758166175,0.00487289652688066,0.00422918380653956,0.00476173811329617,0.0042892057982785,0.00422789074920142,0.00415170331893216,0.00394669810530805,0.00448805918358049,0.00443075836036657,0.00369220679120162,0.00357462683185316,0.00381440026342786,0.0040108847930193,0.00447203994476366,0.00433873232897066,0.00389335646781548,0.00407071740619141,0.0036419137614471,0.00366586830526463,0.00397738074609033,0.00352534665483111,0.00489848255936492,0.00440137241074318,0.00381307362187021,0.00381341783274115,0.00351890041266183,0.00398242042699892,0.00377283387487713,0.00440467399245628,0.00424236812109236,0.00411524256982656,0.00360531313313218,0.00427668430927258,0.00411701118271742,0.00373528567890645,0.00397125135461921,0.00420739965662116,0.00351171308424139,0.00434333682782467,0.00437368453292928,0.00357693314913354,0.00413362062059543,0.0041678077009592,0.00372780366606837,0.00349220694622325,0.00417915021413935,0.00439746752108704,0.0039615268771349,0.00366609116519466,0.00374260466232081,0.00414986642600548,0.00408352463085222,0.00375432864565748,0.00411420172012455,0.00453594434780576,0.00386599339891057,0.00407891810914607,0.00433395121765061,0.00388362449132673,0.00397051514878477,0.00382907249490166,0.00384249808856087,0.00412861567290117,0.00412233630174235,0.00370513155398192,0.00383815677068473,0.00411800620105567,0.00399746376330383,0.00396532028877562,0.00347887474085801,0.00426781869460882,0.00455601545727134,0.00413091682329793,0.00386743099999871,0.00387884545885955,0.0039559459936947,0.00377966505057826,0.00387585558747667,0.00340087371911306,0.00451455858652964,0.00425252146729899,0.00393029525765873,0.00422655648405329,0.00387519052713202,0.00383110485364394,0.00353575922786657],"mode":"markers+lines","name":"eval","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="inference-on-test-data" class="section level2">
<h2>Inference on test data</h2>
<p>Setup inference data. Need to apply preprocessing to inference sequence and convert into a infer data iterator.</p>
<div id="inference" class="section level3">
<h3>Inference</h3>
<pre class="r"><code>internals &lt;- model$symbol$get.internals()
sym_state &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state&quot;))
sym_state_cell &lt;- internals$get.output(which(internals$outputs %in% &quot;RNN_state_cell&quot;))
sym_output &lt;- internals$get.output(which(internals$outputs %in% &quot;loss_output&quot;))
symbol &lt;- mx.symbol.Group(sym_output, sym_state, sym_state_cell)

pred_length = 100
predict &lt;- numeric()

data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

pred = mx.nd.array(y[seq_len, 1, drop = F])
real = sin(seeds[1] + pi/12 * (seq_len+1):(seq_len+pred_length))

infer.data &lt;- mx.io.arrayiter(data = data, label = label, 
                              batch.size = 1, shuffle = FALSE)

infer &lt;- mx.infer.rnn.one(infer.data = infer.data, 
                          symbol = symbol,
                          arg.params = model$arg.params, 
                          aux.params = model$aux.params, 
                          input.params = NULL,
                          ctx = ctx)

for (i in 1:pred_length) {
  
  data = mx.nd.reshape(pred, shape = c(1,1,1))
  label = pred
  
  infer.data &lt;- mx.io.arrayiter(data = data, label = label,  
                                batch.size = 1, shuffle = FALSE)
  
  infer &lt;- mx.infer.rnn.one(infer.data = infer.data, 
                            symbol = symbol,
                            ctx = ctx,
                            arg.params = model$arg.params,
                            aux.params = model$aux.params,
                            input.params = list(rnn.state = infer[[2]], 
                                                rnn.state.cell = infer[[3]]))
  
  pred &lt;- infer[[1]]
  predict &lt;- c(predict, as.numeric(as.array(pred)))
  
}</code></pre>
</div>
<div id="plot-predictions-against-real-values" class="section level3">
<h3>Plot predictions against real values</h3>
<pre class="r"><code>data = mx.nd.array(x[, , 1, drop = F])
label = mx.nd.array(y[, 1, drop = F])

plot_ly(x = 1:dim(y)[1], y = y[,1], type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;hist&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(real), y = real, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;real&quot;) %&gt;% 
  add_trace(x = dim(y)[1] + 1:length(predict), y = predict, type = &quot;scatter&quot;, mode=&quot;lines&quot;, name = &quot;pred&quot;)</code></pre>
<div id="1a2e20c70d72" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="1a2e20c70d72">{"x":{"visdat":{"1a2e46d54cc":["function () ","plotlyVisDat"]},"cur_data":"1a2e46d54cc","attrs":{"1a2e46d54cc":{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049163,-0.16612590248677,-0.415687937760018,-0.636921527031719,-0.814749966798797,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.77092864027975,-0.579812462440537,-0.3491830234714,-0.0947573385049164,0.16612590248677,0.415687937760018,0.636921527031719,0.814749966798797,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049183,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.770928640279749,-0.579812462440538,-0.349183023471399,-0.0947573385049184,0.16612590248677,0.415687937760016,0.636921527031718,0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471399,0.0947573385049186,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200554,-0.986104550503118,-0.909507305303714,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049187,0.166125902486766,0.415687937760016,0.636921527031718,0.814749966798795,0.93705454276652,0.995500400200554,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471403,0.0947573385049188,-0.166125902486766,-0.415687937760016,-0.636921527031717,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503118,-0.909507305303716,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049189,0.166125902486766,0.415687937760016,0.636921527031717,0.814749966798795,0.937054542766519,0.995500400200554,0.986104550503118],"mode":"lines","name":"hist","alpha":1,"sizes":[10,100],"type":"scatter"},"1a2e46d54cc.1":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.909507305303716,0.770928640279752,0.579812462440538,0.349183023471403,0.094757338504919,-0.166125902486766,-0.415687937760015,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503118,-0.909507305303716,-0.770928640279752,-0.579812462440541,-0.349183023471403,-0.0947573385049192,0.166125902486766,0.415687937760015,0.636921527031717,0.814749966798797,0.937054542766521,0.995500400200554,0.986104550503118,0.909507305303715,0.770928640279754,0.579812462440541,0.349183023471403,0.0947573385049193,-0.166125902486769,-0.415687937760012,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200555,-0.986104550503119,-0.909507305303716,-0.770928640279752,-0.579812462440538,-0.349183023471407,-0.0947573385049229,0.166125902486765,0.415687937760015,0.636921527031717,0.814749966798793,0.937054542766518,0.995500400200554,0.986104550503118,0.909507305303715,0.770928640279754,0.579812462440541,0.349183023471404,0.0947573385049195,-0.166125902486769,-0.415687937760012,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503119,-0.909507305303716,-0.770928640279752,-0.579812462440539,-0.349183023471407,-0.0947573385049232,0.166125902486765,0.415687937760015,0.636921527031717,0.814749966798793,0.937054542766518,0.995500400200554,0.986104550503118,0.909507305303715,0.770928640279755,0.579812462440542,0.349183023471404,0.0947573385049198,-0.166125902486762,-0.415687937760012,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503119,-0.909507305303716,-0.770928640279752,-0.579812462440539,-0.349183023471407,-0.0947573385049234,0.166125902486765,0.415687937760015,0.636921527031717,0.814749966798793,0.937054542766518,0.995500400200554,0.986104550503118,0.909507305303718,0.770928640279755,0.579812462440542,0.349183023471404],"mode":"lines","name":"real","alpha":1,"sizes":[10,100],"type":"scatter"},"1a2e46d54cc.2":{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.957176566123962,0.846857607364655,0.703736305236816,0.530358791351318,0.326034724712372,0.111184842884541,-0.127425402402878,-0.397468715906143,-0.613145589828491,-0.790977537631989,-0.926141798496246,-0.971836805343628,-0.939776599407196,-0.863858103752136,-0.742446780204773,-0.54316383600235,-0.266710788011551,0.0400344356894493,0.341065466403961,0.59608381986618,0.816259801387787,0.977044999599457,1.04899179935455,1.0688613653183,1.00384843349457,0.871382057666779,0.72203916311264,0.556102573871613,0.359661757946014,0.147363558411598,-0.0845951214432716,-0.3563472032547,-0.582546532154083,-0.763990581035614,-0.90986567735672,-0.97063136100769,-0.948590278625488,-0.878001987934113,-0.765578508377075,-0.578659117221832,-0.310753911733627,-0.0055782925337553,0.298326790332794,0.561912775039673,0.78519082069397,0.959783256053925,1.04185950756073,1.07003283500671,1.01933169364929,0.893095731735229,0.744385719299316,0.581857979297638,0.38951575756073,0.178417563438416,-0.0479206293821335,-0.317816346883774,-0.553920745849609,-0.738973021507263,-0.893099725246429,-0.967687785625458,-0.955584824085236,-0.890277862548828,-0.785761117935181,-0.610704839229584,-0.352422714233398,-0.0496981367468834,0.256164938211441,0.528042852878571,0.754314422607422,0.94089663028717,1.03404486179352,1.06943678855896,1.03260028362274,0.913458466529846,0.765491247177124,0.606041550636292,0.418120056390762,0.208466485142708,-0.0135115254670382,-0.279408127069473,-0.525004148483276,-0.714180409908295,-0.875022292137146,-0.963018000125885,-0.961359977722168,-0.901606380939484,-0.803975343704224,-0.640311121940613,-0.392564743757248,-0.0931130424141884,0.214046940207481,0.493663311004639,0.723479032516479,0.920179128646851,1.02539658546448,1.0674637556076,1.04385149478912,0.932863116264343,0.786158263683319,0.629585444927216],"mode":"lines","name":"pred","alpha":1,"sizes":[10,100],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049163,-0.16612590248677,-0.415687937760018,-0.636921527031719,-0.814749966798797,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.77092864027975,-0.579812462440537,-0.3491830234714,-0.0947573385049164,0.16612590248677,0.415687937760018,0.636921527031719,0.814749966798797,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.77092864027975,0.579812462440537,0.349183023471399,0.0947573385049183,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200555,-0.986104550503118,-0.909507305303714,-0.770928640279749,-0.579812462440538,-0.349183023471399,-0.0947573385049184,0.16612590248677,0.415687937760016,0.636921527031718,0.814749966798798,0.93705454276652,0.995500400200555,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471399,0.0947573385049186,-0.16612590248677,-0.415687937760016,-0.636921527031718,-0.814749966798798,-0.93705454276652,-0.995500400200554,-0.986104550503118,-0.909507305303714,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049187,0.166125902486766,0.415687937760016,0.636921527031718,0.814749966798795,0.93705454276652,0.995500400200554,0.986104550503118,0.909507305303714,0.770928640279752,0.579812462440538,0.349183023471403,0.0947573385049188,-0.166125902486766,-0.415687937760016,-0.636921527031717,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503118,-0.909507305303716,-0.770928640279752,-0.579812462440538,-0.349183023471403,-0.0947573385049189,0.166125902486766,0.415687937760016,0.636921527031717,0.814749966798795,0.937054542766519,0.995500400200554,0.986104550503118],"mode":"lines","name":"hist","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.909507305303716,0.770928640279752,0.579812462440538,0.349183023471403,0.094757338504919,-0.166125902486766,-0.415687937760015,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503118,-0.909507305303716,-0.770928640279752,-0.579812462440541,-0.349183023471403,-0.0947573385049192,0.166125902486766,0.415687937760015,0.636921527031717,0.814749966798797,0.937054542766521,0.995500400200554,0.986104550503118,0.909507305303715,0.770928640279754,0.579812462440541,0.349183023471403,0.0947573385049193,-0.166125902486769,-0.415687937760012,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200555,-0.986104550503119,-0.909507305303716,-0.770928640279752,-0.579812462440538,-0.349183023471407,-0.0947573385049229,0.166125902486765,0.415687937760015,0.636921527031717,0.814749966798793,0.937054542766518,0.995500400200554,0.986104550503118,0.909507305303715,0.770928640279754,0.579812462440541,0.349183023471404,0.0947573385049195,-0.166125902486769,-0.415687937760012,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503119,-0.909507305303716,-0.770928640279752,-0.579812462440539,-0.349183023471407,-0.0947573385049232,0.166125902486765,0.415687937760015,0.636921527031717,0.814749966798793,0.937054542766518,0.995500400200554,0.986104550503118,0.909507305303715,0.770928640279755,0.579812462440542,0.349183023471404,0.0947573385049198,-0.166125902486762,-0.415687937760012,-0.636921527031714,-0.814749966798795,-0.937054542766519,-0.995500400200554,-0.986104550503119,-0.909507305303716,-0.770928640279752,-0.579812462440539,-0.349183023471407,-0.0947573385049234,0.166125902486765,0.415687937760015,0.636921527031717,0.814749966798793,0.937054542766518,0.995500400200554,0.986104550503118,0.909507305303718,0.770928640279755,0.579812462440542,0.349183023471404],"mode":"lines","name":"real","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[0.957176566123962,0.846857607364655,0.703736305236816,0.530358791351318,0.326034724712372,0.111184842884541,-0.127425402402878,-0.397468715906143,-0.613145589828491,-0.790977537631989,-0.926141798496246,-0.971836805343628,-0.939776599407196,-0.863858103752136,-0.742446780204773,-0.54316383600235,-0.266710788011551,0.0400344356894493,0.341065466403961,0.59608381986618,0.816259801387787,0.977044999599457,1.04899179935455,1.0688613653183,1.00384843349457,0.871382057666779,0.72203916311264,0.556102573871613,0.359661757946014,0.147363558411598,-0.0845951214432716,-0.3563472032547,-0.582546532154083,-0.763990581035614,-0.90986567735672,-0.97063136100769,-0.948590278625488,-0.878001987934113,-0.765578508377075,-0.578659117221832,-0.310753911733627,-0.0055782925337553,0.298326790332794,0.561912775039673,0.78519082069397,0.959783256053925,1.04185950756073,1.07003283500671,1.01933169364929,0.893095731735229,0.744385719299316,0.581857979297638,0.38951575756073,0.178417563438416,-0.0479206293821335,-0.317816346883774,-0.553920745849609,-0.738973021507263,-0.893099725246429,-0.967687785625458,-0.955584824085236,-0.890277862548828,-0.785761117935181,-0.610704839229584,-0.352422714233398,-0.0496981367468834,0.256164938211441,0.528042852878571,0.754314422607422,0.94089663028717,1.03404486179352,1.06943678855896,1.03260028362274,0.913458466529846,0.765491247177124,0.606041550636292,0.418120056390762,0.208466485142708,-0.0135115254670382,-0.279408127069473,-0.525004148483276,-0.714180409908295,-0.875022292137146,-0.963018000125885,-0.961359977722168,-0.901606380939484,-0.803975343704224,-0.640311121940613,-0.392564743757248,-0.0931130424141884,0.214046940207481,0.493663311004639,0.723479032516479,0.920179128646851,1.02539658546448,1.0674637556076,1.04385149478912,0.932863116264343,0.786158263683319,0.629585444927216],"mode":"lines","name":"pred","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
